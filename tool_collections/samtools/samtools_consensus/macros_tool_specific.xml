<!-- This Macros file is specific to this tool it prevent dupplicate codes snippit for the options "Bayesian" and "Bayesian 1.16" settings -->
<macros>
    <xml name="bayesian_settings_macro">
        <section name="settings" title="Settings" expanded="no">
            <!-- Manual vs Predefined Condetional -->
            <conditional name="config_cond">
                <param name="config_param" argument="--config" type="select" label="Use configuration" help="Manually set the parameters or use one of the listed pre-defined configurations">
                    <option value="manual" selected="true">Manual</option>
                    <option value="hiseq">hiseq</option>
                    <option value="hifi">hifi</option>
                    <option value="r10.4_sup">r10.4_sup</option>
                    <option value="r10.4_dup">r10.4_dup</option>
                    <option value="ultima">ultima</option>
                </param>
                <!-- set parameters manually -->
                <when value="manual">
                    <param argument="-C" type="integer" value="10" min="0" max="93" label="Cutoff threshold" help="Bases with Phred-style quality below this threshold are called as N"/>
                    <!-- MQ Settings cond -->
                    <conditional name="mq_cond">
                        <param name="mq_param" argument="--use-MQ" type="select" checked="true" truevalue="--use-MQ" falsevalue="--no-use-MQ" label="Use MQ" help="Enable or disable the use of mapping qualities">
                            <option value="--use-MQ" selected="true">Yes</option>
                            <option value="--no-use-MQ">No</option>
                        </param>
                        <when value="--use-MQ">
                            <param name="adj_mq" argument="--adj-MQ" type="boolean" checked="true" truevalue="--adj-MQ" falsevalue="--no-adj-MQ" label="Adjust MQ" help="Scales mapping quality based on nearby mismatches using the MD tag. Ignored if the MD tag is absent"/>
                            <param name="mismatch_window" argument="--NM-halo" min="1" type="integer" label="Local mismatch window" value="50" help="Specifies the distance either side of the base call being considered for computing the number of local mismatches"/>
                            <param name="low_mq" argument="--low-MQ" type="integer" label="Minimum MQ" value="1" min="0" max="60" help="Specifies a minimum value of the mapping quality. This is not a filter and instead simply put lower cap on the values"/>
                            <param name="high_mq" argument="--high-MQ" type="integer" label="Maximum MQ" value="60" min="0" max="60" help="Specifies a maximum value of the mapping quality. This is not a filter and instead simply put upper cap on the values"/>
                            <param name="scale_mq" argument="--scale-MQ" type="float" label="Scale MQ" value="1.0" min="0" help="This is a general multiplicative mapping quality scaling factor. The effect is to globally raise or lower the quality values used in the consensus algorithm"/>
                        </when>
                        <when value="--no-use-MQ"/>
                    </conditional>
                    <param name="p_het" argument="--P-het" type="float" label="Probability of heterozygous site" value="1.0e-03" min="0" max="1" help="Sets the prior probability of a site being heterozygous in Bayesian consensus calculations. Lower values favor homozygous calls.(output is ambiguous only if --ambig is enabled)" />
                    <param name="p_indel" argument="--P-indel" type="float" label="Probability of indel sites" value="2.0e-04" min="0" max="1" help="Controls the likelihood of small indels. This is used in the priors for the Bayesian calculations, and has little difference on deep data" />
                    <param name="hetero_scale" argument="--het-scale" type="float" min="0" label="Heterozygous SNP probability multiplier" value="1.0e+00" help="Multiplicative factor applied to base quality when evaluating heterozygous calls. Lower values reduce false positive heterozygous calls but may increase false negatives" />
                    <param name="hom_fix" argument="--homopoly-fix" type="boolean" label="Homopolymer quality correction" checked="false" truevalue="-p" falsevalue="" help="Spread low-qual bases to both ends of homopolymers (Recommended for old 454 or PacBio HiFi dat)" />
                    <param name="hom_score" argument="--homopoly-score" type="float" min="0" label="Homopolymer quality scaling" optional="true" help="Scales base qualities within homopolymer runs by this factor to reduce confidence in positions prone to sequencing errors. Automatically enables (--homopoly-fix) if not already set" />
                    <conditional name="calibration_cond">
                        <param name="calibration_param" argument="--qual-calibration" type="select" label="Quality calibration table" help="Choose a predefined calibration for your sequencing platform or upload a custom table to adjust base quality scores.">
                            <option value=":hiseq">Illumina HiSeq</option>
                            <option value=":hifi">PacBio HiFi</option>
                            <option value=":r10.4_sup">Oxford Nanopore R10.4 (super accuracy model)</option>
                            <option value=":r10.4_dup">Oxford Nanopore R10.4 duplex reads</option>
                            <option value=":ultima">Ultima Genomics</option>
                            <option value="file" selected="true">Upload a custom file with quality calibration values</option>
                        </param>
                        <when value=":hiseq"/>
                        <when value=":hifi"/>
                        <when value=":r10.4_sup"/>
                        <when value=":r10.4_dup"/>
                        <when value=":ultima"/>
                        <when value="file">
                            <param name="calibration_file" argument="--qual-calibration" type="data" format="txt" label="Quality calibration table" optional="true" help="Loads a quality calibration table from a file to adjust base quality scores in the consensus algorithm. Each line starts with QUAL and maps a reported quality value to calibrated Phred scores for substitution, undercall, and overcall errors: QUAL value substitution undercall overcall"/>
                        </when>
                    </conditional>
                </when>
                <when value="hiseq"/>
                <when value="hifi"/>
                <when value="r10.4_sup"/>
                <when value="r10.4_dup"/>
                <when value="ultima"/>
            </conditional>
        </section>
    </xml>
</macros>