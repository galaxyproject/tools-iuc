<tool id="snpEff_databases" name="SnpEff databases:" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@">
    <description> list available genome annotation databases</description>
    <macros>
        <import>snpEff_macros.xml</import>
    </macros>
    <requirements>
        <expand macro="requirement" />
    </requirements>
    <expand macro="stdio" />
    <expand macro="version_command" />
    <command><![CDATA[
        snpEff databases | grep -v '^---' | sed 's/^Genome/#Genome/' | sed 's/  *//g'

        #if $include_pattern:
             | grep -e '^#' -e '${include_pattern}'
        #end if

        #if $exclude_pattern:
             | grep -v '${exclude_pattern}'
        #end if

        > '${snpeff_dbs}'
    ]]></command>
    <inputs>
        <param name="include_pattern" type="text" value="" optional="true" label="List entries matching the following expression" help="Databases matching this expression will be listed. Here you can enter text or regular expression. For example, to show only mouse databases use 'Mouse'. Note that this parameter is case-sensitive.">
            <sanitizer>
                <valid initial="string.digits,string.letters">
                    <add value="^" />
                    <add value="_" />
                </valid>
            </sanitizer>
        </param>
        <param name="exclude_pattern" type="text" value="" optional="true" label="Do not output entries matching the following expression" help="Databases matching this expression WILL NOT BE listed. Here you can enter text or regular expression. For excample, to avoid all ENSEMBL bundles enter 'ENSEMBL'. Note that this parameter is case-sensitive.">
            <sanitizer>
                <valid initial="string.digits,string.letters">
                    <add value="^" />
                    <add value="_" />
                </valid>
            </sanitizer>
        </param>

    </inputs>
    <outputs>
        <data name="snpeff_dbs" format="tabular" label="${tool.name} @SNPEFF_DB_VERSION@ available databases" />
    </outputs>
    <tests>
        <test>
            <output name="snpeff_dbs">
                <assert_contents>
                    <has_text text="ebola_zaire" />
                </assert_contents>
            </output>
        </test>
         <test>
            <param name="include_pattern" value="ebola"/>
            <output name="snpeff_dbs">
                <assert_contents>
                    <has_text text="ebola_zaire" />
                </assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[
**What it does**

This tool lists publically available prebuilt @SNPEFF_DB_VERSION@ genome annotation databases. Any SnpEff identifier (in the first column of the output) can then be used with the **SnpEff download** tool to retrieve the correponding annotations and start using them for your analysis.

For example, if **List entries matching the following expression** parameter of this tool is set to *Mouse* the tool will produce a tabular dataset with the following content::

    m10  Mouse  [https://snpeff.blob.core.windows.net/databases/v5_1/snpEff_v5_1_mm10.zip,https://snpeff.blob.core.windows.net/databases/v5_0/snpEff_v5_0_mm10.zip]
    m39  Mouse  [https://snpeff.blob.core.windows.net/databases/v5_1/snpEff_v5_1_mm39.zip,https://snpeff.blob.core.windows.net/databases/v5_0/snpEff_v5_0_mm39.zip]
    m9   Mouse  [https://snpeff.blob.core.windows.net/databases/v5_1/snpEff_v5_1_mm9.zip,https://snpeff.blob.core.windows.net/databases/v5_0/snpEff_v5_0_mm9.zip]

This means that there are three available snpEff databases (corresponding to mouse genome versions mm9, mm10 and mm39. In order to download any of these, you can use the identifier from the first column (i.e., m9, m10 or m39 in this case) with the **SnpEff download** tool.

-------

.. class:: infomark

**The usage scenario**

There are two ways to use names of databases obtained with this tool in Galaxy's version on snpEff:

    #. Use the **SnpEff download** tool. It will download the database to the history and you will be able to use it in the **SnpEff eff** tool using the *Downloaded snpEff database in your history* option of the **Genome source** parameter.
    #. Use the *Download on demand* option of the **SnpEff eff** tool (*Genome source* parameter). In this case SnpEff will download the database on the fly before performing annotation.

@SNPEFF_IN_GALAXY_INFO@
@EXTERNAL_DOCUMENTATION@
    ]]></help>
    <expand macro="citations" />
</tool>

