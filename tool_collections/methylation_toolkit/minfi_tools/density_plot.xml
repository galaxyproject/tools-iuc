<tool id="density_plot" name="Make density plots for 450k data" version="1.0">
    <description>Density plots of methylation Beta values, primarily for QC.</description>
    <requirements>
        <requirement type="R-module" version="1.15.7">minfi</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
	<command interpreter="Rscript">
		density_plot.R --rgset=$RGset --xlabel="$xlabel" --pdffile=$pdffile --pngfile=$pngfile
	</command>
    <inputs>
        <param name="RGset" type="data" format="rdata" label="Choose RGset for Density plot" />
        <param name="xlabel" size="30" type="text" value="Beta values for RGset" label="Label for X axis"/>
    </inputs>
	<outputs>
	  <data format="pdf" name="pdffile" label="PDF of Density plot"/>
	  <data format="png" name="pngfile" label="PNG of Density plot"/>
	</outputs>
    <tests>
        <test>
            <param name="RGset" value="RGset.rdata" ftype="rdata" />
            <param name="xlabel" value="Beta values for test data" ftype="text" />
            <output name="pdffile" file="pdffile.pdf" ftype="pdf" />
        </test>
    </tests>
    <help>

**What it does**

Create density plots for 450k data, this is used for quality control.

**Input** : An RGChannelSet We either use the getBeta function to get Beta values (for the first two) or we assume the matrix contains Beta values.

It is better to give the tool, RGset as input to make it easier to collect the phenotype data from the object.

**Output**: PDF or PNG file based on the option chosen.

    </help>
    <citations>
        <citation type="doi">10.1093/bioinformatics/btu049</citation>
    </citations>
</tool>



