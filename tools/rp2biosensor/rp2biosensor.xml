<tool id="rp2biosensor" name="rp2biosensor" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="21.09">
    <description>Build Sensing-Enabling Metabolic Pathways from RetroPath2.0 output</description>
    <macros>
        <token name="@VERSION_SUFFIX@">0</token>
        <token name="@TOOL_VERSION@">3.1.0</token>
    </macros>
    <requirements>
        <requirement type="package" version="@TOOL_VERSION@">rp2biosensor</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        python -m rp2biosensor
        '$rp2_results'
        '$sink_file'
        --opath '$html_file'
        #if str($adv.json_graph) == "true"
            --ojson '$json_file'
        #end if
    ]]></command>
    <inputs>
        <param name="rp2_results" type="data" format="csv" label="RetroPath2 output" help="Retrosynthesis network generated by RetroPath2.0 in CSV format."/>
        <param name="sink_file" type="data" format="csv" label="Sink file used for RetroPath2.0"/>
        <section name="adv" title="Advanced Options" expanded="false">
            <param name="json_graph" type="boolean" label="Output Graph in JSON?" checked="false" />
        </section>
    </inputs>
    <outputs>
        <data name="html_file" format="html" label="${tool.name} - ${rp2_results.name}"/>
        <data name="json_file" format="json" label="${tool.name} -${rp2_results.name}">
            <filter> adv['json_graph'] </filter>
        </data>
    </outputs>
    <tests>
        <test>
        <!-- test 1: check if identical outputs are produced -->
        <param name="rp2_results" value="rp2-results-lactate.csv" />
        <param name="sink_file" value="sink-h2o2.csv" />
        <output name="html_file" >
            <assert_contents>
                <has_line_matching expression='^((?!"svg": "data:image).)*$' />
            </assert_contents>
</output>
        </test>
    </tests>
    <help><![CDATA[
rp2biosensor
================

**rp2biosensor** is an open-source Python software that extracts from the retrosynthetic network generated by `RetroPath2.0 <https://www.sciencedirect.com/science/article/pii/S1096717617301337>`_ the subnetwork of interest, linking the biosensor to the compound to be detected, and produce an interactive web page showing the transducing reactions.

Briefly, rp2biosensor parses the retrosynthesis network outputted by RetroPath2.0, completes the predicted reactions by putting back co-substrates and co-products omitted during the retrosynthesis using the `rxn_rebuild <https://www.sciencedirect.com/science/article/pii/S1096717617301337>`_ Python package, enumerates the shortest path linking the compound of interest, i.e. the biosensor, to the compound to be detected, e.g. lactate, and finally outputs the resulting subnetwork as an interactive web page to let the user browse the results.

Input
-----

Required:

* **RetroPath2 output**\ : Retrosynthesis network generated by RetroPath2.0 in CSV format.
* **Sink file**\ : (string) Sink file used for RetroPath2.0.

Output
------

* **HTML file**\ : interactive web page showing the transducing reactions.

Optional:

* **JSON file**\ : Output the graph as JSON file.

Project Links
------------------

* `GitHub <https://github.com/brsynth/rp2biosensor>`_

License
-------

* `MIT <https://github.com/brsynth/rp2biosensor/blob/master/LICENSE.md>`_

    ]]></help>
    <creator>
        <person givenName="Thomas" familyName="Duigou" email="thomas.duigou@inrae.fr" identifier="https://orcid.org/0000-0002-2649-2950" />
    </creator>
    <citations>
        <citation type="doi">10.1021/acssynbio.2c00138</citation>
    </citations>
</tool>