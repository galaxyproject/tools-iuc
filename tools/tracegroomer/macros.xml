<macros>
    <token name="@TOOL_VERSION@">0.1.3</token>
    <token name="@VERSION_SUFFIX@">0</token>
    <xml name="requirements">
        <requirements>
            <requirement type="package" version="@TOOL_VERSION@">tracegroomer</requirement>
        </requirements>
    </xml>
    <xml name="input_datasets">
        <param name="labeled_metabo_file" type="data" optional="false" format="tabular,xlsx" label="Labeled metabolomics file"/>
        <param name="sample_metadata_path" type="data" format="tabular" label="sample metadata file" help="The metadata, a unique file with the description of the samples in your measures files. This is compulsory, see section Metadata File Information."/>
        <param name="amount_material" type="data" optional="true" format="interval" label="amount material" help="file having the amount of material (number of cells, tissue weight, etc) by sample, for the normalization"/>
        <param name="remove_these_metabolites" type="data" optional="true" format="interval" label="remove metabolites using this file" help="Absolute path to the file with columns:  compartment, metabolite; listing the metabolites to be completely excluded (you know what you are doing)"/>
        <conditional name="type_of_file">
            <param name="type_of_file_selector" type="select" label="Choose which type of input file is used" help="One of the following: IsoCor_out_tsv|rule_tsv|VIBMEC_xlsx|generic_xlsx">
                    <option value="IsoCor_out_tsv" selected="true">isocor output file</option>
                    <option value="VIBMEC_xlsx">VIBMEC xlsx file</option>
                    <option value="generic_xlsx">generic xlsx file</option>
                    <option value="rule_tsv">rule tsv file</option>
            </param>
            <when value="generic_xlsx">
                <param name="sheetname" type="text" value="isotopologuesCorrValues" optional="false" label="name of the sheet containing the isotopologues corrected values" >
                        <sanitizer invalid_char="">
                            <valid initial="string.ascii_letters,string.digits">
                                <add value="_" />
                            </valid>
                        </sanitizer>
                    </param>
            </when>
            <when value="VIBMEC_xlsx">
                <param name="raw_abundance_sheet_name" type="text" value="rawAbundances" optional="false" label="name of the sheet containing the raw abundances values" >
                        <sanitizer invalid_char="">
                            <valid initial="string.ascii_letters,string.digits">
                                <add value="_" />
                            </valid>
                        </sanitizer>
                </param>
                <param name="frac_contribution_sheet_name" type="text" value="FracContribution_C" optional="false" label="name of the sheet containing the mean enrichment  values" >
                        <sanitizer invalid_char="">
                            <valid initial="string.ascii_letters,string.digits">
                                <add value="_" />
                            </valid>
                        </sanitizer>
                </param>
                <param name="corrected_isotopologues_sheet_name" type="text" value="CorrectedIsotopologues" optional="false" label="name of the sheet containing the isotopologues corrected values" >
                        <sanitizer invalid_char="">
                            <valid initial="string.ascii_letters,string.digits">
                                <add value="_" />
                            </valid>
                        </sanitizer>
                </param>
            </when>
            <when value="rule_tsv">
                <param name="variable_metadata_path" type="data" format="tabular" label="variable metadata file" help="The metadata, a unique file with the description of the samples in your measures files. This is compulsory, see section Metadata File Information."/>
                <section name="columns_variable_metadata_description">
                    <param name="identifier" type="text" value="ID" optional="false" label="identifier of your metabolite in variable metadata file" >
                        <sanitizer invalid_char="">
                            <valid initial="string.ascii_letters,string.digits">
                                <add value="_" />
                            </valid>
                        </sanitizer>
                    </param>
                    <param name="compound" type="text" value="metabolite_name" optional="false" label="name of your metabolite in variable metadata file (formula is also accepted)" >
                        <sanitizer invalid_char="">
                            <valid initial="string.ascii_letters,string.digits">
                                <add value="_" />
                            </valid>
                        </sanitizer>
                    </param>
                    <param name="isotopologue_number" value="isotope_numeric" type="text" optional="false" label="isotopologue number in variable metadata file" >
                        <sanitizer invalid_char="">
                            <valid initial="string.ascii_letters,string.digits">
                                <add value="_" />
                            </valid>
                        </sanitizer>
                    </param>
                </section>
            </when>
        </conditional>
    </xml>
    <xml name="advanced_options">
        <section name="advanced_options" title="Advanced options">
            <param name="alternative_div_amount_material" type="boolean" value="true" label="add strip plot on abundance bar" help="When dividing values by the amount of material, also multiplies by mean(amountMaterial) to stay in abundance units"/>
            <param name="div_isotopologues_by_amount_material" type="boolean" value="true" label="isotopologues by amount material" help="Apply normalization by the amount of material, at the level of isotopologue absolute values. After this, re-computes all derived metrics. If False, only total abundances are normalized"/>
            <param name="use_internal_standard" type="text" optional="true" help="Internal Standard for performing the division: abundances/internal_standard, example: --use_internal_standard Myristic_acid_d27. By default is not performed." label="internal standard" />
            <param name="isotopologues_preview" type="boolean" value="false" label="Plot isotopologue" help="Plot isotopologue values, as given"/>
            <param name="isosprop_min_admitted" type="float" min="-1.0" max="1.0" value="-0.5" label="isotopologues cutoff" help="Metabolites whose isotopologues proportions are less or equal to this cutoff, are removed"/>
            <param name="fractions_stomp_values" type="boolean" value="true" label="Stomps fractional contributions" help="Stomps fractional contributions (synonym: mean enrichment), and isotopologue proportions, to max 1.0 and min 0.0"/>
            <param name="under_detection_limit_set_nan" type="boolean" value="true" label="Limit Of Detection" help="On VIB results. Any abundance inferior to LOD (Limit Of Detection), is set as NaN"/>
            <param name="subtract_blankavg" type="boolean" value="true" label="" help="On VIB results. From samples abundances,  subtracts the average of the blanks"/>
        </section>
    </xml>
    <xml name="citations">
        <citations>
            <citation type="bibtex">
                @software{Galvis_Rodriguez_DIMet,
                    author = {Galvis Rodriguez, Johanna  and Guyon, Joris and Dartigues, Benjamin and Specque, Florian and Daubon, Thomas and Karkar, Slim and Nikolski, Macha},
                    license = {MIT},
                    title = {{DIMet}},
                    url = {https://github.com/cbib/DIMet}
                    }

            </citation>
        </citations>

    </xml>
</macros>