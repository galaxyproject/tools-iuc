<tool id="craq" name="Clipping Reveals Assembly Quality" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="25.0">
    <description>assess the accuracy of assembled genomic sequences</description>
    <macros>
        <token name="@TOOL_VERSION@">1.10</token>
		<token name="@VERSION_SUFFIX@">0</token>
    </macros>
    <requirements>
		<requirement type="package" version="@TOOL_VERSION@">craq</requirement>
        <requirement type="package" version="1.3.1">samtools</requirement>
        <requirement type="package" version="2.17">minimap2</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        craq
        ## input files
        -g '$genome'
        -sms '$sms_input'
        -ngs '$ngs_input'

        ## options
        -sn $filter_params.sn
        -sf $filter_params.sf
        -ln $filter_params.ln
        -lf $filter_params.lf
        -hmin $filter_params.hmin
        -hmax $filter_params.hmax
        -mgs $filter_params.mgs
        --sms_coverage $filter_params.sms_coverage
        --ngs_coverage $filter_params.ngs_coverage

        -D outputs
    ]]></command>
    <inputs>
        <param name="genome" type="data" label="Assembly sequence file" format="fasta"/>
        <param name="sms_input" type="data" label="SMS long-read alignment or sequences" format="bam,fastq"/>
        <param name="ngs_input" type="data" label="NGS short-read alignment or sequences" format="bam,fastq"/>

        <section name="filter_params" title="Filter Parameters" expanded="False">
            <param argument="-sn" type="integer" min="0" value="2" label="Minimum number of NGS clipped-reads" help=""/>
            <param argument="-sf" type="float" min="0.0" max="1.0" value="0.75" label="Minimum proportion of NGS clipped-reads" help=""/>
            <param argument="-ln" type="integer" min="0" value="2" label="Minimum number of SMS clipped-reads" help=""/>
            <param argument="-lf" type="float" min="0.0" max="1.0" value="0.75" label="Minimum proportion of SMS clipped-reads" help=""/>
            <param argument="-hmin" type="float" min="0.0" max="1.0" value="0.4" label="Lower clipping rate for heterozygous allele" help=""/>
            <param argument="-hmax" type="float" min="0.0" max="1.0" value="0.6" label="Upper clipping rate for heterozygous allele" help=""/>
            <param argument="-mgs" type="integer" min="1" value="10" label="Gap Threshhold" help="length greater than the provided threshold will be treated as breakage"/>
            <param argument="--sms_coverage" type="integer" min="0" max="100" value="100" label="Average SMS coverage" help=""/>
            <param argument="--ngs_coverage" type="integer" min="0" max="100" value="100" label="Average NGS coverage" help=""/>
        </section>
        <section name="other_params" title="Other Parameters" expanded="False">

		</section>
    </inputs>
    <outputs>
        <collection name="craq_output" type="list" label="CRAQ outputs">
            <discover_datasets pattern="__name_and_ext__" directory="outputs"/>
        </collection>
    </outputs>
    <help><![CDATA[
    CRAQ (Clipping Reveals Assembly Quality)

    **What the tool does?**
    ]]></help>
    <citations>
        <citation type="doi">10.1038/s41467-023-42336-w</citation>
    </citations>
    <creator>
        <organization name="Galaxy Europe"/>
        <person givenName="Ahmad" familyName="Mahagna" url="https://github.com/Smkingsize"/>
        <person givenName="Saim" familyName="Momin" url="https://github.com/SaimMomin12"/>
    </creator>
</tool>