<tool id="mirmachine" name="MirMachine" version="@TOOL_VERSION@+galaxy@SUFFIX_VERSION@" profile="22.05">
    <description>A tool to detect miRNA homologs in genome sequences</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <command detect_errors="exit_code"><![CDATA[
        MirMachine.py -n '$input_node' -s '$input_species' --genome '$input1' -c ${GALAXY_SLOTS:-8}
    ]]></command>
    <inputs>
        <param type="select" name="input_node" label="Node name (e.g. Caenorhabditis)">
            <option value="Acanthomorpha">
                Acanthomorpha
            </option>
            <option value="Ambulacraria">
                Ambulacraria
            </option>
            <option value="Amniota">
                Amniota
            </option>
            <option value="Amphibia">
                Amphibia
            </option>
            <option value="Annelida">
                Annelida
            </option>
            <option value="Archelosauria">
                Archelosauria
            </option>
            <option value="Archosauria">
                Archosauria
            </option>
            <option value="Arthropoda">
                Arthropoda
            </option>
            <option value="Bilateria">
                Bilateria
            </option>
            <option value="Boreoeutheria">
                Boreoeutheria
            </option>
            <option value="Branchiostoma">
                Branchiostoma
            </option>
            <option value="Caenorhabditis">
                Caenorhabditis
            </option>
            <option value="Catarrhini">
                Catarrhini
            </option>
            <option value="Cephalopoda">
                Cephalopoda
            </option>
            <option value="Chelicerata">
                Chelicerata
            </option>
            <option value="Chondrichthyes">
                Chondrichthyes
            </option>
            <option value="Chordata">
                Chordata
            </option>
            <option value="Chromadorea">
                Chromadorea
            </option>
            <option value="Clupeocephala">
                Clupeocephala
            </option>
            <option value="Cnidaria">
                Cnidaria
            </option>
            <option value="Coleoidea">
                Coleoidea
            </option>
            <option value="Cyclostomata">
                Cyclostomata
            </option>
            <option value="Daphnia">
                Daphnia
            </option>
            <option value="Demospongiae">
                Demospongiae
            </option>
            <option value="Deuterostomia">
                Deuterostomia
            </option>
            <option value="Diapsida">
                Diapsida
            </option>
            <option value="Diptera">
                Diptera
            </option>
            <option value="Drosophila">
                Drosophila
            </option>
            <option value="Ecdysozoa">
                Ecdysozoa
            </option>
            <option value="Echinodermata">
                Echinodermata
            </option>
            <option value="Eleutherozoa">
                Eleutherozoa
            </option>
            <option value="Endopterygota">
                Endopterygota
            </option>
            <option value="Enteropneusta">
                Enteropneusta
            </option>
            <option value="Euarchontoglires">
                Euarchontoglires
            </option>
            <option value="Eumetazoa">      
                Eumetazoa
            </option>
            <option value="Eutheria">         
                Eutheria
            </option>
            <option value="Glires">           
                Glires
            </option>
            <option value="Gnathostomata">    
                Gnathostomata
            </option>
            <option value="Gymnophiona">       
                Gymnophiona
            </option>
            <option value="Laurasiatheria">    
                Laurasiatheria
            </option>
            <option value="Lepidoptera">      
                Lepidoptera
            </option>
            <option value="Lepidosauria">     
                Lepidosauria
            </option>
            <option value="Lophotrochozoa">    
                Lophotrochozoa
            </option>
            <option value="Mammalia">         
                Mammalia
            </option>
            <option value="Marsupialia">      
                Marsupialia
            </option>
            <option value="Metazoa">             
                Metazoa
            </option>
            <option value="Mollusca">       
                Mollusca
            </option>
            <option value="Muridae">          
                Muridae
            </option>
            <option value="Neoaves">          
                Neoaves
            </option>
            <option value="Neognathae">       
                Neognathae
            </option>
            <option value="Neoptera">          
                Neoptera
            </option>
            <option value="Neopterygii">       
                Neopterygii
            </option>
            <option value="Neotrochozoa">     
                Neotrochozoa
            </option>
            <option value="Octopus">          
                Octopus
            </option>
            <option value="Olfactores">        
                Olfactores
            </option>
            <option value="Osteichthyes">     
                Osteichthyes
            </option>
            <option value="Pancrustacea">     
                Pancrustacea
            </option>
            <option value="Platytrochozoa">      
                Platytrochozoa
            </option>
            <option value="Protostomia">    
                Protostomia
            </option>
            <option value="Sarcopterygii">    
                Sarcopterygii
            </option>
            <option value="Silicispongia">    
                Silicispongia
            </option>
            <option value="Tetrapoda">        
                Tetrapoda
            </option>
            <option value="Theria">            
                Theria
            </option>
            <option value="Vertebrata">        
                Vertebrata
            </option>
            <option value="Xenopus"> 
                Xenopus
            </option>
        </param>
        <param type="text" name="input_species" label="Scientific species name" help="Separated by underscore e.g. Caenorhabditis_elegans">
            <sanitizer invalid_char="">
                <valid initial="string.letters">
                    <add value="_"/>
                </valid>
            </sanitizer>
            <validator type="regex">[a-zA-Z_]+</validator>
        </param>
        <param type="data" name="input1" format="fasta" label="Genome fasta file"/>
    </inputs>
    <outputs>
	<data name="gff_file" format="gff" from_work_dir="results/predictions/gff/${input_species}.PRE.gff" label="${tool.name} on ${on_string}: GFF file"/>
	<data name="filtered_gff_file" format="gff" from_work_dir="results/predictions/filtered_gff/${input_species}.PRE.gff" label="${tool.name} on ${on_string}: filtered GFF file"/>
	<data name="fasta_file" format="fasta" from_work_dir="results/predictions/fasta/${input_species}.PRE.fasta" label="${tool.name} on ${on_string}: fasta sequence of annotation miRNAs"/>
    </outputs>
    <tests>
        <test expect_num_outputs="3">
            <param name="input1" value="ref.fa"/>
            <param name="input_node" value="Caenorhabditis"/>
            <param name="input_species" value="Caenorhabditis_elegans"/>
            <output name="gff_file">
                <assert_contents>
                    <has_n_lines n="24" delta="0"/>
                </assert_contents>
            </output>
            <output name="filtered_gff_file">
                <assert_contents>
                    <has_n_lines n="15" delta="0"/>
                </assert_contents>
            </output>
            <output name="fasta_file">
                <assert_contents>
                    <has_n_lines n="24" delta="0"/>
                </assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[

Accurate microRNA annotation of animal genomes using trained covariance models of curated microRNA complements. MirMachine facilitates automated genome annotation pipelines and deeper studies into the evolution of genome regulation, even in extinct organisms.

    ]]></help>
    <expand macro="citations" />
    <expand macro="creator" />
</tool>
