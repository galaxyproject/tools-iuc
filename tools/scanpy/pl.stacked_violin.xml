<tool id="pl.stacked_violin" name="pl.stacked_violin" version="1.3.1+galaxy1">
    <description>Stacked violin plots</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <command detect_errors="exit_code"><![CDATA[
            python $script_file
        ]]></command>
    <configfiles>
        <configfile name="script_file"><![CDATA[
@CMD_imports@
@CMD_read_inputs@

sc.settings.figdir = '.'

@CMD_params_var_group@

sc.pl.stacked_violin(@CMD_params_plots@ @CMD_params_violin_plots@ swap_axes=$swap_axes, @CMD_params_seaborn_violinplot@ show=False)
]]></configfile>
  </configfiles>
  <inputs>
        <expand macro="inputs_anndata"/>
        <expand macro="params_plots"/>
        <expand macro="violin_plots"/>
        <param name="swap_axes" type="boolean" truevalue="True" falsevalue="False" checked="false" label="Swap axes?" help="By default, the x axis contains `var_names` (e.g. genes) and the y axis the `groupby `categories. By setting `swap_axes` then y are the `groupby` categories and x the `var_names`. When swapping axes var_group_positions are no longer used"/>
        <expand macro="seaborn_violinplot"/>
    </inputs>
    <outputs>
        <expand macro="plot_output"/>
    </outputs>
    <tests>
        <test>
            <conditional name="input">
                <param name="format" value="h5ad" />
                <param name="adata" value="krumsiek11.h5ad" />
            </conditional>
            <conditional name="var_names">
                <param name="type" value="all"/>
            </conditional>
            <param name="groupby" value="cell_type"/>
            <param name="log" value="False"/>
            <param name="use_raw" value="False"/>
            <param name="num_categories" value="7"/>
            <conditional name="figsize">
                <param name="test" value="no"/>
            </conditional>
            <param name="dendrogram" value="False"/>
            <param name="format" value="png"/>
            <conditional name="multi_panel">
                <param name="multi_panel" value="True"/>
            </conditional>
            <conditional name="stripplot">
                <param name="stripplot" value="True"/>
                <conditional name="jitter">
                    <param name="jitter" value="True"/>
                    <param name="size" value="1"/>
                </conditional>
            </conditional>
            <param name="scale" value="width"/>
            <section name="seaborn_violinplot">
                <param name="bw" value="scott"/>
                <param name="linewidth" value="0"/>
                <param name="color" value="AliceBlue"/>
                <param name="palette" value="viridis"/>
                <param name="saturation" value="0.75"/>
            </section>
            <output name="out_png" file="pl.stacked_violin.pbmc68k_reduced_obs.png" ftype="png" compare="sim_size"/>
        </test>
    </tests>
    <help><![CDATA[
Makes a compact image composed of individual violin plots (from `seaborn.violinplot`)
stacked on top of each other. Useful to visualize gene expression per cluster.

Wraps `seaborn.violinplot` for `anndata.AnnData`.

More details on the `scanpy documentation
<https://scanpy.readthedocs.io/en/latest/api/scanpy.api.pl.violin.html#scanpy.api.pl.violin>`__

    ]]></help>
    <expand macro="citations"/>
</tool>
