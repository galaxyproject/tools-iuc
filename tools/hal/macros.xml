<macros>
    <xml name="requirements">
        <requirements>
            <requirement type="package" version="@TOOL_VERSION@">cactus</requirement>
        </requirements>
    </xml>
    <token name="@TOOL_VERSION@">2.9.9</token>
    <token name="@VERSION_SUFFIX@">0</token>
    <!-- 
    <xml name="stdio">
        <stdio>
            # Anything other than zero is an error 
            <exit_code range="1:"/>
            <exit_code range=":-1"/>
            # In case the return code has not been set propery check stderr too 
            <regex match="Error:"/>
            <regex match="Exception:"/>
        </stdio>
    </xml> 
    -->
    <xml name="in_hal_file">
        <param name="in_hal_file" type="data" format="hal" label="Input hal file to analyze" optional="false"/>
    </xml>
    <xml name="params_mmap_size">
        <param argument="--mmapFileSize" type="integer" label="mmap HAL file initial size" 
            value="60" min="0" optional="false"
            help="mmap HAL file initial size (in gigabytes)" />
    </xml>
    <xml name="params_format">
        <conditional name="inputFormat">
            <param name="type" type="select" refresh_on_change="true"
                label="Back-end storage format" 
                help="Choose the back-end storage format of the input hal file">
                <option value="hdf5" selected="true">HDF5</option>
                <option value="mmap">mmap</option>
            </param>
            <when value="hdf5">
            </when>
            <when value="mmap">
            </when>
        </conditional>
    </xml>
    <xml name="params_cache">
        <conditional name="settings">
            <param name="cache" type="select" label="Specify HDF5 caching parameters">
                <option value="default" selected="true">No, use program defaults.</option>
                <option value="custom">Yes, see full parameter list.</option>
            </param>
            <when value="default">
            </when>
            <when value="custom">
                <conditional name="memory">
                    <param name="hdf5InMemory" type="boolean" label="HDF5 in memory" 
                        help="Load all data in memory (and disable hdf5 cache) (--hdf5InMemory)" />
                    <when value="true">
                    </when>
                    <when value="false">
                        <param argument="--hdf5CacheBytes" type="integer" label="HDF5 cache bytes" 
                            value="1048576" min="0"
                            help="Maximum size in bytes of regular hdf5 cache" />
                        <param argument="--hdf5CacheMDC" type="integer" label="HDF5 cache MDC" 
                            value="113" min="0"
                            help="Number of metadata slots in hdf5 cache" />
                        <param argument="--hdf5CacheRDC" type="integer" label="HDF5 cache RDC" 
                            value="521" min="0"
                            help="Number of regular slots in hdf5 cache. Should be a prime number ~= 10 * DefaultCacheRDCBytes / chunk" />
                        <param argument="--hdf5CacheW0" type="float" label="HDF5 cache W0" 
                            value="0.75" min="0"
                            help="w0 parameter for hdf5 cache" />
                    </when>
                </conditional>
            </when>
        </conditional>
    </xml>
        <xml name="params_cache_extended">
        <conditional name="settings">
            <param name="cache" type="select" label="Specify HDF5 parameters">
                <option value="default" selected="true">No, use program defaults.</option>
                <option value="custom">Yes, see full parameter list.</option>
            </param>
            <when value="default">
            </when>
            <when value="custom">
                <conditional name="memory">
                    <param name="hdf5InMemory" type="boolean" label="HDF5 in memory" optional="false"
                        help="Load all data in memory (and disable hdf5 cache) (--hdf5InMemory)" />
                    <when value="true">    
                    </when>
                    <when value="false">
                        <param argument="--hdf5CacheBytes" type="integer" label="HDF5 cache bytes" 
                            value="1048576" min="0" optional="false"
                            help="Maximum size in bytes of regular hdf5 cache" />
                        <param argument="--hdf5CacheMDC" type="integer" label="HDF5 cache MDC" 
                            value="113" min="0" optional="false"
                            help="Number of metadata slots in hdf5 cache" />
                        <param argument="--hdf5CacheRDC" type="integer" label="HDF5 cache RDC" 
                            value="521" min="0" optional="false"
                            help="Number of regular slots in hdf5 cache. Should be a prime number ~= 10 * DefaultCacheRDCBytes / chunk" />
                        <param argument="--hdf5CacheW0" type="float" label="HDF5 cache W0" 
                            value="0.75" min="0" optional="false"
                            help="w0 parameter for hdf5 cache" />
                    </when>
                </conditional>
                <param argument="--hdf5Chunk" type="integer" label="HDF5 chunk size" 
                    value="1000" min="0" optional="false"
                    help="HDF5 chunk size" />
                <param argument="--hdf5Compression" type="integer" label="HDF5 compression factor" 
                    value="2" min="0" max="9" optional="false"
                    help="HDF5 compression factor" />
            </when>
        </conditional>
    </xml>
    <xml name="citation">
        <citations>
            <citation type="doi">10.1093/bioinformatics/btt128</citation>
            <citation type="bibtex">
                @misc{githubhal,
                title = {HAL GitHub page},
                url = {https://github.com/ComparativeGenomicsToolkit/hal},
                }
            </citation>
        </citations>
    </xml>
</macros>