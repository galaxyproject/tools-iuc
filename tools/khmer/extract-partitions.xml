<tool id="gedlab-khmer-extract-partitions" name="Extract partitions" version="@WRAPPER_VERSION@-2">
    <description>Separate sequences that are annotated with partitions into grouped files</description>
    <macros>
        <token name="@BINARY@">extract-partitions.py</token>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <expand macro="stdio" />
    <expand macro="version" />
    <command><![CDATA[
set -xu &&
mkdir -p output &&
cd output &&
@BINARY@
--max-size $max_size
--min-partition-size $min_partition_size
$output_unassigned
output
#for input in $inputs
$input
#end for
&&
mv output.dist $distribution
]]>
    </command>
    <inputs>
        <expand macro="input_sequences_filenames" />
        <param name="max_size" type="integer" label="Max group size" value="1000000"
            help="No more than this many number of sequences will be stored in each output (--max-size/-X)"/>
        <param name="min_partition_size" type="integer" label="Min partition size" value="5"
            help="The minimum partition size worth keeping (--min-partition-size/-m)" />
        <param name="output_unassigned" type="boolean" checked="false" truevalue="--output-unassigned" falsevalue=""
            label="Output unassigned sequences" help="(--output-unassigned/-U)" />
    </inputs>
    <outputs>
        <data name="distribution" format="txt" label="Partition size distribution from ${tool.name}" />
        <collection name="groups-of-partitions" type="list">
            <discover_datasets pattern="__name__" directory="output" />
        </collection>
    </outputs>
    <tests>
        <test>
            <param name="inputs" value="random-20-a.fa.part"/>
            <output_collection name="groups-of-partitions">
                <element name="output.group0000.part" file="random-20-a.part.extract.fa" />
            </output_collection>
        </test>

    </tests>
    <help><![CDATA[
Separate sequences that are annotated with partitions into grouped files.

@HELP_FOOTER@
]]>
    </help>
    <citations>
        <expand macro="software-citation" />
        <expand macro="graph-citation" />
    </citations>
</tool>
