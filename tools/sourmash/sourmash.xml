<tool id="sourmash" name="sourmash" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="@PROFILE@">
    <description>Compute and compare MinHash signatures for DNA data sets</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="xrefs"/>
    <expand macro="requirements"/>
    
    <command detect_errors="exit_code"><![CDATA[
    python '${__tool_directory__}/dna.py' 
    --param-string '[$additional_options.k_mers,$additional_options.scaled,$additional_options.noabund]'
    --from-file '$input_seq'
    --output '$dna_sketch'
    --output-dir 'outputFolder'
    --singleton '$singleton'
    --name-from-first '$name_from_first'
    --randomize '$randomize'
    
    ]]></command>
    <inputs>
        <param name="input_seq" type="data" format="fasta,fasta.gz,fastqsanger,fastqsanger.gz" label="Input DNA Sequence"/>
        <section name="additional_options" title="Additional Options" expanded="true">
            <param name="k_mers" type="integer" value="31" optional="true" multiple="true" label="K-mer size" help="multiple value separated by ',', DEFAULT: 31"/>
            <param name="scaled" type="integer" value="1000" optional="true" label="Scaled factor" help="DEFAULT: 1000"/>
            <param name="noabund" type="select" value="noabund" optional="true" label="Abundance tracking of k-mers" help="DEFAULT: noabund">
                <option value="noabund" selected="true">No abundance tracking of k-mer</option>
                <option value="abund">Abundance tracking of k-mer</option>
            </param>  
            <param argument="--singleton" type="boolean" value="true" optional="true" label="compute a signature for each sequence record individual"/>
            <param argument="--name-from-first" type="boolean" value="true" label="name the signature generated from each file after the first"/>
            <param argument="--randomize" type="boolean" value="true" label="shuffle the list of input filenames randomly"/>
        </section>
    </inputs>
    <outputs>  
        <data name="dna_sketch" format="pdf" from_work_dir="outputFolder/output" label="${tool.name} on ${on_string}:" />
        
       
    </outputs>
    <tests>
        <test expect_num_outputs="1">
            <param name="input_seq" value="GCA_903797575.1_PARATYPHIC668_genomic (1).fna"/>
            <section name="additional_options">
                <param name="k_mers" value="45"/>
                <param name="scaled" value="1040"/>
                <param name="noabund" value="noabund"/>
                <param name="singleton" value="TRUE"/>
                <param name="name_from_first" value="TRUE"/>
                <param name="randomize" value="TRUE"/>
            </section>
            
            <output name="dna_sketch">
                <assert_contents>
                    <has_size value="7373" delta="1000" />
                </assert_contents>
            </output>
        </test>
    </tests>
    
    <help><![CDATA[
    Quickly search, compare, and analyze genomic and metagenomic data sets

    ]]></help>
    <expand macro="citations"/>
</tool>
