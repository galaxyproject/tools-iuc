<macros>
    <xml name="requirements">
        <requirements>
            <requirement type="package" version="@TOOL_VERSION@">sourmash</requirement>
        </requirements>
    </xml>
    <token name="@TOOL_VERSION@">4.9.4</token>
    <token name="@VERSION_SUFFIX@">0</token>
    <token name="@PROFILE@">21.05</token>
    <xml name="citations">
        <citations>
            <citation type="doi">10.21105/joss.06830</citation>
        </citations>
        <creator>
        <organization name="Galaxy Europe"/>
        <person givenName="Ahmad" familyName="Mahagna" url="https://github.com/Smkingsize"/>
        <person givenName="Saim" familyName="Momin" url="https://github.com/SaimMomin12"/>
    </creator>
    </xml>
    <!-- Pick list Macros -->
    <token name="@Picklist_copy_file@"><![CDATA[
    #if $picklist_cond.picklist_param == "true":
        ln -s $picklist_cond.picklist_file list.csv &&
    #end if
    ]]></token>
    <token name="@Picklist_commandline@"><![CDATA[
    #if $picklist_cond.picklist_param=="true": 
        #set exp = 'list.csv:%s:%s:%s' % ($picklist_cond.colname, str($picklist_cond.coltype), str($picklist_cond.pickstyle))
        --picklist $exp
    #end if
    ]]></token>
    <token name="@Picklist_help@">
    **Picklist**

    Picklist is a feature by which you can select or “pick out” signatures based on values in a CSV file. 
    This is typically used to index, extract, or search a subset of a large collection where modifying the collection itself isn’t desired.
    
    The --picklist argument has these 4 params:
        - pickfile: is a CSV file
        - colname: the name of the column to select from the CSV file (based on the headers in the first line of the CSV file)
        - coltype: the type of match
        - pickstyle: include or exclude

    The following coltypes are currently supported for picklists:
        - name - exact match to signature’s name
        - md5 - exact match to signature’s md5sum
        - md5prefix8 - match to 8-character prefix of signature’s md5sum
        - md5short - same as md5prefix8
        - ident - exact match to signature’s identifier
        - identprefix - match to signature’s identifier, before ‘.’
        - gather - use the CSV output of sourmash gather as a picklist
        - prefetch - use the CSV output of sourmash prefetch as a picklist
        - search - use the CSV output of sourmash prefetch as a picklist
        - manifest - use CSV manifests produced by sig manifest, sig collect, or sig check as a picklist

    You can also *sourmash sig describe --csv out.csv signatures* or *sourmash sig manifest -o out.csv 'filename_or_db'* to construct an initial CSV file that you can then edit further and use as a picklist as above.    
    </token>
    <xml name="picklist_macro">
        <conditional name="picklist_cond" label="Picklist">
            <param name="picklist_param" label="Picklist" type="select" help="Please read Help section at the end!">
                <option value="true">Yes</option>
                <option value="false" selected="true">No</option>
            </param>
            <when value="true">
                <param name="picklist_file" type="data" format="csv" label="Picklist file" help="input signatures files (created with souramsh sksetch)"/>
                <param name="colname" type="text" optional="false" label="Column" help="column to select from the CSV file (based on the headers in the first line of the CSV file)"/>
                <param name="coltype" type="select" label="Type of match" help="column to select from the CSV file (based on the headers in the first line of the CSV file)">
                    <option value="name" selected="true">name</option>
                    <option value="md5">md5</option>
                    <option value="md5prefix8">md5prefix8</option>
                    <option value="md5short">md5short</option>
                    <option value="ident">ident</option>
                    <option value="identprefix">identprefix</option>
                    <option value="gather">gather</option>
                    <option value="prefetch">prefetch</option>
                    <option value="search">search</option>
                    <option value="manifest">manifest</option>
                </param>
                <param name="pickstyle" type="select" label="Pick style" help="Weather to include or exclude picked signatures">
                    <option value="include" selected="true">include</option>
                    <option value="exclude">exclude</option>
                </param>
            </when>
            <when value="false"/>
        </conditional>
    </xml>
</macros>