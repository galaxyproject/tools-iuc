<tool id="scvis_train" name="SCVIS train" version="0.1.0">
    <description>Parametric alternative to t-SNE for use in high-dimensional data analysis.</description>
    <requirements>
        <requirement type="package" version="0.1.0">scvis</requirement>
        <requirement type="package">tensorflow</requirement>
    </requirements>
    <command detect_errors="agressive"><![CDATA[
scvis train --data_matrix_file '${datafile}'
  #if $labels.label == 'Yes':
      --data_label_file '${datalabel}'
  #end if
  #if $config.choice == "Yes":
      --config_file '${configfile}'
  #end if
  #if $norm.normalize == "Yes":
      --normalize your_number '${normval}'
  #end if
  --out_dir .
  --show_plot
    ]]></command>
    <inputs>
        <param name="datafile" type="data" label="Data Matrix File" help="Data matrix with first row as the column names" format="tsv"/>
            <conditional name="labels">
                <param name="label" type="select" label="Provide clustering information" help="Give cluster information for graph coloring?">
                    <option value="No">No</option>
                    <option value="Yes">Yes</option>
                </param>
                <when value="No"/>
                <when value="Yes">
                    <param name="datalabel" type="data" label="Data Label File" help="Optional: One column file with header provinding corresponding cluster information for each data point. Used for coloring plots." format="tsv"/>
                </when>
            </conditional>
            <conditional name="config">
                <param name="choice" type="select" label="Provide config file">
                    <option value="No">No</option>
                    <option value="Yes">Yes</option>
                </param>
                <when value="No"/>
                <when value="Yes">
                    <param name="configfile" type="data" label="Config File" help="Optional: Config yaml file as specified in the scvis docs" format="yaml" optional="true"/>
                </when>
            </conditional>
            <conditional name="norm">
                <param name="normalize" type="select" label="Set Normalization Value?" help="If not selected, normalization will use maximum absolute value">
                    <option value="No">No</option>
                    <option value="Yes">Yes</option>
                </param>
                <when value="No"/>
                    <param name="normval" value=""/>
                <when value="Yes">
                     <param name="normval" type="float" label="Normalization value" help="A positive float" value="0.5"/>
                </when>
            </conditional>
    </inputs>
    <outputs>
      <collection name="graphs" type="list" label="Graphical_outputs">
          <discover_datasets pattern=".png" directory="outputs/*_result/embedding_iter_00000"/>
      </collection>
    </outputs>
    <citations>
        <citation type="doi">10.1038/s41467-018-04368-5</citation>
    </citations>
    <help><![CDATA[
This tool is for the initial training of the model and clustering graphs. To add data to your model, use SCVIS map.
    ]]></help>
</tool>
