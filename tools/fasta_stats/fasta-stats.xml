<tool id="fasta-stats" name="Fasta Statistics" version="1.0.4" profile="20.05">
    <description>display summary statistics for a FASTA file</description>
    <requirements>
        <requirement type="package" version="1.21.4">numpy</requirement>
        <requirement type="package" version="1.79">biopython</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        python '${__tool_directory__}/fasta-stats.py'
        '$input_fasta'
        '$stats'
        '$gap_stats'
        #if $estimated_genome_size
            $estimated_genome_size
        #end if
        ]]>
    </command>
    <inputs>
        <param name="input_fasta" type="data" format="fasta" label="FASTA or Multi-FASTA file" help="FASTA dataset to get statistics."/>
        <param name="estimated_genome_size" type="integer" min="0" optional="true" label="Estimated genome size" help="This parameter is optional. If provided, it will be used for calculating the NG50 statistic." />
        <param name="gaps_option" type="boolean" truevalue="true" falsevalue="false" label="Generate gap stats"/>
    </inputs>
    <outputs>
        <data name="stats" format="tabular" label="${tool.name} on ${on_string}: summary stats"/>
        <data name="gap_stats" format="bed" label="${tool.name} on ${on_string}: Gap stats">
            <filter>gaps_option</filter>
        </data>
    </outputs>
    <tests>
        <test expect_num_outputs="1">
            <param name="input_fasta" value="test.fasta"/>
            <output name="stats" file="test_01.tab" ftype="tabular"/>
        </test>
        <!--Test gap options and NG50-->
        <test expect_num_outputs="2">
            <param name="input_fasta" value="ng50_input.fasta"/>
            <param name="gaps_option" value="true"/>
            <param name="estimated_genome_size" value="4000"/>
            <output name="stats" file="test_02.tab" ftype="tabular"/>
            <output name="gap_stats" file="test_02.bed" ftype="bed"/>
        </test>
    </tests>
    <help>

 .. class:: infomark

**Purpose**

Displays the summary statistics for a FASTA file.

------

 .. class:: infomark

**Outputs**

This tool generates two outputs: a general summary and an optional gap stats file.

The general summary includes the following information:

- Lengths: n50, min, max, median and average
- Number of base pairs: A, C, G, T, N, Total and Total_not_N
- Number of sequences
- GC content

In addition the optional gap stats BED file includes the information about gaps localization.

    </help>
    <citations>
        <citation type="bibtex">
            @UNPUBLISHED{Anmol_Kyran2021,
                author = {Anmol Kyran},
                title = {Fasta Statistics: Display summary statistics for a fasta file.},
                year = {2021},
                url = {https://github.com/galaxyproject/tools-iuc},
            }
        </citation>
    </citations>
</tool>
