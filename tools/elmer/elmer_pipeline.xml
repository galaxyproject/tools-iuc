<tool id="elmer_pipeline" name="ELMER pipeline" version="1.0">
    <description>distal enhancer DNA methylation analysis and predict putative target genes, motif analysis
and identify regulatory transcription factors</description>
     <macros>
        <import>elmer_macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <command detect_errors="exit_code"><![CDATA[
        Rscript "${tcga_pipe}"
        && 
        mkdir "./res"
        &&
        mv "./Results/${disease}/*" "./res/."
        ]]></command>
    <configfiles>
        <configfile name="tcga_pipe"><![CDATA[
## IF disease type NOT available, stop.
if(is.null("${disease}")){
   stop("The disease name should be from TCGA")
}

## Download all TCGA data

ELMER::TCGA.pipe("${disease}",cores=detectCores()/2,permu.size=300,Pe=0.01)

    ]]></configfile>
    </configfiles>
    <inputs>
        <param name="disease" type="text" value="LUAD" label="Cancer type from TCGA"/>
        <!--<param name="diffdir" type="boolean" checked="true" truevalue="hypo" falsevalue="hyper"-->
            <!--label="Select direction of methylation, Yes: Hypo, No: Hyper" />-->
    </inputs>
    <outputs>
        <!--<data name="getMethdiff.${diffdir}.probes.csv" format="csv" label="${disease}_getMethdiff.${diffdir}.probes.csv" />-->
        <!--<data name="getMethdiff.${diffdir}.probes.significant.csv" format="csv" label="${disease}_getMethdiff.${diffdir}.probes.significant.csv" />-->

        <!--<data name="geneInfo.rda" format="rdata" label="${disease}_geneInfo.rda" />-->
        <!--<data name="hypo.probes_nearGenes.rda" format="rdata" label="${disease}_hypo.probes_nearGenes.rda" />-->
        <!--<data name="probeInfo_feature_distal.rda" format="rdata" label="${disease}_probeInfo_feature_distal.rda" />-->
        <!--<data name="${disease}_meth_refined.rda" format="rdata" label="${disease}_meth_refined.rda" />-->
        <!--<data name="${disease}_RNA_refined.rda" format="rdata" label="${disease}_RNA_refined.rda" />-->
        <!--[> Insert more outputs <]-->
        <data format="txt" name="report">
            <discover_datasets pattern="__designation_and_ext__" directory="./Result/${disease}/" visible="true" />
        </data>

    </outputs>
    <help>
**What it does:**

ELMER, uses only methylation and expression data, and does not require any chromatin conformation or ChIP-seq data. Furthermore, by identifying transcription factor binding motifs present within enhancers, and incorporating expression patterns of upstream transcription factors, ELMER is able to infer transcription factor networks activated in specific cancer subtypes.


**Input:**

disease A character specifies the disease to download in TCGA such as BLCA,LUAD,LUSC,BRCA etc


**Output:**

Complete ELMER results for TCGA data

    </help>
    <expand macro="citations" />
</tool>
