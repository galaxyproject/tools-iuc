<tool id="paired_end_read_map_quality_filter" name="Paired-end Read map quality filter" version="1.0.0">
    <description></description>
    <requirements>
        <requirement type="package" version="0.8.3">pysam</requirement>
    </requirements>
    <command>
        <![CDATA[
            ln -f -s "${input.metadata.bam_index}" "${input}.bai" &&
            python $__tool_directory__/paired_end_read_map_quality_filter.py
            --input "$input"
            --output "$output"
        ]]>
    </command>
    <inputs>
        <param name="input" type="data" format="bam" label="BAM file" />
    </inputs>
    <outputs>
        <data name="output" format="bam" />
    </outputs>
    <tests>
        <test>
            <param name="input" value="input.bam" ftype="bam" />
            <output name="output" file="output.bam" ftype="bam" />
        </test>
    </tests>
    <help>

**What it does**

<![CDATA[
This tool filters a BAM file on the MAPQ (mapping quality), retaining the reads
of MAPQ score pairs in the following cases:

 - A sequence mapping quality is greater than 5
 - Read1 > 5 and Read2 = 0
 - Read1 = 0 and Read2 > 5

This tool overcomes a current limitation of SAMtools, which does not support the
MAPQ filter using both Reads' MAPQ scores.
]]>
    </help>
    <citations>
        <citation type="bibtex">
            @unpublished{None,
            author = {Bongsoo Park},
            title = {None},
            year = {None},
            eprint = {None},
            url = {http://www.huck.psu.edu/content/research/independent-centers-excellence/center-for-eukaryotic-gene-regulation}
        }</citation>
    </citations>
</tool>
