<macros>
    <token name="@LAST_CONDA_VERSION@">1021</token>
    <token name="@LAST_HELP@"><![CDATA[
        Documentation : http://last.cbrc.jp/

        LAST finds similar regions between sequences.

        The main technical innovation is that LAST finds initial matches based on their multiplicity, instead of using a fixed length (e.g. BLAST uses 11-mers). To find these variable-length matches, it uses a suffix array (inspired by Vmatch). To achieve high sensitivity, it uses a spaced suffix array (or subset suffix array), analogous to spaced seeds (or subset seeds).

        LAST can:
            - Handle big sequence data, e.g:
                - Compare two vertebrate genomes.
                - Align billions of DNA reads to a genome.
            - Indicate the reliability of each aligned column.
            - Use sequence quality data properly.
            - Compare DNA to proteins, with frameshifts.
            - Compare PSSMs to sequences.
            - Calculate the likelihood of chance similarities between random sequences.
            - Do split and spliced alignment.
            - Train alignment parameters for unusual kinds of sequence (e.g. nanopore).

    ]]></token>
    <xml name="citations">
        <citation type="doi">10.1101/gr.113985.110</citation>
    </xml>

    <xml name="input_db">
        <conditional name="db_opts">
            <param name="db_opts_input" type="select" label="Reference database">
              <option value="db">Locally installed LAST database</option>
              <option value="lastdb" selected="true">LAST database from history</option>
            </param>
            <when value="db">
                <param name="database" type="select" multiple="true" label="LAST database">
                    <options from_data_table="lastdb" />
                </param>
                <param name="lastdatabase" type="hidden" value="" />
            </when>
            <when value="lastdb">
                <param name="database" type="hidden" value="" />
                <param name="lastdatabase" type="data" label="LAST database" />
            </when>
        </conditional>
    </xml>

    <xml name="step_macro" token_step="1">
    	<param name="step" argument="-w" type="integer" value="@STEP@" label="Use initial matches starting at every w-th position in each sequence"/>
    	<param name="size" argument="-W" type="integer" value="1" label="Use minimum positions in sliding windows of W consecutive positions"/>
    	<!-- -m ignored if -u is defined scheme -->
    	<param name="pattern" argument="-m" type="integer" value="1" label="Seed pattern"/>
    </xml>

    <xml name="cost_macro" token_a="7" token_b="1">
        <section name="cost_opt" title="Cost options" expanded="false">
            <param name="gap_existence_cost" argument="-a" type="integer" value="@A@" label="Gap existence cost"/>
	    <param name="gap_extension_cost" argument="-b" type="integer" value="@B@" label="Gap extension cost"/>
	    <param name="insertion_existence_cost" argument="-A" type="integer" value="@A@" label="Insertion existence cost"/>
	    <param name="insertion_extension_cost" argument="-B" type="integer" value="@B@" label="Insertion extension cost"/>
	</section>
    </xml>

    <xml name="score_macro">
        <section name="score_opt" title="Score options" expanded="false">
	    <param name="match_mismatch" argument="-X" type="select" multiple="false" label="N/X is ambiguous">
	        <option value="0" selected="true">Neither sequence</option>
	        <option value="1">Reference</option>
	        <option value="2">Query</option>
	        <option value="3">Both</option>
	    </param>        	
	    <!--
	    <param name="residue_pair_cost" argument="-c" type="integer" value="0" label="Unaligned residue pair cost"/>
	    <param name="frameshift_cost" argument="-F" type="integer" value="0" label="Frameshift cost"/>
		-->
	    <param name="max_score_pre_gap" argument="-x" type="integer" value="21" label="Maximum score drop for preliminary gapped alignments"/>
	    <param name="max_score_gapless" argument="-y" type="integer" value="9" label="Maximum score drop for gapless alignments"/>
	    <param name="max_score_gapped" argument="-z" type="integer" value="21" label="Maximum score drop for final gapped alignments"/>
	    <param name="min_score_gapless" argument="-d" type="integer" value="13" label="Minimum score for gapless alignments"/>
	    <param name="min_score_gapped" argument="-e" type="integer" value="22" label="Minimum score for gapped alignments"/>
	</section>
    </xml>
</macros>
