<tool id="prodigal" name="Prodigal Gene Predictor" version="0.1.0+galaxy0" profile="21.05">
    <description>A tool for gene prediction in microbial genomes</description>
    <requirements>
        <requirement type="package" version="2.6.3">prodigal</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        prodigal 
        -i '$input_fa'
        #if $input_train 
        -t '$input_train'
        #end if 
        -o '$output' 
        -f '$out_format' 
        -p '$procedure' 
        -g '$trans_table' 
        -a '$output_faa' 
        -d '$output_fnn' 
        -s '$output_start' 
        $closed 
        $force_nonsd
        $masked_seq
    ]]></command>
    <inputs>
        <param type="data" name="input_fa" format="fa" label="Specify input file" help="-i" />
        <param type="data" name="input_train" format="fa" label="Specify training file" optional="true" help="Read and use the specified training file (-t)" />
        <param type="select" name="out_format" label="Specify output format" help="-f" >
            <option value="gbk" selected="true">GBK (default)</option>
            <option value="gff">GFF</option>
            <option value="sqn">SQN</option>
            <option value="sco">SCO</option>
        </param> 
       <param type="select" name="procedure" label="Specify mode" help="-p" >
            <option value="single" selected="true">Single : Single genome, any number of
                sequences (default)</option>
            <option value="meta">Meta : Anonymous sequences, analyze
                using preset training files, ideal for metagenomic data or single short sequences</option>
        </param>
        <param type="select" name="trans_table" label="Specify a translation table to use" help="-g" >
            <option value="11">11 : Standard Bacteria/Archaea (default)</option>
            <option value="4">4 : Mycoplasma/Spiroplasma</option>
            <option value="#"># : Other genetic codes 1-25</option>
        </param> 
        <param name="closed" type="boolean" label="Closed ends" truevalue="-c" falsevalue="" optional="true" help="Closed ends.  Do not allow partial genes
        at edges of sequence (-c)" />
        <param name="force_nonsd" type="boolean" label="Force Prodigal to scan for
        motifs" truevalue="-n" falsevalue="" optional="true" help="Do not use the Shine-Dalgarno RBS finder and instead force Prodigal to scan for motifs (-n)" />
        <param name="masked_seq" type="boolean" label="Treat runs of N as masked sequence" truevalue="-m" falsevalue="" optional="true" help="Treat runs of N as masked sequence; don't build genes across them (-m)" />
    </inputs>
    <outputs>
        <data name="output" format="${out_format}" label="${tool.name} on ${on_string} : coordinates" />
        <data name="output_faa" format="faa" label="${tool.name} on ${on_string} : protein translations file" />
        <data name="output_fnn" format="fnn" label="${tool.name} on ${on_string} : nucleotide sequences file" />
        <data name="output_start" format="tabular" label="${tool.name} on ${on_string} : complete starts file" />
    </outputs>
    <tests>
        <test>
            <param name="input_fa" value="input.fna"/>
            <output name="output" file="output"/>
        </test>
        <test>
            <param name="input_fa" value="input.fna"/>
            <output name="output" file="output"/>
            <output name="output_faa" file="output.faa"/>
            <output name="output_fnn" file="output.fnn"/>
            <output name="output_start" file="output.start"/>
        </test>
        <test>
            <param name="input_fa" value="input.fna"/>
            <param name="out_format" value="gff"/>
            <output name="output" file="output.gff"/>
            <output name="output_faa" file="output.faa"/>
            <output name="output_fnn" file="output.fnn"/>
            <output name="output_start" file="output.start"/>
        </test>
        <test>
            <param name="input_fa" value="input.fna"/>
            <param name="trans_table" value="4"/>
            <output name="output" file="output_tt"/>
            <output name="output_faa" file="output_tt.faa"/>
            <output name="output_fnn" file="output_tt.fnn"/>
            <output name="output_start" file="output_tt.start"/>
        </test>
        <test>
            <param name="input_fa" value="input.fna"/>
            <param name="procedure" value="single"/>
            <param name="closed" value="true"/>
            <param name="force_nonsd" value="true"/>
            <param name="masked_seq" value="true"/>
            <output name="output" file="output_c_n_m"/>
            <output name="output_faa" file="output_c_n_m.faa"/>
            <output name="output_fnn" file="output_c_n_m.fnn"/>
            <output name="output_start" file="output_c_n_m.start"/>
        </test>
        <test>
            <param name="input_fa" value="input.fna"/>
            <param name="input_train" value="train_file.trn"/>
            <output name="output" file="output_train"/>
            <output name="output_faa" file="output_train.faa"/>
            <output name="output_fnn" file="output_train.fnn"/>
            <output name="output_start" file="output_train.start"/>
        </test>
    </tests>
    <help><![CDATA[
        
Usage:  prodigal [-a trans_file] [-c] [-d nuc_file] [-f output_type] [-g tr_table] [-h] [-i input_file] [-m] [-n] [-o output_file] [-p mode] [-q] [-s start_file] [-t training_file] [-v]

 -a :  Write protein translations to the selected file.
  -c :  Closed ends.  Do not allow genes to run off edges.
   -d :  Write nucleotide sequences of genes to the selected file.
    -f :  Select output format (gbk, gff, or sco).  Default is gbk.
     -g :  Specify a translation table to use (default 11).
      -h :  Print help menu and exit.
       -i :  Specify FASTA/Genbank input file (default reads from stdin).
        -m :  Treat runs of N as masked sequence; don't build genes across them.
         -n :  Bypass Shine-Dalgarno trainer and force a full motif scan.
          -o :  Specify output file (default writes to stdout).
           -p :  Select procedure (single or meta).  Default is single.
            -q :  Run quietly (suppress normal stderr output).
             -s :  Write all potential genes (with scores) to the selected file.
              -t :  Write a training file (if none exists); otherwise, read and use the specified training file.
               -v :  Print version number and exit.


    ]]></help>
    <citations>
        <citation type="doi">10.1186/1471-2105-11-119</citation>
        <citation type="bibtex">
@misc{githubProdigal,
  author = {LastTODO, FirstTODO},
  year = {TODO},
  title = {Prodigal},
  publisher = {GitHub},
  journal = {GitHub repository},
  url = {https://github.com/hyattpd/Prodigal},
}</citation>
    </citations>
</tool>