<tool id="strelka_somatic" name="Strelka Somatic" version="@TOOL_VERSION@+galaxy1">
    <macros>
        <import>macros.xml</import>
    </macros>
    <description>@DESCRIPTION@ for somatic variation in tumor/normal sample pairs</description>
    <expand macro="requirements" />
    <command detect_errors="exit_code"><![CDATA[
        ## init: symbolic links
            ln -s '$input_normal' ./input_normal.bam &&
            ln -s '$input_tumor' ./input_tumor.bam &&
            ln -s '$input_ref' ./input_ref.fasta &&

        ## init: create index files
            samtools index ./input_normal.bam &&
            samtools index ./input_tumor.bam &&
            samtools faidx ./input_ref.fasta &&

        ## tool: configuration
        configureStrelkaSomaticWorkflow.py
            --normalBam ./input_normal.bam
            --tumorBam ./input_tumor.bam
            --referenceFasta ./input_ref.fasta
            --runDir ./results &&

        ## tool: workflow execution
        @RUN_WORKFLOW@

    ]]></command>
    <inputs>
        <param argument="--normalBam" name="input_normal" multiple="false" type="data" format="bam" label="Input normal BAM" help=""/>
        <param argument="--tumorBam" name="input_tumor" multiple="false" type="data" format="bam" label="Input tumor BAM" help=""/>
        <param argument="--referenceFasta" name="input_ref" multiple="false" type="data" format="fasta" label="Input Reference" help=""/>

        <!-- Temp <param name="testcase" type="hidden" value="strelkaSomaticDemoAnalysis"/> -->
    </inputs>
    <outputs>
        <data name="indels" format="data" from_work_dir="results/results/variants/somatic.indels.vcf.gz" label="Indels"/>
        <data name="snvs" format="data" from_work_dir="results/results/variants/somatic.snvs.vcf.gz" label="SNVS"/>

        <!-- Temp <data name="output_stderr" format="txt" label="stderr"/> -->
   </outputs>
    <tests>
        <!-- germline -->
        <test>
            <!-- Temp
            <param name="testcase" value="strelkaGermlineDemoAnalysis" /> -->

            <param name="input_normal" value="sample1.bam" ftype="bam"/>
            <param name="input_tumor" value="sample2.bam" ftype="bam"/>
            <param name="input_ref" value="hg98.fa" ftype="fasta"/>

            <!-- Temp
            <output name="output_stderr">
                <assert_contents>
                    <has_text text="strelkaGermlineDemoAnalysis" />
                </assert_contents>
            </output> -->
        </test>
    </tests>
    <help><![CDATA[
...
    ]]></help>
    <expand macro="citations" />
</tool>