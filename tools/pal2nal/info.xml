<macros>
    <token name="@TOOL_VERSION@">14.1</token>
    <token name="@WRAPPER_VERSION@">0</token>
    <xml name="help">
        <help><![CDATA[
**Overview**

PAL2NAL converts a protein multiple sequence alignment plus the matching nucleotide FASTA records into a codon-aware alignment suitable for downstream Ka/Ks analyses. The script is maintained by Mikita Suyama (Kyushu University) and is distributed under GPL v2. This Galaxy wrapper surfaces the upstream `pal2nal.pl` tool so that codon alignments can be created inside workflows.

**Inputs**

* *Protein alignment (pep.aln)* — CLUSTAL or FASTA alignment of the translated sequences. Alignments may contain more than two sequences, and frame-shift events can be annotated by numeric placeholders (for example, `2` indicates a single base deletion; see the bundled `test.aln` example).
* *Nucleotide FASTA (nuc.fasta)* — Corresponding DNA or mRNA sequences. Attach one or more FASTA datasets (use *Add new Nucleotide FASTA files* for additional inputs). Sequence identifiers must match those in the protein alignment; order is detected automatically when identifiers match.

**Options**

* `-output clustal|paml|fasta|codon` (Galaxy: *Output format*).
* `-blockonly` — Restrict output to user-marked blocks (`#` rows in CLUSTAL alignments).
* `-nogap` — Remove codons containing gaps or in-frame stops.
* `-nomismatch` — Remove codons where amino acid and nucleotide sequences disagree (useful for discarding pseudogene regions).
* `-codontable` — Choose an NCBI genetic code (1, 2, 3, 4, 5, 6, 9, 10, 11, 12, 13, 14, 15, 16, 21, 22, 23).
* `-html` — Produce HTML formatted output (Galaxy: enable *Add HTML formatted output* to store the optional HTML view).
* `-nostderr` — Suppress STDERR warnings (for example, expected pseudogene mismatches).

**Outputs**

* Codon-respecting alignment rendered in the selected format (Galaxy labels the dataset as CLUSTAL, PAML, FASTA, HTML, or plain text as appropriate).

**Example:**

```pal2nal.pl inputs/test.aln inputs/test.nuc -output paml -nogap > inputs/for_paml/test.codon```

**Ka/Ks calculation**

To compute Ka and Ks values, run the resulting codon alignment through PAML's `codeml`, as illustrated in the PAL2NAL distribution (`inputs/for_paml/test.cnt`, `test.tree`, `test.codeml.ori`).

**Warnings**

PAL2NAL issues messages when protein residues and underlying codons disagree (for example, pseudogene cases). These warnings are harmless unless they indicate unintended mismatches; enable *Suppress STDERR messages* to hide them.

**References and contacts**

* PAL2NAL website: http://www.bork.embl.de/pal2nal
* Support: Mikita Suyama (mikita@bioreg.kyushu-u.ac.jp)
* Example data: `inputs/test.aln`, `inputs/test.nuc`, and PAML helpers inside the `inputs/for_paml/` directory.
        ]]></help>
    </xml>
    <xml name="citations">
        <citations>
            <citation type="doi">10.1093/nar/gkl315</citation>
        </citations>
    </xml>
</macros>
