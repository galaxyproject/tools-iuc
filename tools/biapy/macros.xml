<macros>
    <token name="@TOOL_VERSION@">3.6.8</token>
    <token name="@VERSION_SUFFIX@">0</token>
    <token name="@PROFILE@">25.0</token>

    <xml name="requirements">
        <requirements>
            <container type="docker">biapyx/biapy:3.6.8-11.8</container>
        </requirements>
    </xml>
    <xml name="creators">
        <creator>
            <person givenName="Daniel" familyName="Franco" url="https://danifranco.github.io/" identifier="https://orcid.org/0000-0002-1109-110X" />
        </creator>
    </xml>
    <xml name="citations">
        <citations>
            <citation type="doi">10.1038/s41592-025-02699-y</citation>
            <yield/>
        </citations>
    </xml>

    <xml name="train_raw_param" token_optional="false">
        <param name="raw_train" type="data" format="tiff,tif,png,jpg,h5" optional="@OPTIONAL@" multiple="true" label="Specify the training raw images" help="Select the training images; all must have the same number of channels, and each channel should contain the same type of information (see https://biapy.readthedocs.io/en/latest/get_started/how_it_works.html for details)."/>
    </xml>

    <xml name="train_gt_param" token_optional="false">
        <param name="gt_train" type="data" format="tiff,tif,png,jpg,h5,csv,txt" optional="@OPTIONAL@" multiple="true" label="Specify the training ground truth (target) images" help="Select the ground truth (target) data for training; the expected format depends on the workflow (e.g. masks for semantic/instance segmentation, centroid files for detection, high-res images for super-resolution, paired images for image-to-image); see https://biapy.readthedocs.io/en/latest/get_started/select_workflow.html for details."/>
    </xml>

    <xml name="test_raw_param" token_optional="false">
        <param name="raw_test" type="data" format="tiff,tif,png,jpg,h5" optional="@OPTIONAL@" multiple="true" label="Specify the test raw images" help="Select the test images; all must have the same number of channels, and each channel should contain the same type of information to avoid confusing the model."/>
    </xml>

    <xml name="test_gt_param" token_optional="false">
        <param name="gt_test" type="data" format="tiff,tif,png,jpg,h5,csv,txt" optional="@OPTIONAL@" multiple="true" label="Specify the test ground truth/target images (optional)" help="Select the ground truth (target) data for testing; the expected format depends on the workflow (e.g. masks for semantic/instance segmentation, centroid files for detection, high-res images for super-resolution, paired images for image-to-image). If provided, BiaPy will compute workflow-specific evaluation metrics on the test set. See https://biapy.readthedocs.io/en/latest/get_started/select_workflow.html for details."/>
    </xml>

    <xml name="supervised_phase_block">
        <conditional name="phase_decision">
            <param name="phases" type="select" label="What do you want to do?" help="Select which workflow phases to run: training (fit the model to labeled data) and/or testing (inference/prediction on new images using the trained model).">
                <option value="train_test" selected="true">Train and test a model</option>
                <option value="train">Train a model</option>
                <option value="test">Test a model</option>
            </param>
            <when value="train_test">
                <section name="train_sec" title="Train data" expanded="True"> 
                    <expand macro="train_raw_param"/>
                    <expand macro="train_gt_param"/>
                </section> 
                <section name="test_sec" title="Test data" expanded="True"> 
                    <expand macro="test_raw_param"/>
                    <conditional name="test_gt_selection">
                        <param name="has_gt" type="select" label="Do you have test ground truth (target) data?" help="Select whether you have target data, or ground truth, for the test data. If you have this, BiaPy will be able to calculate various metrics, which will vary depending on the selected workflow, to measure the model's performance by comparing the test image predictions with the provided ground truth.">
                            <option value="no" selected="true">No</option>
                            <option value="yes">Yes</option>
                        </param>
                        <when value="yes">
                            <expand macro="test_gt_param"/>
                        </when>
                        <when value="no"/>
                    </conditional>
                </section> 
            </when>

            <when value="train">
                <section name="train_sec" title="Train data" expanded="True"> 
                    <expand macro="train_raw_param"/>
                    <expand macro="train_gt_param"/>
                </section> 
            </when>

            <when value="test">
                <section name="test_sec" title="Test data" expanded="True"> 
                    <expand macro="test_raw_param"/>
                    <conditional name="test_gt_selection">
                        <param name="has_gt" type="select" label="Do you have test ground truth (target) data?" help="Select whether you have target data, or ground truth, for the test data. If you have this, BiaPy will be able to calculate various metrics, which will vary depending on the selected workflow, to measure the model's performance by comparing the test image predictions with the provided ground truth.">
                            <option value="no" selected="true">No</option>
                            <option value="yes">Yes</option>
                        </param>
                        <when value="yes">
                            <expand macro="test_gt_param"/>
                        </when>
                        <when value="no"/>
                    </conditional>
                </section> 
            </when>
        </conditional>
    </xml>

    <xml name="unsupervised_phase_block">
        <conditional name="phase_decision">
            <param name="phases" type="select" label="What do you want to do?" help="Select which workflow phases to run: training (fit the model to labeled data) and/or testing (inference/prediction on new images using the trained model).">
                <option value="train_test" selected="true">Train and test a model</option>
                <option value="train">Train a model</option>
                <option value="test">Test a model</option>
            </param>
            <when value="train_test">
                <section name="train_sec" title="Train data" expanded="True"> 
                    <expand macro="train_raw_param"/>
                </section> 
                <section name="test_sec" title="Test data" expanded="True"> 
                    <expand macro="test_raw_param"/>
                </section> 
            </when>

            <when value="train">
                <section name="train_sec" title="Train data" expanded="True"> 
                    <expand macro="train_raw_param"/>
                </section> 
            </when>

            <when value="test">
                <section name="test_sec" title="Test data" expanded="True"> 
                    <expand macro="test_raw_param"/>
                </section> 
            </when>
        </conditional>
    </xml>
</macros>