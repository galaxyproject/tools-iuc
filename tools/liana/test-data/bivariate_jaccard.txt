

import liana as li
import scanpy as sc
import pandas as pd
    
    

adata = sc.read_h5ad('anndata.h5ad')
    
    

result = li.method.bivariate(
    adata,
    local_name='jaccard',
    global_name=None,
    resource_name='consensus',
    connectivity_key='spatial_connectivities',
    mask_negatives=True,
    add_categories=False,
    n_perms=1000,
    use_raw=False,
    seed=1337,
    nz_prop=0.05,
    verbose=False)
if result is not None:
    adata.uns['liana_bivariate'] = result



adata.write_h5ad('anndata.h5ad', compression='gzip')
with open('anndata_info.txt','w', encoding='utf-8') as ainfo:
    print(adata, file=ainfo)
    
    
        
        anndata.h5ad
anndata_info.txt
conda_activate.log
