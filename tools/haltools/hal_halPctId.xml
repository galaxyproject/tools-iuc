<tool id="hal_halPctId" name="halPctId" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="@PROFILE@">
    <description>calculates % identity by sampling bases</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/> 
    <expand macro="stdio"/>
    <command detect_errors="aggressive"><![CDATA[
        halPctId
            --numSamples $numSamples
            --seed $seed
            '$input_hal' '$refGenome' > '$out_file'
    ]]></command>
    <inputs>
        <expand macro="input_hal"/>
        <expand macro="params_refGenome"/>
        <expand macro="params_numSamples"/>
        <expand macro="params_seed"/>
    </inputs>
    <outputs>
        <data name="out_file" format="csv" label="${tool.name} on ${on_string}: ${refGenome}"/>
    </outputs>
    <tests>
        <test expect_num_outputs="1">
            <param name="input_hal" value="halTest.hal"/>
            <param name="refGenome" value="Genome_1"/>
            <param name="seed" value="100"/>
            <output name="out_file" ftype="csv">
                <assert_contents>
                    <has_line line="Genome_1, 856475, 856475, 100"/>
                    <has_line line="Genome_2, 374132, 374132, 100"/>
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="1">
            <param name="input_hal" value="halTest.hal"/>
            <param name="refGenome" value="Genome_1"/>
            <param name="numSamples" value="1000"/>
            <param name="seed" value="100"/>
            <output name="out_file" ftype="csv">
                <assert_contents>
                    <has_line line="Genome_1, 839, 839, 100"/>
                    <has_line line="Genome_2, 339, 339, 100"/>
                </assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[
halPctId computes percent identity (% ID) for a reference genome in a HAL alignment by randomly sampling bases.
It takes a HAL file and a reference genome name as input and produces a csv file summarizing the result.
A random seed can be set for reproducibility.
    ]]></help>
    <expand macro="citation"/>
    <expand macro="creator"/>
</tool>