<tool id="hal_halrenamesequences" name="halRenameSequences" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="@PROFILE@">
    <description>renames sequences of a genome in a HAL file</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/> 
    <expand macro="stdio"/>
    <command detect_errors="aggressive"><![CDATA[
        ## Copy input HAL to ensure that it is not modified.
        cp '$input_hal' writable_hal.hal && 
        halRenameSequences
            writable_hal.hal '$refGenome' '$input_mapping'
    ]]></command>
    <inputs>
        <expand macro="input_hal"/>
        <expand macro="params_refGenome"/>
        <expand macro="input_mapping"/>
    </inputs>
    <outputs>
        <data name="out_file" format="hal" label="${tool.name} on ${on_string}" from_work_dir="writable_hal.hal"/>
    </outputs>
    <tests>
        <test expect_num_outputs="1">
            <param name="input_hal" value="halTest.hal"/>
            <param name="refGenome" value="Genome_1"/>
            <param name="input_mapping" value="halRenameSequences_input.txt"/>
            <output name="out_file" ftype="hal">
                <assert_contents>
                    <has_size min="50000"/>
                </assert_contents>
            </output>
            <assert_stdout>
                <has_line line="Renaming Genome_1_seq to Genome_test_1_seq"/>
            </assert_stdout>
        </test>
        <test expect_num_outputs="1">
            <param name="input_hal" value="halTest.hal"/>
            <param name="refGenome" value="Genome_1"/>
            <param name="input_mapping" value="halRenameSequences_input.tsv"/>
            <output name="out_file" ftype="hal">
                <assert_contents>
                    <has_size min="50000"/>
                </assert_contents>
            </output>
            <assert_stdout>
                <has_line line="Renaming Genome_1_seq to Genome_test_1_seq"/>
            </assert_stdout>
        </test>
    </tests>
    <help><![CDATA[
halRenameSequences renames sequence names for a given reference genome from an input HAL file. 
Sequence names are updated according to an input tab-separated mapping file. 
Each row specifies an old sequence name and its corresponding new name.
Only sequences listed in the mapping file are renamed. 
All other sequence names in the given reference genome remain unchanged.

A new HAL file is created as output instead of modifying the input HAL file.
    ]]></help>
    <expand macro="citation"/>
    <expand macro="creator"/>
</tool>