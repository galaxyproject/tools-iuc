<tool id="hal_halrenamegenomes" name="halRenameGenomes" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="@PROFILE@">
    <description>renames genomes in a HAL file</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/> 
    <expand macro="stdio"/>
    <command detect_errors="aggressive"><![CDATA[
        ## Copy input HAL to ensure that it is not modified.
        cp '$input_hal' writable_hal.hal && 
        halRenameGenomes
            writable_hal.hal '$input_mapping'
    ]]></command>
    <inputs>
        <expand macro="input_hal"/>
        <expand macro="input_mapping"/>
    </inputs>
    <outputs>
        <data name="out_file" format="hal" label="${tool.name} on ${on_string}" from_work_dir="writable_hal.hal"/>
    </outputs>
    <tests>
        <test expect_num_outputs="1">
            <param name="input_hal" value="halTest.hal"/>
            <param name="input_mapping" value="halRenameGenomes_input.txt"/>
            <output name="out_file" ftype="hal">
                <assert_contents>
                    <has_size min="50000"/>
                </assert_contents>
            </output>
            <assert_stdout>
                <has_line line="Renaming Genome_0 to Genome_test_0"/>
                <has_line line="Renaming Genome_1 to Genome_test_1"/>
            </assert_stdout>
        </test>
        <test expect_num_outputs="1">
            <param name="input_hal" value="halTest.hal"/>
            <param name="input_mapping" value="halRenameGenomes_input.tsv"/>
            <output name="out_file" ftype="hal">
                <assert_contents>
                    <has_size min="50000"/>
                </assert_contents>
            </output>
            <assert_stdout>
                <has_line line="Renaming Genome_0 to Genome_test_0"/>
                <has_line line="Renaming Genome_1 to Genome_test_1"/>
            </assert_stdout>
        </test>
    </tests>
    <help><![CDATA[
halRenameGenomes renames genomes from an input HAL file. 
Genome names are updated according to an input tab-separated mapping file. 
Each row specifies an old genome name and its corresponding new name.
Only genomes listed in the mapping file are renamed. 
All other genome names in the HAL file remain unchanged. 

A new HAL file is created as output instead of modifying the input HAL file.
    ]]></help>
    <expand macro="citation"/>
    <expand macro="creator"/>
</tool>