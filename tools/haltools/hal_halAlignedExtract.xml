<tool id="hal_halalignedextract" name="halAlignedExtract" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="@PROFILE@">
    <description>extracts aligned regions of a genome with its parent</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/> 
    <expand macro="stdio"/>
    <command detect_errors="aggressive"><![CDATA[
        halAlignedExtract
            $complement
            $viewParentCoords
            '$input_hal' '$genome' > '$out_file'
    ]]></command>
    <inputs>
        <expand macro="input_hal"/>
        <expand macro="params_genomeNoRoot"/>
        <param argument="--viewParentCoords" type="boolean" truevalue="--viewParentCoords" falsevalue="" checked="false" label="View parent coordinates" help="View the corresponding parent coordinates for aligned regions"/>
        <param argument="--complement" type="boolean" truevalue="--complement" falsevalue="" checked="false" label="Complement regions" help="Extract the regions of the genome that are *unaligned* to the parent. i.e. all intervals that are not returned with the default setting"/>
    </inputs>
    <outputs>
        <data name="out_file" format="bed" label="${tool.name} on ${on_string}"/>
    </outputs>
    <tests>
        <test expect_num_outputs="1">
            <param name="input_hal" value="halTest.hal"/>
            <param name="genome" value="Genome_1"/>
            <param name="viewParentCoords" value="true"/>
            <output name="out_file" ftype="bed">
                <assert_contents>
                    <has_line line="Genome_1_seq&#009;0&#009;293&#009;Genome_0_seq&#009;0&#009;293&#009;+"/>   
                    <has_line line="Genome_1_seq&#009;2637&#009;2930&#009;Genome_0_seq&#009;293&#009;586&#009;+"/>    
                    <has_line line="Genome_1_seq&#009;5135&#009;5274&#009;Genome_0_seq&#009;1033&#009;1172&#009;+"/>
                    <has_n_lines n="26"/>
                </assert_contents>
            </output>
        </test>
        <test expect_num_outputs="1">
            <param name="input_hal" value="halTest.hal"/>
            <param name="genome" value="Genome_1"/>
            <param name="complement" value="true"/>
            <output name="out_file" ftype="bed">
                <assert_contents>
                    <has_line line="Genome_1_seq&#009;1465&#009;1758"/>   
                    <has_line line="Genome_1_seq&#009;5274&#009;5472"/>
                    <has_n_lines n="4"/>
                </assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[
halAlignedExtract scans a given genome from an input HAL file and extracts regions that are aligned to its direct parent genome. 
The tool reports all aligned blocks by default. Optionally, it can report the complementary set of regions that are not aligned to the parent.
The output is written as BED intervals.
    ]]></help>
    <expand macro="citation"/>
    <expand macro="creator"/>
</tool>