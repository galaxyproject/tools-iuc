<tool id="detect_circular_sequences" name="Detect circular sequences" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="@PROFILE@">
    <description>(e.g. circular contigs) in a FASTA file</description>
    <macros>
        <token name="@TOOL_VERSION@">1.0</token>
        <token name="@VERSION_SUFFIX@">0</token>
        <token name="@PROFILE@">24.0</token>
    </macros>
    <requirements>
        <requirement type="package" version="3.13">python</requirement>
        <requirement type="package" version="1.86">biopython</requirement>
    </requirements>
    <command><![CDATA[
python '${__tool_directory__}/detect_circular_sequences.py'
    --fasta-in '$fasta_in'
    --subseq-length $subseq_length
    --duplication-length $duplication_length
    --verbose $verbose
    --fasta-out '$fasta_out'
    --id-out '$id_out'
    ]]></command>
    <inputs>
        <param argument="--fasta-in" type="data" format="fasta" label="Input FASTA file"/>
        <param argument="--subseq-length" type="integer" min="0" value="10" label="Length of 3' fragment to check on the 5' end"/>
        <param argument="--duplication-length" type="integer" min="0" value="1000" label="Length of the 3' end fragment to duplicate and add on the 5' end"/>
        <param argument="--verbose" type="select" label="Verbosity level">
            <option value="0">CRITICAL</option>
            <option value="1">ERROR</option>
            <option value="2">WARN</option>
            <option value="3" selected="true">INFO</option>
            <option value="4">DEBUG</option>
        </param>
    </inputs>
    <outputs>
        <data name="fasta_out" format="fasta" label="${tool.name} on ${on_string}: Extended circular sequences"/>
        <data name="id_out" format="txt" label="${tool.name} on ${on_string}: Circular sequence IDs"/>
    </outputs>
    <tests>
        <test expect_num_outputs="2">
            <param name="fasta_in" value="input.fasta"/>
            <param name="subseq_length" value="10"/>
            <param name="duplication_length" value="1000"/>
            <param name="verbose" value="3"/>
            <output name="fasta_out">
                <assert_contents>
                    <has_text text=">SRR17300492_25544"/>
                    <has_text text="GCGATCCAACTGAACCGGATCTAGAGCCGTGGGGTCAACCGC"/>
                </assert_contents>
            </output>
            <output name="id_out">
                <assert_contents>
                    <has_text text="SRR17300492_25544"/>
                    <has_n_lines n="1"/>
                </assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[
This tool detects circular contigs by looking for exact identical subsequences at the two
ends of the sequences provided in a FASTA file and output the circular contigs 
extended on 5' end by duplication of the first nucleotides on 3' end to be able 
to predict genes spanning the origin of circular contigs.

Inspired by Simon Roux work for Metavir2 (2014) and Corentin Hochart work in PlasSuite
    ]]></help>
</tool>