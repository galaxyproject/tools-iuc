<tool id="detect_circular_sequences" name="Detect circular sequences" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="@PROFILE@">
    <description> (e.g. circular contigs) in a FASTA file by k-mer matching</description>
    <macros>
        <token name="@TOOL_VERSION@">0</token>
        <token name="@VERSION_SUFFIX@">0</token>
        <token name="@PROFILE@">24.0</token>
    </macros>
    <requirements>
        <requirement type="package" version="3.13">python</requirement>
    </requirements>
    <command><![CDATA[
python '${__tool_directory__}/detect_circular_sequences.py'
    --fasta-in '$fasta_in'
    --kmer-length $kmer_length
    --cadre-length $cadre_length
    $verbose
    --fasta-out '$fasta_out'
    --id-out '$id_out'
    ]]></command>
    <inputs>
        <param argument="--fasta-in" type="data" format="fasta" label="Input FASTA file"/>
        <param argument="--kmer-length" type="integer" min="0" value="10" label="Length of k-mer"/>
        <param argument="--cadre-length" type="integer" min="0" value="0" label="Inspect fragment length"/>
        <param argument="--verbose" type="boolean" truevalue="--verbose" falsevalue="" default_value="" label="Inspect fragment length"/>
    </inputs>
    <outputs>
        <data name="fasta_out" format="fasta" label="${tool.name} on ${on_string}: Circular sequences"/>
        <data name="id_out" format="txt" label="${tool.name} on ${on_string}: Circular sequence IDs"/>
    </outputs>
    <tests>
        <test expect_num_outputs="2">
            <param name="fasta_in" value="input.fasta"/>
            <param name="kmer_length" value="10"/>
            <param name="cadre_length" value="0"/>
            <param name="verbose" value="false"/>
            <output name="fasta_out">
                <assert_contents>
                    <has_text text=">SRR17300492_25544"/>
                    <has_text text="GCGATCCAACTGAACCGGATCTAGAGCCGTGGGGTCAACCGC"/>
                </assert_contents>
            </output>
            <output name="id_out">
                <assert_contents>
                    <has_text text="SRR17300492_25544"/>
                    <has_n_lines n="1"/>
                </assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[
This script detect circular sequences (e.g. circular contigs) by looking for exact identical k-mer at the two
ends on a cadre sequence of the sequences prodvide in fasta file. In order to be able
to predict genes spanning the orgin of circular sequences, the first 1,000 nucleotides
of each circular sequence are duplicated and added at the sequence's end.

Inspired by Simon Roux work for Metavir2 (2014) and Corentin Hochart work in PlasSuite
    ]]></help>
</tool>