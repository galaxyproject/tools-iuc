<tool id="odgi_pav" name="odgi pav" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="24.1">
    <description>compute presence/absence variant ratios</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <command detect_errors="exit_code"><![CDATA[
odgi pav
--idx '$idx'
--bed-file '$bed_file'
#if str($path_groups)
    --path-groups '$path_groups'
#end if
$group_by_sample
$group_by_haplotype
#if str($binary_values)
    --binary-values $binary_values
#end if
$matrix_output
@THREADS@
> '$output'
    ]]></command>
    <inputs>
        <expand macro="graph_input_param"/>
        <param argument="--bed-file" type="data" format="bed" label="Path ranges (BED)"/>
        <param argument="--path-groups" type="data" format="tabular" optional="true" label="Optional path grouping file" help="Two-column table with path name and group name to aggregate PAV ratios."/>
        <param argument="--group-by-sample" type="boolean" truevalue="--group-by-sample" falsevalue="" checked="false" label="Group paths by sample (PanSN)"/>
        <param argument="--group-by-haplotype" type="boolean" truevalue="--group-by-haplotype" falsevalue="" checked="false" label="Group paths by haplotype (PanSN)"/>
        <param argument="--binary-values" type="float" optional="true" min="0" max="1" label="Binary threshold" help="Emit 1 when the PAV ratio is greater than or equal to this threshold, else 0."/>
        <param argument="--matrix-output" type="boolean" truevalue="--matrix-output" falsevalue="" checked="false" label="Output as matrix (rows = path ranges, columns = paths/groups)"/>
    </inputs>
    <outputs>
        <expand macro="standard_tabular_output"/>
    </outputs>
    <tests/>
    <help format="markdown"><![CDATA[
@HELP_HEADER@

`odgi pav` calculates presence/absence variant (PAV) ratios for each path range in a BED file, optionally grouped by sample, haplotype, or custom path groupings.

### Inputs

- **Input odgi graph**: Variation graph containing the paths of interest.
- **Path ranges (BED)**: Regions to assess for presence/absence across paths.
- **Optional path grouping file**: Map path names to group identifiers (two-column, tab-delimited).
- **Group by sample / haplotype**: Interpret PanSN-style path names and aggregate accordingly.
- **Binary threshold**: Emit 0/1 calls instead of ratios.
- **Output as matrix**: Pivot output so rows are ranges and columns are paths/groups.

### Outputs

- **Tabular**: TSV matrix of PAV ratios (or binary values) suitable for downstream visualization or filtering.
    ]]></help>
    <expand macro="citations"/>
</tool>
