<tool id="odgi_sort" name="odgi sort" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="24.1">
    <description>reorder graph nodes using odgi sort</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <command detect_errors="exit_code"><![CDATA[
odgi sort
--idx '$idx'
--out '$output'
#if str($pipeline)
    --pipeline '$pipeline'
#end if
$breadth_first
#if str($breadth_first_chunk)
    --breadth-first-chunk $breadth_first_chunk
#end if
$depth_first
#if str($depth_first_chunk)
    --depth-first-chunk $depth_first_chunk
#end if
$two_way
$cycle_breaking
$random
$dagify_sort
$path_sgd
#if str($path_sgd_use_paths)
    --path-sgd-use-paths '$path_sgd_use_paths'
#end if
#if str($path_sgd_delta)
    --path-sgd-delta $path_sgd_delta
#end if
#if str($path_sgd_iter_max)
    --path-sgd-iter-max $path_sgd_iter_max
#end if
#if str($path_sgd_seed)
    --path-sgd-seed '$path_sgd_seed'
#end if
@THREADS@
    ]]></command>
    <inputs>
        <expand macro="graph_input_param"/>
        <param argument="--pipeline" type="text" optional="true" label="Sorting pipeline string" help="Concatenate single-letter sorting steps (e.g. bSnSnS) to apply multiple algorithms sequentially."/>
        <param argument="--breadth-first" type="boolean" truevalue="--breadth-first" falsevalue="" checked="false" label="Breadth-first topological sort"/>
        <param argument="--breadth-first-chunk" type="integer" optional="true" min="1" label="Breadth-first chunk size"/>
        <param argument="--depth-first" type="boolean" truevalue="--depth-first" falsevalue="" checked="false" label="Depth-first topological sort"/>
        <param argument="--depth-first-chunk" type="integer" optional="true" min="1" label="Depth-first chunk size"/>
        <param argument="--two-way" type="boolean" truevalue="--two-way" falsevalue="" checked="false" label="Two-way topological sort"/>
        <param argument="--cycle-breaking" type="boolean" truevalue="--cycle-breaking" falsevalue="" checked="false" label="Cycle breaking sort"/>
        <param argument="--random" type="boolean" truevalue="--random" falsevalue="" checked="false" label="Randomize node order"/>
        <param argument="--dagify-sort" type="boolean" truevalue="--dagify-sort" falsevalue="" checked="false" label="Sort via DAGified graph"/>
        <param argument="--path-sgd" type="boolean" truevalue="--path-sgd" falsevalue="" checked="false" label="Apply path-guided 1D SGD"/>
        <param argument="--path-sgd-use-paths" type="data" format="txt" optional="true" label="Paths to sample for path-guided SGD"/>
        <param argument="--path-sgd-delta" type="float" optional="true" min="0" label="Maximum displacement threshold (bp)"/>
        <param argument="--path-sgd-iter-max" type="integer" optional="true" min="1" label="Maximum SGD iterations"/>
        <param argument="--path-sgd-seed" type="text" optional="true" label="Seed for deterministic SGD"/>
    </inputs>
    <outputs>
        <data name="output" format="odgi" label="${tool.name} on ${on_string}"/>
    </outputs>
    <tests/>
    <help format="markdown"><![CDATA[
@HELP_HEADER@

`odgi sort` reorders graph nodes using a mix of topological, random, or path-guided strategies.
Use the pipeline string to chain multiple passes, or enable specific algorithms through dedicated flags.

### Inputs

- **Input odgi graph**: Variation graph to reorder.
- **Sorting pipeline string**: Sequence of single-letter sort codes (e.g. `bSnSnS`).
- **Breadth-first / Depth-first / Two-way / Cycle breaking / Random**: Toggle classic ordering algorithms.
- **Apply path-guided 1D SGD**: Run PG-SGD with optional path list, delta threshold, iteration cap, and deterministic seed.

### Outputs

- **odgi**: The sorted graph written in ODGI format.
    ]]></help>
    <expand macro="citations"/>
</tool>
