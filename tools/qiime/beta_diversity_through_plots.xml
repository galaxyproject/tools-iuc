<?xml version="1.0" ?>
<tool id="1-9_beta_diversity_through_plots" name="beta diversity through plots" version="1.9.0">
	<description>A workflow script for computing beta diversity distance matrices and generating PCoA plots</description>
	<requirements>
		<requirement type="package">qiime</requirement>
	</requirements>
	<command interpreter="python">
beta_diversity_through_plots_wrapper.py --biom $otu_table_fp --mapping $mapping_fp --masterhtml $beta_diversity_through_plots_output --outputfolder $beta_diversity_through_plots_output.files_path --metrics $metrics 
--matrixhtml $beta_diversity_matrix

#if str($tree_fp) != 'None':
 --tree $tree_fp
#end if

#if str($seqs_per_sample) :
	--depth $seqs_per_sample 
#end if
;
</command>
	<inputs>
		<param label="-i/--otu_table_fp: the input biom table [REQUIRED]" name="otu_table_fp" optional="False" type="data"/>
		<param label="-m/--mapping_fp: path to the mapping file [REQUIRED]" name="mapping_fp" optional="False" type="data"/>
		<param label="-t/--tree_fp: path to the tree file [default: None; REQUIRED for phylogenetic measures]" name="tree_fp" optional="True" type="data"/>
                <param label="-m/--metrics: Beta-diversity metric(s) to use. A comma-separated list should be provided when multiple metrics are specified. [default: unweighted_unifrac,weighted_unifrac]" multiple="True" name="metrics" optional="True" type="select">
                        <option selected="True" value="None">Selection is Optional</option>
                        <option value="abund_jaccard">abund_jaccard</option>
                        <option value="binary_chisq">binary_chisq</option>
                        <option value="binary_chord">binary_chord</option>
                        <option value="binary_euclidean">binary_euclidean</option>
                        <option value="binary_hamming">binary_hamming</option>
                        <option value="binary_jaccard">binary_jaccard</option>
                        <option value="binary_lennon">binary_lennon</option>
                        <option value="binary_ochiai">binary_ochiai</option>
                        <option value="binary_otu_gain">binary_otu_gain</option>
                        <option value="binary_pearson">binary_pearson</option>
                        <option value="binary_sorensen_dice">binary_sorensen_dice</option>
                        <option value="bray_curtis">bray_curtis</option>
                        <option value="bray_curtis_faith">bray_curtis_faith</option>
                        <option value="bray_curtis_magurran">bray_curtis_magurran</option>
                        <option value="canberra">canberra</option>
                        <option value="chisq">chisq</option>
                        <option value="chord">chord</option>
                        <option value="euclidean">euclidean</option>
                        <option value="gower">gower</option>
                        <option value="hellinger">hellinger</option>
                        <option value="kulczynski">kulczynski</option>
                        <option value="manhattan">manhattan</option>
                        <option value="morisita_horn">morisita_horn</option>
                        <option value="pearson">pearson</option>
                        <option value="soergel">soergel</option>
                        <option value="spearman_approx">spearman_approx</option>
                        <option value="specprof">specprof</option>
                        <option value="unifrac">unifrac</option>
                        <option value="unifrac_g">unifrac_g</option>
                        <option value="unifrac_g_full_tree">unifrac_g_full_tree</option>
                        <option value="unweighted_unifrac">unweighted_unifrac</option>
                        <option value="unweighted_unifrac_full_tree">unweighted_unifrac_full_tree</option>
                        <option value="weighted_normalized_unifrac">weighted_normalized_unifrac</option>
                        <option value="weighted_unifrac">weighted_unifrac</option>
                </param>
		<param label="-e/--seqs_per_sample: depth of coverage for even sampling [default: None]" name="seqs_per_sample" optional="True" type="integer" default=""/>
	</inputs>
	<outputs>
		
		<data format="html" name="beta_diversity_through_plots_output" label="beta_diversity_through_plots.html"/>
		<data format="tgz" name="beta_diversity_matrix" label="beta_diversity_matrix.tgz"/>
		<data format="txt" from_work_dir="*_log.txt" name="output_dir_log"  label="file_log.txt"/>
	</outputs>
	<help>This script will perform beta diversity, principal coordinate analysis, and generate a preferences file along with 3D PCoA Plots.

This script results in a distance matrix (from beta_diversity.py), a principal coordinates file (from principal_coordinates.py), and folders containing the resulting PCoA plots (accessible through html files).</help>
</tool>
