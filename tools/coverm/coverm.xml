<tool id="coverm" name="CoverM" version="@TOOL_VERSION@" python_template_version="3.5">
    <macros>
        <token name="@INPUT_FORMATS@">fa,fna,fasta,fastq,fastq.gz,fasta.gz,fna.gz,fa.gz</token>
        <token name="@TOOL_VERSION@">0.2.1</token>
    </macros>
    <requirements>
        <requirement type="package">coverm</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[

        coverm genome
            -f ${" ".join(map(str, $inputs))}
    ]]></command>
    <inputs>
        <conditional name="reads">
            <param type="select" label="Read type" name="read_type">
                <option value="paired" selected="true">Paired end</option>
                <option value="paired_collection">Paired collection</option>
                <option value="single">Single ended</option>
                <option value="interleaved">Interleaved</option>
                <option value="bam">BAM file(s)</option>
            </param>
            <when value="paired">
                <param type="data" format="@INPUT_FORMATS@" name="read1" label="Read1" />
                <param type="data" format="@INPUT_FORMATS@" name="read2" label="Read2" />
            </when>
            <when value="paired_collection">
                <param type="data_collection" collection_type="paired" format="@INPUT_FORMATS@" name="paired_reads" label="Reads" />
            </when>
            <when value="single">
                <param type="data" format="@INPUT_FORMATS@" name="read1" label="Read1" />
            </when>
            <when value="interleaved">
                <param type="data" format="@INPUT_FORMAT" name="interleaved" label="Interleaved" />
            </when>
            <when value="bam">
                <param type="data" format="bam" name="bam" label="BAM file(s)" />
            </when>
        </conditional>
        <conditional name="genome" >
            <param type="select" label="Choose whether you want to provide a single FASTA file of contigs as genome reference or multiple FASTA files." name="select_genome" >
                <option value="single-ref">Single reference</option>
                <option value="multiple-genomes">Multiple genomes</option>
            </param>
            <when value="multiple-genomes">
                <param type="data" name="genome" format="fasta,fa,fna" label="FASTA files of each genome" />
            </when>
            <when value="single-ref" >
                        <conditional name="ref_source">
                            <param type="select" label="Reference genome source" name="source">
                                <option value="history" selected="true">History</option>
                                <option value="builtin">Built-in</option>
                            </param>
                            <when value="history">
                                <param type="data" name="single-ref" label="Single FASTA file of contigs" format="fasta,fa,fna" />
                            </when>
                            <when value="builtin">
                                <param type="select" name="ref_fasta_builtin" label="Reference genome">
                                    <options from_data_table="all_fasta" />
                                </param>
                            </when>
                        </conditional>
                <param type="boolean" name="ref-as-index" truevalue="--minimap2-reference-is-index" falsevalue="" optional="true" label="Treat reference as a minimap2 database, not as a FASTA file." />
                <param type="text" optional="true" label="Character, that separates genome names from contig names in the reference file." >
                    <option value=" ">Space</option>
                    <option value=",">Comma</option>
                    <option value=";">Semicolon</option>
                    <option value="-">Hyphen</option>
                </param>
                <param type="boolean" name="single-genome" truevalue="--single-genome" falsevalue="" optional="true" label="Treat the reference file as single genome" />
                <param type="data" name="genome-definition" format="tsv" label="File containing newline-separated list of genome_name and contig, separated by tab, to define the genome of each contig." />
            </when>
        </conditional> 
    </inputs>
    <outputs>
        <data name="output1" format="tsv" />
    </outputs>
    <help><![CDATA[
        TODO: Fill in help.
    ]]></help>
</tool>