<tool id="pstools" name="Calculate qv score for prediction (pstools)" version="0.2a3" profile="20.05">
    <requirements>
        <requirement type="package" version="0.2a3">pstools</requirement>
    </requirements>
    <stdio>
      <!--
        Try to match possible strings recognized as error to avoid the check
        by the exit status. This is a temporary workaround to avoid the failure
        by the exit status non zero.
      -->
      <regex match="Error"/>
      <regex match="Exception"/>
      <regex match="Segfault"/>
    </stdio>
    <command><![CDATA[
        pstools qv '$fasta_input1' '$fastq_input1' '$fastq_input2' > '$output1' || :
    ]]></command>

    <inputs>
        <param type="data" name="fasta_input1" label="Reference fasta file" format="fasta" />
        <param type="data" name="fastq_input1" label="Read 1 fastq file" format="fastq" />
        <param type="data" name="fastq_input2" label="Read 2 fastq file" format="fastq" />
    </inputs>
    <outputs>
        <data name="output1" format="txt" />
    </outputs>
    <tests>
        <test>
            <param name="fasta_input1" value="true_hap2.fasta"/>
            <param name="fastq_input1" value="hap2.1.fastq"/>
            <param name="fastq_input2" value="hap2.2.fastq"/>
            <output name="output1" file="qv_score.txt"/>
        </test>
    </tests>
    <help><![CDATA[
**pstools: Toolkit for fully phased sequences**

Routine production of phased sequences (haplotypes) of genomes are important to study variation occurring in complex cancer and healthy samples. We developed a novel graph-based algorithm to integrate HiFi and Hi-C data types to produce haplotypes at the base-level resolution for routine clinical research. When benchmarking our method on healthy human genomes, we produced significantly high-quality genomes with a sequence continuity NG50 >130 Mb, switch/hamming error rates <1.5% and a completeness of >6.0 Gb, and an order of magnitude faster process (only <12 hours). This simple approach will facilitate improvement in understanding of the mechanisms of clinical diseases.

In this tool, the `pstols gv` command is avalable.

Usage: pstools <command> <arguments> <inputs>
Commands:
* clean_graph           cleaning the given graph

* intersect             extract corresponding paf records for sub graph
* resolve_haplotypes    use hic data to resolve haplotypes
* haplotype_scaffold    scaffolding the predicted haplotypes
* hic_mapping_unitig    map hic data to sequences in the graph
* hic_mapping_haplo     map hic data to predicted haplotypes for scaffolding
* qv                    calculate qv score for prediction
* completeness          calculate completeness for prediction
* phasing_error         calculate switch error
* version               print version number

Usage: pstools qv [options] <seq.fa> <hic.R1.fastq.gz> <hic.R2.fastq.gz>
Options:
* -k INT     k-mer size [31]
* -t INT     number of worker threads [4]
* -K INT     chunk size [100m]
    ]]></help>
    <citations>
        <citation type="bibtex">
@misc{githubpstools,
  author = {Shilpa, Garg},
  year = {2021},
  title = {pstools: Toolkit for fully phased sequences},
  url = https://github.com/shilpagarg/pstools,
}</citation>
    </citations>
</tool>
