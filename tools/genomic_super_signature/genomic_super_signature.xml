<tool id="genomic_super_signature" name="GenomicSuperSignature" version="0.1.0" profile="20.01">
    <requirements>
        <requirement type="package" version="1.0.1">bioconductor-genomicsupersignature</requirement>
        <requirement type="package" version="1.10">bioconductor-tximeta</requirement>
        <requirement type="package" version="2021d">tzdata</requirement>
        <requirement type="package" version="1.1">openssl</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
    cat gss.R &&
        TMPDIR="\$PWD" Rscript gss.R
    ]]></command>
    <configfiles>
        <configfile name="gss_downloader" filename="gss.R"><![CDATA[
library(GenomicSuperSignature)
library(dplyr)
library(ggplot2)
library(tximeta)
RAVmodel <- readRDS("$model", refhook = NULL)

## files <- c(#echo ",".join(f'"{m}"' for m in $matrices)#)
## names <- c(#echo ",".join(f'"{m.element_identifier}"' for m in $matrices)#)
files = file.path("$matrices")
coldata <- data.frame(files, names="Name", condition="label", stringsAsFactors=FALSE)
coldata
se <- tximeta(coldata)
se
        ]]></configfile>
    </configfiles>
    <inputs>
        <param name="model" type="data" format="rdata" label="Select a RAV model" help="You can download a model using the GenomicSuperSingature Downloader tool"/>
        <param type="select" name="matrix_source" label="Select the program that produced the quantification matrix">
            <option value="salmon">Salmon</option>
            <option value="alevin">Alevin</option>
            <option value="tabular">Tabular</option>
        </param>
        <param type="data" name="matrices" format="tabular" label="RNAseq quantification matrices"/>
        <!-- TODO: add fasta, gtf input ?-->
    </inputs>
    <outputs>
        <data name="plots" format="pdf" label="GenomicSuperSignature plots"/>
    </outputs>
    <help><![CDATA[
        TODO: Fill in help.
    ]]></help>
</tool>