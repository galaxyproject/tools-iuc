<?xml version="1.0" encoding="UTF-8"?>
<macros>
    <xml name="tests">
        <tests>
            <test expect_num_outputs="2">
                <param name="input_files" value="inputs/concat_1.fasta,inputs/concat_2.fasta" />
                <conditional name="action">
                    <param name="action_selector" value="concat" />
                    <param name="concat_out_format" value="phylip" />
                    <param name="part_format" value="nexus" />
                </conditional>
                <param name="in_format" value="fasta" />
                <param name="data_type" value="dna" />
                <param name="check_align" value="false" />
                <output name="concat_output" file="outputs/expected_concat.phylip" compare="sim_size" />
                <output name="partitions_out" file="outputs/expected_partitions.txt" />
            </test>
            <test expect_num_outputs="2">
                <param name="input_files" value="inputs/fasta1.fas" />
                <conditional name="action">
                    <param name="action_selector" value="summary" />
                    <param name="by_taxon" value="true" />
                </conditional>
                <param name="in_format" value="fasta" />
                <param name="data_type" value="dna" />
                <param name="check_align" value="false" />
                <param name="cores" value="1" />
                <output name="summary_out" file="outputs/expected_summary.txt" />
                <output_collection name="taxon_summaries" type="list">
                    <element name="fasta1.fas-seq-summary" file="outputs/expected_taxa_summary.txt" />
                </output_collection>
            </test>
            <test expect_num_outputs="2">
                <param name="input_files" value="inputs/concat_1.fasta,inputs/concat_2.fasta" />
                <conditional name="action">
                    <param name="action_selector" value="concat" />
                    <param name="concat_out_format" value="fasta" />
                    <param name="part_format" value="raxml" />
                </conditional>
                <param name="in_format" value="fasta" />
                <param name="data_type" value="dna" />
                <param name="check_align" value="false" />
                <output name="concat_output" file="outputs/expected_concat_fasta.fas" compare="sim_size" />
                <output name="partitions_out" file="outputs/expected_partitions_raxml.txt" />
            </test>
            <test expect_num_outputs="1">
                <param name="input_files" value="inputs/aa_alignment1.int-phy,inputs/aa_alignment2.int-phy" />
                <conditional name="action">
                    <param name="action_selector" value="convert" />
                    <param name="convert_out_format" value="nexus-int" />
                </conditional>
                <param name="in_format" value="phylip-int" />
                <param name="data_type" value="aa" />
                <param name="check_align" value="true" />
                <param name="cores" value="2" />
                <output_collection name="converted_alignments" type="list">
                    <element name="aa_alignment1.int-phy" file="outputs/expected_convert_aa_alignment1.int-nex" />
                    <element name="aa_alignment2.int-phy" file="outputs/expected_convert_aa_alignment2.int-nex" />
                </output_collection>
            </test>
            <test expect_num_outputs="1">
                <param name="input_files" value="inputs/fasta1.fas" />
                <conditional name="action">
                    <param name="action_selector" value="replicate" />
                    <param name="replicate_replicates" value="2" />
                    <param name="replicate_loci" value="1" />
                    <param name="replicate_out_format" value="nexus" />
                </conditional>
                <param name="in_format" value="fasta" />
                <param name="data_type" value="dna" />
                <param name="check_align" value="false" />
                <param name="cores" value="1" />
                <output_collection name="replicate_alignments" type="list">
                    <element name="replicate1_1-loci-out.nex" file="outputs/expected_replicate1.nex" />
                    <element name="replicate2_1-loci-out.nex" file="outputs/expected_replicate2.nex" />
                </output_collection>
            </test>
            <test expect_num_outputs="1">
                <param name="input_files" value="inputs/concat_result.phylip" />
                <conditional name="action">
                    <param name="action_selector" value="split" />
                    <param name="split_by" value="inputs/partitions_concat_unspecified.txt" />
                    <param name="remove_empty" value="true" />
                    <param name="split_out_format" value="fasta" />
                </conditional>
                <param name="in_format" value="phylip" />
                <param name="data_type" value="dna" />
                <param name="check_align" value="false" />
                <param name="cores" value="1" />
                <output_collection name="split_alignments" type="list">
                    <element name="concat_result_p1_concat_1" file="outputs/expected_split_partition1.fas" />
                    <element name="concat_result_p2_concat_2" file="outputs/expected_split_partition2.fas" />
                </output_collection>
            </test>
            <test expect_num_outputs="1">
                <param name="input_files" value="inputs/remove_input.nex" />
                <conditional name="action">
                    <param name="action_selector" value="remove" />
                    <repeat name="taxa_to_remove">
                        <param name="taxon" value="OTU9" />
                    </repeat>
                    <repeat name="taxa_to_remove">
                        <param name="taxon" value="OTU10" />
                    </repeat>
                    <param name="out_prefix" value="filtered_" />
                    <param name="remove_out_format" value="nexus-int" />
                </conditional>
                <param name="in_format" value="nexus" />
                <param name="data_type" value="dna" />
                <param name="check_align" value="false" />
                <param name="cores" value="1" />
                <output_collection name="reduced_alignments" type="list">
                    <element name="filtered_remove_input.nex" file="outputs/expected_remove_filtered.int-nex" />
                </output_collection>
            </test>
            <test expect_num_outputs="1">
                <param name="input_files" value="inputs/translate_input.fas" />
                <conditional name="action">
                    <param name="action_selector" value="translate" />
                    <param name="genetic_code" value="11" />
                    <param name="reading_frame" value="2" />
                    <param name="translate_out_format" value="phylip" />
                </conditional>
                <param name="in_format" value="fasta" />
                <param name="data_type" value="dna" />
                <param name="check_align" value="false" />
                <param name="cores" value="1" />
                <output_collection name="translated_alignments" type="list">
                    <element name="translated_translate_input.fas-out.phy-out.phy" file="outputs/expected_translate_phylip.phy" />
                </output_collection>
            </test>
            <test expect_num_outputs="1">
                <param name="input_files" value="inputs/trim_input.fas" />
                <conditional name="action">
                    <param name="action_selector" value="trim" />
                    <param name="trim_fraction" value="0.75" />
                    <param name="retain_parsimony" value="true" />
                    <param name="trim_out_format" value="phylip-int" />
                </conditional>
                <param name="in_format" value="fasta" />
                <param name="data_type" value="dna" />
                <param name="check_align" value="false" />
                <param name="cores" value="1" />
                <output_collection name="trimmed_alignments" type="list">
                    <element name="trimmed_trim_input.fas-out.int-phy" file="outputs/expected_trimmed_phylip_int.int-phy" />
                </output_collection>
            </test>
        </tests>
    </xml>
</macros>