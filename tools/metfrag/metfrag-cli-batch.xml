<?xml version='1.0' encoding='UTF-8'?>
<!--This is a configuration file for the integration of a tools into Galaxy (https://galaxyproject.org/).-->
<!--Proposed Tool Section: [PhenoMeNal]-->
<tool id="metfrag-cli-batch" name="metfrag-cli-batch" version="0.4">
    <description>Run MetFrag with a given parameter set.</description>
    <requirements>
	<requirement type="package" version="2.4.5">metfrag</requirement>
    </requirements> 
    <!--
	#if $additionalparameters != "None"
        -a "$additionalparameters"
	#end if
	#if $additional_metfrag_scores != "None"
        -s "$additional_metfrag_scores"
	#end if
    -->
    <command detect_errors="aggressive"><![CDATA[
    metfrag ParameterFile='$metfrag_cli_batch_input_1' ResultsFile='$metfrag_cli_batch_output_1'     
    #if $metfrag_cli_batch_database_file != "None"
    LocalDatabasePath="$metfrag_cli_batch_database_file"
    #end if
    ]]>
    </command>
    <inputs>
	<param name="metfrag_cli_batch_input_1" type="data" format="txt" optional="False" label="File with MetFrag parameters" help="File containing MetFrag parameters which is generated by msms2metfrag" />
	<param name="additionalparameters" type="text" value="" optional="True" label="Additional Parameters" help="Additional parameters that can be passed to MetFrag. This can include e.g. access information for a local MetChem database instance" />
	<param name="metfrag_cli_batch_database_file" type="data" format="csv" optional="True" label="Database File" help="File containing candidates used as database" />
	<param name="additional_metfrag_scores" type="select" display="checkboxes" multiple="true" label="Additional MetFrag scores" help="Add additional MetFrag scores used to score candidates">
	    <option value="OfflineMetFusionScore">Spectral Similarity (MoNA)</option>
	</param>
    </inputs>
    <outputs>
	<data name="metfrag_cli_batch_output_1" format="csv" label="MetFrag result file" />
    </outputs>
    <tests>
	<test>
	    <param name="metfrag_cli_batch_input_1" value="1_746.022_716.5434_1569591.66000003_PE_PG_AutoMS_2-B_3_03_18583.mzML.txt" />
	    <param name="metfrag_cli_batch_database_file" value="candidates.csv" />
	    <output name="metfrag_cli_batch_output_1" file="1_746.022_716.5434_1569591.66000003_PE_PG_AutoMS_2-B_3_03_18583.mzML.csv" ftype="csv"/>
	</test>
    </tests>
    <help>

	.. class:: infomark

	| **Tool update: See the 'NEWS' section at the bottom of the page**

	---------------------------------------------------

	.. class:: infomark

	**Authors**

	| **Payam Emami (payam.emami@medsci.uu.se)** and **Christoph Ruttkies (christoph.ruttkies@ipb-halle.de)** wrote and maintain this wrapper for MetFrag batch mode processing.

	---------------------------------------------------

	.. class:: infomark

	**Please cite**

	Ruttkies, C., Schymanski, E. L., Wolf, S., Hollender, J. and Neumann, S. MetFrag relaunched: incorporating strategies beyond in silico fragmentation. J Cheminform 8:3, (2016) DOI: 10.1186/s13321-016-0115-9

	---------------------------------------------------

	=====================
	MetFrag CLI Batch
	=====================

	-----------
	Description
	-----------

	| This module is used to run MetFrag on annotated MS/MS spectra for compound annotation. The parameters are set by **msms2metfrag**.


	-----------
	Input files
	-----------

	+------------------------------+------------+
	| File                         |   Format   |
	+==============================+============+
	| 1)  File with MetFrag        |    txt     |
	|     parameters               |            |
	+------------------------------+------------+
	| 2)  Database File (optional) |    csv     |
	+------------------------------+------------+

	----------
	Parameters
	----------

	File with MetFrag parameters
        | File containing MetFrag parameters which is generated by **msms2metfrag**
        |

	Additional Parameters
        | Additional parameters that can be passed to MetFrag. This can include e.g. access information for a local MetChem database instance
        |

	Database File
	| File containing candidates used as database
	| 

	Additional MetFrag scores
	| Add additional MetFrag scores used to score candidates
	|

	------------
	Output files
	------------

	metfrag_cli_batch_output_1.csv
        | A csv output file with scored candidates and properties
        |

	---------------------------------------------------

	----
	NEWS
	----

	CHANGES IN VERSION 0.3
	========================

	- added support for additional MetFrag scores

	CHANGES IN VERSION 0.2
	========================

	- added support for a local file database


	CHANGES IN VERSION 0.1
	========================

	First version

    </help>
    <citations>
	<citation type="doi">10.1186/s13321-016-0115-9</citation>
    </citations>    
</tool>

<!-- Local Variables: -->
<!-- nxml-child-indent: 4 -->
<!-- nxml-attribute-indent: 4 -->
<!-- End: -->
