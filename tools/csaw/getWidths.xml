<tool id="csaw_getWidths" name="getWidths" version="@VERSION@.0">
  <description>gets region widths</description>
  <macros>
    <import>csaw_macros.xml</import>
  </macros>
  <expand macro="requirements" />
  <command detect_errors="exit_code"><![CDATA[
    Rscript '$script']]>
  </command>
  <configfiles>
    <configfile name="script"><![CDATA[
## Setup R error handling to go to stderr
options(show.error.messages=F, error=function(){cat(geterrmessage(),file=stderr());q("no",1,F)})
loc <- Sys.setlocale("LC_MESSAGES", "en_US.UTF-8")

## Import library
library(csaw)
library(Rsamtools)

@WINDOWCOUNTS@
@REGIONCOUNTS@

#if str($data_object_select.data_object_selector) == "windowCounts"
  data <- window_counts
#else
  data <- region_counts
#end if
    
get_widths <- getWidths(data)

write.table(get_widths, "$output", quote = FALSE, col.names = FALSE, row.names = FALSE)

]]>
    </configfile>
  </configfiles>
  <inputs>
    <conditional name="data_object_select">
      <param name="data_object_selector" type="select" label="Create a RangedSummarizedExperiment object by windowCounts or regionCounts?" />
        <option value="windowCounts">windowCounts</option>
        <option value="regionCounts">regionCounts</option>
      </conditional>
      <when value="windowCounts">
        <expand macro="windowCounts" />
      </when>
      <when value="regionCounts">
        <expand macro="regionCounts" />
      </when>
  </inputs>
  <outputs>
    <data name="output" format="txt" label="${tool.name} on ${on_string}: getWidths output" />
  </outputs>

  <tests>
    <test>     
    
    </test>
  </tests>

  <help><![CDATA[
       Get the widths of the read counting interval for each region.
    ]]></help>
  <expand macro="citations" />
</tool>