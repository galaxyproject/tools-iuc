library(csaw)
incoming <- GRanges(c('chrA', 'chrA', 'chrB', 'chrC'),
IRanges(c(1, 500, 100, 1000), c(200, 1000, 700, 1500)))
strandedCounts(bamFiles, regions=incoming, param=xparam)
bamFiles <- system.file("exdata", c("rep1.bam", "rep2.bam"), package="csaw")
incoming <- GRanges(c('chrA', 'chrA', 'chrB', 'chrC'),
IRanges(c(1, 500, 100, 1000), c(200, 1000, 700, 1500)))
strandedCounts(bamFiles, regions=incoming, param=xparam)
strandedCounts(bamFiles, regions=incoming, param=reform(xparam, dedup=TRUE))
bamFiles <- system.file("exdata", c("rep1.bam", "rep2.bam"), package="csaw")
xparam <- readParam(forward=NULL)
out <- strandedCounts(bamFiles, filter=1, param=xparam)
out
strandedCounts(bamFiles, filter=1, width=100, param=xparam)
strandedCounts(bamFiles, filter=1, param=reform(xparam, minq=20))
incoming <- GRanges(c('chrA', 'chrA', 'chrB', 'chrC'),
IRanges(c(1, 500, 100, 1000), c(200, 1000, 700, 1500)))
strandedCounts(bamFiles, regions=incoming, param=xparam)
strandedCounts(bamFiles, regions=incoming, param=reform(xparam, dedup=TRUE))
strand(rowRanges(strandedCounts(bamFiles, regions=incoming, param=reform(xparam, dedup=TRUE)))
)
strand(rowRanges(strandedCounts(bamFiles, regions=incoming, param=xparam))
)
strand(strandedCounts(bamFiles, regions=incoming, param=xparam))
nwin <- 20
set.seed(20)
ids <- sample(5, nwin, replace=TRUE)
ids
write.table(ids, "upweightSummit_ids.tabular", quote=FALSE, row.names=FALSE, col.names=FALSE)
summits <- sample(5, nwin, replace=TRUE)==1L
summits
write.table(summits, "upweightSummit_summits.tabular", quote=FALSE, row.names=FALSE, col.names=FALSE)
upweightSummit(ids, summits)
x <- dnorm(-200:200/100) # Mocking up a profile.
windows <- GRanges("chrA", IRanges(1, 50)) # Making up some windows.
wwhm(x, windows)
wwhm(x, windows, ext=50)
wwhm(x, windows, proportion=0.2)
csaw
q()
