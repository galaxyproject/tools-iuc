<tool id="kleboratetool" name="Kleborate" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@">
    <description> a tool to screen genome assemblies of Klebsiella pneumoniae</description>
    <macros>
        <token name="@TOOL_VERSION@">0.1.0</token>
        <token name="@VERSION_SUFFIX@">1</token>
    </macros>
    <requirements>
        <requirement type="package" version="2.1.0">kleborate</requirement>
        <requirement type="package" version="2.0.0">kaptive</requirement>
    </requirements>

<!--   <command detect_errors="aggressive"><![CDATA[
## Creates symlinks for each input file based on the Galaxy 'element_identifier'
## Used so that a human-readable name appears in the output table (instead of 'dataset_xyz.dat')
#set $named_input_files = ''
#for $input_file in $input_files
    ## Add single quotes around each input file identifier
    #set $_input_file = "'{}'".format($input_file.element_identifier)
    ln -s '${input_file}' ${_input_file} &&
    #set $named_input_files = $named_input_files + ' ' + $_input_file
#end for

kleborate $r $kaptive_k $kaptive_o -o $output --min_identity $ident --min_coverage $cov -a $named_input_files
]]></command> -->

    <inputs>
        <param format="fasta" name="input_files" type="data" label="Genome fasta file : " multiple="true" display="checkboxes"/>

        <param name="r" type="select" label="Turn on resistance genes screening (default: no resistance gene screening):">
            <option value="">no</option>
            <option value="-r">yes</option>
        </param>

        <param name="kaptive_k" type="select" label="Turn on Kaptive screening of K loci (default: do not run Kaptive for K loci):">
            <option value="">no</option>
            <option value="--kaptive_k">yes</option>
        </param>

        <param name="kaptive_o" type="select" label="Turn on Kaptive screening of O loci (default: do not run Kaptive for O loci):">
            <option value="">no</option>
            <option value="--kaptive_o">yes</option>
        </param>

        <param name="ident" type="text" area="false" value="90.0" label="Minimum alignment percent identity for main results:"/>
        <param name="cov" type="text" area="false" value="80.0" label="Minimum alignment percent coverage for main results:"/>

    </inputs>

    <outputs>
        <data format="tabular" name="output" />
    </outputs>

    <tests>
        <test>
            <param name="input" value="KP011_S63.scfd.fasta " />
            <param name="input" value="KP012_S64.scfd.fasta " />
            <param name="r" value="-r"/>
            <param name="kaptive_k" value="--kaptive_k"/>
            <param name="kaptive_o" value=""/>
            <output name="output" file="Kleborate_results.txt" />
        </test>
    </tests>

    <help>
For full documentation, please go to the Kleborate wiki (https://github.com/katholt/Kleborate/wiki)
    </help>

    <citations>
        <citation type="doi">10.1101/2020.12.14.422303</citation>
        <citation type="doi">10.1038/s41467-021-24448-3</citation>
        <citation type="doi">10.1099/mgen.0.000102</citation>
    </citations>
</tool>
