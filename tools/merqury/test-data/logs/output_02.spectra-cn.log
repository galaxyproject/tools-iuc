Usage: spectra-cn.sh <read.meryl> <asm1.fasta> [asm2.fasta] out-prefix
	<read.meryl>	: Generated with meryl count from i.e. illumina wgs reads
	<asm1.fasta>	: haplotype 1 assembly. gzipped or not
	[asm2.fasta]	: haplotype 2 assembly. gzipped or not
	<out-prefix>: output prefix. Required.
		When only <asm1.fasta> is given, results will be generated in haploid mode.
		When <asm2.fasta> is given, results will be generated for each asm1 asm2 haploid assembly and asm1+asm2 diploid assembly.

Detected k-mer size 15

No modules available..
# Get solid k-mers
Generate child.hist

java -jar -Xmx1g /home/laptop/miniconda3/envs/merqury/share/merqury/eval/kmerHistToPloidyDepth.jar child.hist

ploidy	depth	boundary
0	0	10

Filter out kmers <= 10

meryl greater-than 10 output child.gt10.meryl child.meryl

=== Generate spectra-cn plots per assemblies and get QV, k-mer completeness ===

# Generate meryl db for assembly

# Collect read counts per asm copies
# Read only
# Copy 1 ~ 4
Copy = 1 ..

Copy = 2 ..

Copy = 3 ..

Copy = 4 ..

Copy >4 ..

# Copy numbers in k-mers found only in asm

# Plot output_02.assembly.spectra-cn.hist
	Rscript /home/laptop/miniconda3/envs/merqury/share/merqury/plot/plot_spectra_cn.R -f output_02.assembly.spectra-cn.hist -o output_02.assembly.spectra-cn -z output_02.assembly.only.hist
[1] "x_max: 10"
[1] "y_max: 4835036.8"
[1] "## Line graph"
[1] "## Area under the curve filled"
[1] "## Stacked"

# QV statistics

# Per seq QV statistics

# k-mer completeness (recoveray rate) with solid k-mers for assembly with > 10 counts

# Generate assembly_only.tdf
# Index assembly.fasta

Using system JDK.
WARN [2021-02-14T22:06:35,815]  [Globals.java:138] [main]  Development mode is enabled
INFO [2021-02-14T22:06:35,822]  [IgvTools.java:838] [main]  Computing coverage.  File = assembly_only.bed
Computing coverage.  File = assembly_only.bed
INFO [2021-02-14T22:06:35,823]  [IgvTools.java:839] [main]  Max zoom = 7
Max zoom = 7
INFO [2021-02-14T22:06:35,823]  [IgvTools.java:840] [main]  Window size = 25
Window size = 25
INFO [2021-02-14T22:06:35,826]  [IgvTools.java:845] [main]  Window functions: mean 
Window functions: mean 
INFO [2021-02-14T22:06:35,826]  [IgvTools.java:846] [main]  Ext factor = 0
Ext factor = 0
INFO [2021-02-14T22:06:35,848]  [DirectoryManager.java:179] [main]  IGV Directory: /home/laptop/igv
IGV Directory: /home/laptop/igv
INFO [2021-02-14T22:06:35,848]  [GenomeManager.java:195] [main]  Loading genome: /home/laptop/Galaxy/repositories/lab-notebook/tools-galaxy/merqury/galaxy_tool/test-data/assembly.fasta.fai
Loading genome: /home/laptop/Galaxy/repositories/lab-notebook/tools-galaxy/merqury/galaxy_tool/test-data/assembly.fasta.fai
INFO [2021-02-14T22:06:35,871]  [IGVEventBus.java:80] [main]  No observers for event type: class org.broad.igv.event.GenomeChangeEvent
No observers for event type: class org.broad.igv.event.GenomeChangeEvent
INFO [2021-02-14T22:06:37,631]  [IGVEventBus.java:80] [main]  No observers for event type: class org.broad.igv.event.GenomeChangeEvent
No observers for event type: class org.broad.igv.event.GenomeChangeEvent
INFO [2021-02-14T22:06:37,631]  [GenomeManager.java:287] [main]  Genome loaded.  id= /home/laptop/Galaxy/repositories/lab-notebook/tools-galaxy/merqury/galaxy_tool/test-data/assembly.fasta
Genome loaded.  id= /home/laptop/Galaxy/repositories/lab-notebook/tools-galaxy/merqury/galaxy_tool/test-data/assembly.fasta
INFO [2021-02-14T22:06:37,670]  [Preprocessor.java:255] [main]  Processing chromosome tig00000001
Processing chromosome tig00000001
.........10.0% 
INFO [2021-02-14T22:06:38,709]  [Preprocessor.java:255] [main]  Processing chromosome tig00000002
Processing chromosome tig00000002
.........20.0% 
INFO [2021-02-14T22:06:39,495]  [Preprocessor.java:255] [main]  Processing chromosome tig00000004
Processing chromosome tig00000004
.......INFO [2021-02-14T22:06:40,030]  [Preprocessor.java:255] [main]  Processing chromosome tig00000005
Processing chromosome tig00000005
..30.0% 
...INFO [2021-02-14T22:06:40,500]  [Preprocessor.java:255] [main]  Processing chromosome tig00000006
Processing chromosome tig00000006
......INFO [2021-02-14T22:06:42,293]  [Preprocessor.java:255] [main]  Processing chromosome tig00000007
Processing chromosome tig00000007
40.0% 
INFO [2021-02-14T22:06:42,373]  [Preprocessor.java:255] [main]  Processing chromosome tig00000008
Processing chromosome tig00000008
....INFO [2021-02-14T22:06:42,672]  [Preprocessor.java:255] [main]  Processing chromosome tig00000009
Processing chromosome tig00000009
..INFO [2021-02-14T22:06:42,874]  [Preprocessor.java:255] [main]  Processing chromosome tig00000010
Processing chromosome tig00000010
..INFO [2021-02-14T22:06:43,039]  [Preprocessor.java:255] [main]  Processing chromosome tig00000011
Processing chromosome tig00000011
.50.0% 
WARN [2021-02-14T22:06:43,174]  [Preprocessor.java:199] [main]  Ignoring data from non-existent locus.  Probe = null  Locus = tig00000011:105175-105171. tig00000011 length = 105171
Ignoring data from non-existent locus.  Probe = null  Locus = tig00000011:105175-105171. tig00000011 length = 105171
INFO [2021-02-14T22:06:43,174]  [Preprocessor.java:255] [main]  Processing chromosome tig00000012
Processing chromosome tig00000012
.INFO [2021-02-14T22:06:43,311]  [Preprocessor.java:255] [main]  Processing chromosome tig00000013
Processing chromosome tig00000013
..INFO [2021-02-14T22:06:43,435]  [Preprocessor.java:255] [main]  Processing chromosome tig00000014
Processing chromosome tig00000014
.INFO [2021-02-14T22:06:43,567]  [Preprocessor.java:255] [main]  Processing chromosome tig00000015
Processing chromosome tig00000015
..INFO [2021-02-14T22:06:43,693]  [Preprocessor.java:255] [main]  Processing chromosome tig00000017
Processing chromosome tig00000017
INFO [2021-02-14T22:06:43,785]  [Preprocessor.java:255] [main]  Processing chromosome tig00000018
Processing chromosome tig00000018
.WARN [2021-02-14T22:06:43,855]  [Preprocessor.java:199] [main]  Ignoring data from non-existent locus.  Probe = null  Locus = tig00000018:44175-44174. tig00000018 length = 44174
Ignoring data from non-existent locus.  Probe = null  Locus = tig00000018:44175-44174. tig00000018 length = 44174
INFO [2021-02-14T22:06:43,855]  [Preprocessor.java:255] [main]  Processing chromosome tig00000019
Processing chromosome tig00000019
INFO [2021-02-14T22:06:43,893]  [Preprocessor.java:255] [main]  Processing chromosome tig00000020
Processing chromosome tig00000020
.INFO [2021-02-14T22:06:43,973]  [Preprocessor.java:255] [main]  Processing chromosome tig00000021
Processing chromosome tig00000021
INFO [2021-02-14T22:06:44,010]  [Preprocessor.java:255] [main]  Processing chromosome tig00000022
Processing chromosome tig00000022
.60.0% 
.....INFO [2021-02-14T22:06:44,516]  [Preprocessor.java:255] [main]  Processing chromosome tig00000023
Processing chromosome tig00000023
INFO [2021-02-14T22:06:44,579]  [Preprocessor.java:255] [main]  Processing chromosome tig00000024
Processing chromosome tig00000024
.WARN [2021-02-14T22:06:44,643]  [Preprocessor.java:199] [main]  Ignoring data from non-existent locus.  Probe = null  Locus = tig00000024:37725-37721. tig00000024 length = 37721
Ignoring data from non-existent locus.  Probe = null  Locus = tig00000024:37725-37721. tig00000024 length = 37721
INFO [2021-02-14T22:06:45,587]  [TDFWriter.java:318] [main]  Group idx: 1
Group idx: 1
100.0% 
Done
assembly_only.tdf generated.

No asm2_fa given. Done.
# assembly only
# Write output
# Get asm only for spectra-asm
#	Plot output_02.spectra-asm.hist
	Rscript /home/laptop/miniconda3/envs/merqury/share/merqury/plot/plot_spectra_cn.R -f output_02.spectra-asm.hist -o output_02.spectra-asm -z output_02.dist_only.hist
[1] "x_max: 10"
[1] "y_max: 4670068.7"
[1] "## Line graph"
[1] "## Area under the curve filled"
[1] "## Stacked"

# Clean up
Done!
ng 0 (too low) and 0 (too high) kmers.
Allocating space for 4245517 suffixes of 4 bits each -> 16982068 bits (0.002 GB) in blocks of 32.000 MB
                     4245517 values   of 7 bits each -> 29718619 bits (0.003 GB) in blocks of 32.000 MB
Loaded 4245517 kmers.  Skipped 0 (too low) and 0 (too high) kmers.
-- Opening sequences in 'assembly.fasta'.
Bye!

Found 1 command tree.

PROCESSING TREE #1 using 1 thread.
  opIntersect
    child.meryl
    assembly.meryl
    output to read.k15.assembly.meryl

Cleaning up.

Bye.

Found 1 command tree.

Found 1 command tree.

Found 1 command tree.
Loading required package: argparse
Loading required package: ggplot2
Loading required package: scales
