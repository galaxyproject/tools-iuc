Usage: ./phase_block.sh <asm.fasta> <hap1.meryl> <hap2.meryl> <out>
No modules available..
Detected k-mer size: 15

	Get gaps

	Generate haplotype marker sites bed

		-- pat
Using system JDK.
WARN [2021-02-14T22:07:08,189]  [Globals.java:138] [main]  Development mode is enabled
INFO [2021-02-14T22:07:08,196]  [IgvTools.java:838] [main]  Computing coverage.  File = output_02.assembly.pat.bed
Computing coverage.  File = output_02.assembly.pat.bed
INFO [2021-02-14T22:07:08,197]  [IgvTools.java:839] [main]  Max zoom = 7
Max zoom = 7
INFO [2021-02-14T22:07:08,197]  [IgvTools.java:840] [main]  Window size = 25
Window size = 25
INFO [2021-02-14T22:07:08,200]  [IgvTools.java:845] [main]  Window functions: mean 
Window functions: mean 
INFO [2021-02-14T22:07:08,200]  [IgvTools.java:846] [main]  Ext factor = 0
Ext factor = 0
INFO [2021-02-14T22:07:08,221]  [DirectoryManager.java:179] [main]  IGV Directory: /home/laptop/igv
IGV Directory: /home/laptop/igv
INFO [2021-02-14T22:07:08,221]  [GenomeManager.java:195] [main]  Loading genome: /home/laptop/Galaxy/repositories/lab-notebook/tools-galaxy/merqury/galaxy_tool/test-data/assembly.fasta.fai
Loading genome: /home/laptop/Galaxy/repositories/lab-notebook/tools-galaxy/merqury/galaxy_tool/test-data/assembly.fasta.fai
INFO [2021-02-14T22:07:08,245]  [IGVEventBus.java:80] [main]  No observers for event type: class org.broad.igv.event.GenomeChangeEvent
No observers for event type: class org.broad.igv.event.GenomeChangeEvent
INFO [2021-02-14T22:07:09,906]  [IGVEventBus.java:80] [main]  No observers for event type: class org.broad.igv.event.GenomeChangeEvent
No observers for event type: class org.broad.igv.event.GenomeChangeEvent
INFO [2021-02-14T22:07:09,906]  [GenomeManager.java:287] [main]  Genome loaded.  id= /home/laptop/Galaxy/repositories/lab-notebook/tools-galaxy/merqury/galaxy_tool/test-data/assembly.fasta
Genome loaded.  id= /home/laptop/Galaxy/repositories/lab-notebook/tools-galaxy/merqury/galaxy_tool/test-data/assembly.fasta
INFO [2021-02-14T22:07:09,942]  [Preprocessor.java:255] [main]  Processing chromosome tig00000001
Processing chromosome tig00000001
..INFO [2021-02-14T22:07:10,220]  [Preprocessor.java:255] [main]  Processing chromosome tig00000002
Processing chromosome tig00000002
..INFO [2021-02-14T22:07:10,391]  [Preprocessor.java:255] [main]  Processing chromosome tig00000004
Processing chromosome tig00000004
.INFO [2021-02-14T22:07:10,476]  [Preprocessor.java:255] [main]  Processing chromosome tig00000005
Processing chromosome tig00000005
.INFO [2021-02-14T22:07:10,531]  [Preprocessor.java:255] [main]  Processing chromosome tig00000006
Processing chromosome tig00000006
..INFO [2021-02-14T22:07:10,593]  [Preprocessor.java:255] [main]  Processing chromosome tig00000007
Processing chromosome tig00000007
INFO [2021-02-14T22:07:10,614]  [Preprocessor.java:255] [main]  Processing chromosome tig00000008
Processing chromosome tig00000008
.INFO [2021-02-14T22:07:10,672]  [Preprocessor.java:255] [main]  Processing chromosome tig00000009
Processing chromosome tig00000009
INFO [2021-02-14T22:07:10,709]  [Preprocessor.java:255] [main]  Processing chromosome tig00000010
Processing chromosome tig00000010
10.0% 
INFO [2021-02-14T22:07:10,747]  [Preprocessor.java:255] [main]  Processing chromosome tig00000011
Processing chromosome tig00000011
INFO [2021-02-14T22:07:10,779]  [Preprocessor.java:255] [main]  Processing chromosome tig00000012
Processing chromosome tig00000012
INFO [2021-02-14T22:07:10,810]  [Preprocessor.java:255] [main]  Processing chromosome tig00000013
Processing chromosome tig00000013
.INFO [2021-02-14T22:07:10,838]  [Preprocessor.java:255] [main]  Processing chromosome tig00000014
Processing chromosome tig00000014
INFO [2021-02-14T22:07:10,867]  [Preprocessor.java:255] [main]  Processing chromosome tig00000015
Processing chromosome tig00000015
INFO [2021-02-14T22:07:10,887]  [Preprocessor.java:255] [main]  Processing chromosome tig00000017
Processing chromosome tig00000017
INFO [2021-02-14T22:07:10,910]  [Preprocessor.java:255] [main]  Processing chromosome tig00000018
Processing chromosome tig00000018
.INFO [2021-02-14T22:07:10,924]  [Preprocessor.java:255] [main]  Processing chromosome tig00000019
Processing chromosome tig00000019
INFO [2021-02-14T22:07:10,936]  [Preprocessor.java:255] [main]  Processing chromosome tig00000020
Processing chromosome tig00000020
INFO [2021-02-14T22:07:10,962]  [Preprocessor.java:255] [main]  Processing chromosome tig00000021
Processing chromosome tig00000021
INFO [2021-02-14T22:07:10,983]  [Preprocessor.java:255] [main]  Processing chromosome tig00000022
Processing chromosome tig00000022
.INFO [2021-02-14T22:07:11,039]  [Preprocessor.java:255] [main]  Processing chromosome tig00000023
Processing chromosome tig00000023
INFO [2021-02-14T22:07:11,062]  [Preprocessor.java:255] [main]  Processing chromosome tig00000024
Processing chromosome tig00000024
.INFO [2021-02-14T22:07:11,328]  [TDFWriter.java:318] [main]  Group idx: 1
Group idx: 1
100.0% 
Done

		-- mat
Using system JDK.
WARN [2021-02-14T22:07:16,338]  [Globals.java:138] [main]  Development mode is enabled
INFO [2021-02-14T22:07:16,345]  [IgvTools.java:838] [main]  Computing coverage.  File = output_02.assembly.mat.bed
Computing coverage.  File = output_02.assembly.mat.bed
INFO [2021-02-14T22:07:16,346]  [IgvTools.java:839] [main]  Max zoom = 7
Max zoom = 7
INFO [2021-02-14T22:07:16,346]  [IgvTools.java:840] [main]  Window size = 25
Window size = 25
INFO [2021-02-14T22:07:16,348]  [IgvTools.java:845] [main]  Window functions: mean 
Window functions: mean 
INFO [2021-02-14T22:07:16,349]  [IgvTools.java:846] [main]  Ext factor = 0
Ext factor = 0
INFO [2021-02-14T22:07:16,370]  [DirectoryManager.java:179] [main]  IGV Directory: /home/laptop/igv
IGV Directory: /home/laptop/igv
INFO [2021-02-14T22:07:16,371]  [GenomeManager.java:195] [main]  Loading genome: /home/laptop/Galaxy/repositories/lab-notebook/tools-galaxy/merqury/galaxy_tool/test-data/assembly.fasta.fai
Loading genome: /home/laptop/Galaxy/repositories/lab-notebook/tools-galaxy/merqury/galaxy_tool/test-data/assembly.fasta.fai
INFO [2021-02-14T22:07:16,393]  [IGVEventBus.java:80] [main]  No observers for event type: class org.broad.igv.event.GenomeChangeEvent
No observers for event type: class org.broad.igv.event.GenomeChangeEvent
INFO [2021-02-14T22:07:18,006]  [IGVEventBus.java:80] [main]  No observers for event type: class org.broad.igv.event.GenomeChangeEvent
No observers for event type: class org.broad.igv.event.GenomeChangeEvent
INFO [2021-02-14T22:07:18,006]  [GenomeManager.java:287] [main]  Genome loaded.  id= /home/laptop/Galaxy/repositories/lab-notebook/tools-galaxy/merqury/galaxy_tool/test-data/assembly.fasta
Genome loaded.  id= /home/laptop/Galaxy/repositories/lab-notebook/tools-galaxy/merqury/galaxy_tool/test-data/assembly.fasta
INFO [2021-02-14T22:07:18,034]  [Preprocessor.java:255] [main]  Processing chromosome tig00000001
Processing chromosome tig00000001
..INFO [2021-02-14T22:07:18,461]  [Preprocessor.java:255] [main]  Processing chromosome tig00000002
Processing chromosome tig00000002
...INFO [2021-02-14T22:07:18,670]  [Preprocessor.java:255] [main]  Processing chromosome tig00000004
Processing chromosome tig00000004
..INFO [2021-02-14T22:07:18,776]  [Preprocessor.java:255] [main]  Processing chromosome tig00000005
Processing chromosome tig00000005
..INFO [2021-02-14T22:07:18,867]  [Preprocessor.java:255] [main]  Processing chromosome tig00000006
Processing chromosome tig00000006
10.0% 
INFO [2021-02-14T22:07:18,940]  [Preprocessor.java:255] [main]  Processing chromosome tig00000007
Processing chromosome tig00000007
.INFO [2021-02-14T22:07:18,964]  [Preprocessor.java:255] [main]  Processing chromosome tig00000008
Processing chromosome tig00000008
.INFO [2021-02-14T22:07:19,031]  [Preprocessor.java:255] [main]  Processing chromosome tig00000009
Processing chromosome tig00000009
INFO [2021-02-14T22:07:19,070]  [Preprocessor.java:255] [main]  Processing chromosome tig00000010
Processing chromosome tig00000010
.INFO [2021-02-14T22:07:19,107]  [Preprocessor.java:255] [main]  Processing chromosome tig00000011
Processing chromosome tig00000011
INFO [2021-02-14T22:07:19,140]  [Preprocessor.java:255] [main]  Processing chromosome tig00000012
Processing chromosome tig00000012
.INFO [2021-02-14T22:07:19,176]  [Preprocessor.java:255] [main]  Processing chromosome tig00000013
Processing chromosome tig00000013
INFO [2021-02-14T22:07:19,209]  [Preprocessor.java:255] [main]  Processing chromosome tig00000014
Processing chromosome tig00000014
.INFO [2021-02-14T22:07:19,246]  [Preprocessor.java:255] [main]  Processing chromosome tig00000015
Processing chromosome tig00000015
INFO [2021-02-14T22:07:19,279]  [Preprocessor.java:255] [main]  Processing chromosome tig00000017
Processing chromosome tig00000017
INFO [2021-02-14T22:07:19,302]  [Preprocessor.java:255] [main]  Processing chromosome tig00000018
Processing chromosome tig00000018
INFO [2021-02-14T22:07:19,323]  [Preprocessor.java:255] [main]  Processing chromosome tig00000019
Processing chromosome tig00000019
INFO [2021-02-14T22:07:19,336]  [Preprocessor.java:255] [main]  Processing chromosome tig00000020
Processing chromosome tig00000020
.INFO [2021-02-14T22:07:19,364]  [Preprocessor.java:255] [main]  Processing chromosome tig00000021
Processing chromosome tig00000021
INFO [2021-02-14T22:07:19,384]  [Preprocessor.java:255] [main]  Processing chromosome tig00000022
Processing chromosome tig00000022
..INFO [2021-02-14T22:07:19,485]  [Preprocessor.java:255] [main]  Processing chromosome tig00000023
Processing chromosome tig00000023
INFO [2021-02-14T22:07:19,506]  [Preprocessor.java:255] [main]  Processing chromosome tig00000024
Processing chromosome tig00000024
INFO [2021-02-14T22:07:19,794]  [TDFWriter.java:318] [main]  Group idx: 1
Group idx: 1
100.0% 
Done

	Sort output_02.assembly.bed

/home/laptop/miniconda3/envs/merqury/share/merqury/trio/switch_error.sh output_02.assembly.sort.bed output_02.assembly 100 20000

	java -jar -Xmx1g /home/laptop/miniconda3/envs/merqury/share/merqury/trio/bedMerToPhaseBlock.jar output_02.assembly.sort.bed output_02.assembly.100_20000 100 20000 


java -jar -Xmx1g /home/laptop/miniconda3/envs/merqury/share/merqury/eval/bedCalcN50.jar output_02.assembly.100_20000.phased_block.bed | tail -n1 | awk -v out=output_02.assembly.100_20000 -v swi="150952	1055380	14.3031%" '{print out"\t"$0"\tswi}' - >> output_02.assembly.100_20000.phased_block.stats

Count mat and pat hap-mers per block to output_02.assembly.100_20000.phased_block.counts
No modules available..

Rscript /home/laptop/miniconda3/envs/merqury/share/merqury/plot/plot_blob.R -f output_02.assembly.100_20000.phased_block.counts -o output_02.assembly.100_20000.phased_block.blob
[1] "mat"
[1] "pat"

age: argparse
Loading required package: ggplot2
Loading required package: scales
