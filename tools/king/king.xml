<tool id="king" name="KING" version="2.2.4">
    <requirements>
	<requirement type="package" version="2.2.4">king</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
    ln -s '$genotype' input.bed &&
    ln -s '$family' input.fam &&
    ln -s '$map' input.bim &&
    
    king -b input.bed --fam input.fam --bim input.bim

    '$related'

    '$duplicate'

    '$kinship'

    '$ibdseg'

    '$ibs'

    '$homog'

    #if $degree
    --degree $degree
    #end if

    #if $projection
    --projection $projection
    #end if

    '$unrelated'

    '$build'

    '$cluster'

    '$rplot'
    
    > '$kingoutput'
    ]]></command>
    <inputs>
	<param name="genotype" type="data" format="pbed" help="Binary genotype File" />
	<param name="family" type="data" format="lped" help="Family File" />
	<param name="map" type="data" format="tabular" help="Map File" />
	<!-- Beginning of the optional paramters -->
	<param argument="related" type="boolean" truevalue="--related" falsevalue="" label="Relatedness" />
	<param name="duplicate" type="boolean" truevalue="--duplicate" falsevalue="" label="Duplicates" />
	<param name="kinship" type="boolean" truevalue="--kinship" falsevalue="" label="Kinship" />
	<param name="ibdseg" type="boolean" truevalue="--ibdseg" falsevalue="" label="IBDSeg" />
	<param name="ibs" type="boolean" truevalue="--ibs" falsevalue="" label="IBS" />
	<param name="homog" type="boolean" truevalue="--homog" falsevalue="" label="Homog" />
	<param name="degree" type="integer" min="0" checked="false" optional="true" label="Degree" />
	<param name="projection" type="integer" min="0" checked="false" optional="true" label="Projection" />
	<param name="unrelated" type="boolean" truevalue="--unrelated" falsevalue="" label="Unrelated" />
	<param name="build" type="boolean" truevalue="--build" falsevalue="" label="Build" />
	<param name="cluster" type="boolean" truevalue="--cluster" falsevalue="" label="Cluster" />
	<param name="rplot" type="boolean" truevalue="--rplot" falsevalue="" label="Plot" />
    </inputs>
    <outputs>
	<data name="kingoutput" format="txt" />
    </outputs>
    <tests>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="related" value="true" />
	    <output name="kingoutput" file="king-related.txt" lines_diff="117" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="related" value="true" />
	    <param name="degree" value="2" />
	    <output name="kingoutput" file="king-related.txt" lines_diff="155"  />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="related" value="true" />
	    <param name="degree" value="2" />
	    <param name="rplot" value="true" />
	    <output name="kingoutput" file="king-related-projection-rplot.txt" lines_diff="158"  />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="duplicate" value="true" />
	    <output name="kingoutput" file="king-duplicate.txt" lines_diff="76" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="kinship" value="true" />
	    <output name="kingoutput" file="king-kinship-degree.txt" lines_diff="99" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="related" value="true" />
	    <param name="projection" value="100000" />
	    <output name="kingoutput" file="king-related-projection.txt" lines_diff="117"  />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="ibdseg" value="true" />
	    <output name="kingoutput" file="king-ibdseg.txt" lines_diff="156" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="ibdseg" value="true" />
	    <param name="degree" value="3" />
	    <param name="rplot" value="true" />
	    <output name="kingoutput" file="king-ibdseg-projection-rplot.txt" lines_diff="159"  />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="ibs" value="true" />
	    <output name="kingoutput" file="king-ibs.txt" lines_diff="160" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="homog" value="true" />
	    <output name="kingoutput" file="king-homog.txt" lines_diff="139" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="unrelated" value="true" />
	    <output name="kingoutput" file="king-unrelated.txt" lines_diff="110" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="unrelated" value="true" />
	    <param name="degree" value="2" />
	    <output name="kingoutput" file="king-unrelated-degree.txt" lines_diff="152" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="build" value="true" />
	    <output name="kingoutput" file="king-build.txt" lines_diff="121" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="build" value="true" />
	    <param name="degree" value="2" />
	    <output name="kingoutput" file="king-build-degree.txt" lines_diff="163" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="cluster" value="true" />
	    <output name="kingoutput" file="king-cluster.txt" lines_diff="109" />
	</test>
    </tests>
    <help><![CDATA[
    KING
    ]]></help>
    <citations>
    </citations>
</tool>
