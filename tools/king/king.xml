
<tool id="king" name="KING" version="2.2.4" python_template_version="3.5">
    <requirements>
        <requirement type="package">king</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
    king -b $genotype --fam $family --bim $map

    #if $related
    --related
    #end if

    #if $duplicate
    --duplicate
    #end if

    #if $kinship
    --kinship
    #end if

    #if $ibdseg
    --ibdseg
    #end if

    #if $ibs
    --ibs
    #end if

    #if $homog
    --homog
    #end if

    #if $degree
    --degree $degree
    #end if

    #if $projection
    --projection $projection
    #end if

    #if $unrelated
    --unrelated
    #end if

    #if $build
    --build
    #end if

    #if $cluster
    --cluster
    #end if

    #if $rplot
    --rplot
    #end if
    
    > $kingoutput
    ]]></command>
    <inputs>
	<param name="genotype" type="data" format="bed" help="Binary genotype File" />
	<param name="family" type="data" format="txt" help="Family File" />
	<param name="map" type="data" format="tabular" help="Map File" />
	<!-- Beginning of the optional paramters -->
	<param name="related" type="boolean" checked="false" optional="true" label="Relatedness" />
	<param name="duplicate" type="boolean" checked="false" optional="true" label="Duplicates" />
	<param name="kinship" type="boolean" checked="false" optional="true" label="Kinship" />
	<param name="ibdseg" type="boolean" checked="false" optional="true" label="IBDSeg" />
	<param name="ibs" type="boolean" checked="false" optional="true" label="IBS" />
	<param name="homog" type="boolean" checked="false" optional="true" label="Homog" />
	<param name="degree" type="integer" min="0" checked="false" optional="true" label="Degree" />
	<param name="projection" type="integer" min="0" checked="false" optional="true" label="Projection" />
	<param name="unrelated" type="boolean" checked="false" optional="true" label="Unrelated" />
	<param name="build" type="boolean" checked="false" optional="true" label="Build" />
	<param name="cluster" type="boolean" checked="false" optional="true" label="Cluster" />
	<param name="rplot" type="boolean" checked="false" optional="true" label="Plot" />
    </inputs>
    <outputs>
	<data name="kingoutput" format="txt" />
    </outputs>
    <tests>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="related" value="true" />
	    <output name="kingoutput" file="king-related.txt" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="related" value="true" />
	    <param name="degree" value="2" />
	    <output name="kingoutput" file="king-related.txt" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="related" value="true" />
	    <param name="degree" value="2" />
	    <param name="rplot" value="true" />
	    <output name="kingoutput" file="king-related-projection-rplot.txt" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="duplicate" value="true" />
	    <output name="kingoutput" file="king-duplicate.txt" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="kinship" value="true" />
	    <output name="kingoutput" file="king-kinship-degree.txt" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="related" value="true" />
	    <param name="projection" value="100000" />
	    <output name="kingoutput" file="king-related-projection.txt" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="ibdseg" value="true" />
	    <output name="kingoutput" file="king-ibdseg.txt" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="ibdseg" value="true" />
	    <param name="degree" value="3" />
	    <param name="rplot" value="true" />
	    <output name="kingoutput" file="king-ibdseg-projection-rplot.txt" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="ibs" value="true" />
	    <output name="kingoutput" file="king-ibs.txt" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="homog" value="true" />
	    <output name="kingoutput" file="king-homog.txt" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="unrelated" value="true" />
	    <output name="kingoutput" file="king-unrelated.txt" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="unrelated" value="true" />
	    <param name="degree" value="2" />
	    <output name="kingoutput" file="king-unrelated-degree.txt" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="build" value="true" />
	    <output name="kingoutput" file="king-build.txt" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="build" value="true" />
	    <param name="degree" value="2" />
	    <output name="kingoutput" file="king-build-degree.txt" />
	</test>
	<test>
	    <param name="genotype" value="ex.bed"/>
	    <param name="family" value="ex.fam"/>
	    <param name="map" value="ex.bim"/>
	    <param name="cluster" value="true" />
	    <output name="kingoutput" file="king-cluster.txt" />
	</test>
    </tests>
    <help><![CDATA[
         KING
    ]]></help>
    <citations>
    </citations>
</tool>
