<tool profile="16.07" id="mothur_get_seqs" name="Get.seqs" version="@WRAPPER_VERSION@.0">
    <description>Picks sequences by name</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <expand macro="stdio"/>
    <expand macro="version_command"/>
    <command><![CDATA[
@SHELL_OPTIONS@

## create symlinks to input datasets
ln -s '$accnos' accnos.dat &&
ln -s '$accnos2' accnos2.dat &&
ln -s '$fasta' fasta_in.dat &&
ln -s '$fastq' fastq_in.dat &&
ln -s '$count' count_in.dat &&
ln -s '$qfile' qfile_in.dat &&
ln -s '$name' name_in.dat &&
ln -s '$group' group_in.dat &&
ln -s '$alignreport' alignreport_in.dat &&
ln -s '$list' list_in.dat &&
ln -s '$taxonomy' taxonomy_in.dat &&

echo 'get.seqs(
    accnos=accnos.dat,
    #if $accnos2:
        accnos2=accnos2.dat,
    #end if
    #if $fasta:
        fasta=fasta_in.dat,
    #end if
    #if $fastq:
        fastq=fastq_in.dat,
    #end if
    #if $count:
        count=count_in.dat,
    #end if
    #if $qfile:
        qfile=qfile_in.dat,
    #end if
    #if $name:
        name=name_in.dat,
    #end if
    #if $group:
        group=group_in.dat,
    #end if
    #if $alignreport:
        alignreport=alignreport_in.dat,
    #end if
    #if $list:
        list=list_in.dat,
    #end if
    #if $taxonomy:
        taxonomy=taxonomy_in.dat,
    #end if
    dups=$dups
)'
| sed 's/ //g'  ## mothur trips over whitespace
| mothur
| tee mothur.out.log
    ]]></command>
    <inputs>
        <param name="accnos" type="data" format="mothur.accnos" label="accnos - Accession Names"/>
        <param name="accnos2" type="data" format="mothur.accnos" optional="true" label="accnos2 - Accession Names" help="Optional input"/>
        <param name="fasta" type="data" format="fasta" optional="true" label="fasta - Fasta Sequences"/>
        <param name="qfile" type="data" format="qual" optional="true" label="qfile - Fasta Quality"/>
        <param name="fastq" type="data" format="fastq" optional="true" label="count - a count_table" help="fastq - allows you to select sequences from your fastq file"/>
        <param name="count" type="data" format="mothur.count_table" optional="true" label="count - a count_table" help="generated by count.seqs"/>
        <param name="name" type="data" format="mothur.names" optional="true" label="name - Sequences Name reference"/>
        <param name="group" type="data" format="mothur.groups" optional="true" label="group - Sequences Groups"/>
        <param name="alignreport" type="data" format="mothur.align.report" optional="true" label="alignreport - Align Report"/>
        <param name="list" type="data" format="mothur.list" optional="true" label="list - OTU List"/>
        <param name="taxonomy" type="data" format="mothur.seq.taxonomy" optional="true" label="taxonomy - Taxonomy"/>
        <param name="dups" type="boolean" truevalue="dups" falsevalue="false" checked="true" label="dups - Apply to duplicates"/>
        <param name="format" type="select" label="Sequences format" optional="true" multiple="true">
            <option value="sanger">Sanger</option>
            <option value="illumina">Illumina</option>
            <option value="solexa">Solexa</option>
            <option value="illumina1.8+">Illumina 1.8+</option>
        </param>
        <expand macro="param-savelog"/>
    </inputs>
    <outputs>
        <expand macro="logfile-output"/>
        <data name="fasta_out" format_source="fasta" from_work_dir="fasta_in*.pick.*" label="${tool.name} on ${on_string}: pick.fasta">
            <filter>fasta</filter>
        </data>
        <data name="fastq_out" format_source="fastq" from_work_dir="fastq_in*.pick.*" label="${tool.name} on ${on_string}: pick.fastq">
            <filter>fastq</filter>
        </data>
        <data name="count_out" format_source="count" from_work_dir="count_in*.pick.*" label="${tool.name} on ${on_string}: pick.count">
            <filter>count</filter>
        </data>
        <data name="qfile_out" format_source="qfile" from_work_dir="qfile_in*.pick.*" label="${tool.name} on ${on_string}: pick.qfile">
            <filter>qfile</filter>
        </data>
        <data name="name_out" format="mothur.names" from_work_dir="name_in*.pick.*" label="${tool.name} on ${on_string}: pick.names">
            <filter>name</filter>
        </data>
        <data name="group_out" format="mothur.groups" from_work_dir="group_in*.pick.*" label="${tool.name} on ${on_string}: pick.groups">
            <filter>group</filter>
        </data>
        <data name="alignreport_out" format="mothur.align.report" from_work_dir="alignreport_in*.pick.*" label="${tool.name} on ${on_string}: pick.align.report">
            <filter>alignreport</filter>
        </data>
        <data name="list_out" format="mothur.list" from_work_dir="list_in*.pick.*" label="${tool.name} on ${on_string}: pick.list">
            <filter>list</filter>
        </data>
        <data name="taxonomy_out" format="mothur.seq.taxonomy" from_work_dir="taxonomy_in*.pick.*" label="${tool.name} on ${on_string}: pick.taxonomy">
            <filter>taxonomy</filter>
        </data>
    </outputs>
    <tests>
        <test>
            <param name="accnos" value="Mock_S280_L001_R1_001_small.trim.contigs.bad.accnos"/>
            <param name="fasta" value="Mock_S280_L001_R1_001_small.trim.contigs.fasta"/>
            <param name="dups" value=""/>
            <output name="fasta_out" md5="f9335b6b70dc639e420d33809e51431d"/>
            <param name="savelog" value="true"/>
            <expand macro="logfile-test"/>
        </test>
        <test>
            <param name="accnos" value="Mock_S280_L001_R1_001_small.trim.contigs.bad.accnos"/>
            <param name="fastq" value="Mock_S280_L001_R1_001_small.fastq"/>
            <output name="fastq_out" md5="81d026f969e15b8c8701f8dc5f3a6904"/>
            <param name="savelog" value="true"/>
            <expand macro="logfile-test"/>
        </test>
        <test>
            <!-- test two input files -->
            <param name="accnos" value="Mock_S280_L001_R1_001_small.trim.contigs.bad.accnos"/>
            <param name="fasta" value="Mock_S280_L001_R1_001_small.trim.contigs.fasta"/>
            <param name="fastq" value="Mock_S280_L001_R1_001_small.fastq"/>
            <param name="dups" value="false"/>
            <output name="fasta_out" md5="f9335b6b70dc639e420d33809e51431d"/>
            <output name="fastq_out" md5="81d026f969e15b8c8701f8dc5f3a6904"/>
            <param name="savelog" value="true"/>
            <expand macro="logfile-test"/>
        </test>
        <test>
            <param name="accnos" value="amazon.bad.accnos"/>
            <param name="count" value="amazon.count_table"/>
            <output name="count_out" md5="6892dd99850ce9e9f8f15e77b28f57e2"/>
            <param name="savelog" value="true"/>
            <expand macro="logfile-test"/>
        </test>
    </tests>
    <help><![CDATA[

@MOTHUR_OVERVIEW@

**Command Documentation**

The get.seqs_ command takes a list of sequence names and either a fasta, name_, group_, list_, align.report_ or taxonomy_ file to generate a new file that contains only the sequences in the list. This command may be used in conjunction with the list.seqs_ command to help screen a sequence collection.

.. _name: https://www.mothur.org/wiki/Name_file
.. _group: https://www.mothur.org/wiki/Group_file
.. _list: https://www.mothur.org/wiki/List_file
.. _align.report: https://www.mothur.org/wiki/Align.seqs
.. _taxonomy: https://www.mothur.org/wiki/Taxonomy_outline
.. _list.seqs: https://www.mothur.org/wiki/list.seqs
.. _get.seqs: https://www.mothur.org/wiki/Get.seqs

v.1.27.0 : Updated to Mothur 1.33, added count and fastq params

    ]]></help>
    <expand macro="citations"/>
</tool>
