<tool id="mothur_remove_otulabels" name="Remove.otulabels" version="@WRAPPER_VERSION@.0">
    <description>Removes OTU labels</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements" />

    <command><![CDATA[
        echo 'remove.otulabels(
        
        accnos=$accnos
        
        #if $constaxonomy_in:
            ,constaxonomy=$constaxonomy_in
        #end if
        
        #if $otucorr_in:
            ,otucorr=$otucorr_in
        #end if
        
        #if $corraxes_in:
            ,corraxes=$corraxes_in
        #end if
        
        #if $list:
            ,list=$list
        #end if
        
        #if $shared:
            ,shared=$shared
        #end if
        
        )'
        | sed 's/ //g'  ## mothur trips over whitespace
        | mothur &&
        
        prefix="$accnos" &&
        mv mothur.*.logfile "$logfile"
         
        #if $constaxonomy_in:
            && prefix="$constaxonomy_in"
            && mv \${prefix%.dat}*.pick.dat "$constaxonomy_out"
        #end if
         
        #if $otucorr_in:
            && prefix="$otucorr_in"
            && mv \${prefix%.dat}*.pick.dat "$otucorr_out"
        #end if
         
        #if $corraxes_in:
            && prefix="$corraxes_in"
            && mv \${prefix%.dat}*.pick.dat "$corraxes_out"
        #end if
    ]]></command>
    <inputs>
        <param name="accnos"
               type="data"
               format="mothur.otulabels"
               label="accnos - otulabels"/>
        <param name="constaxonomy_in"
               type="data"
               format="mothur.cons.taxonomy"
               optional="true"
               label="constaxonomy - Consensus Taxonomy from classify.otu"/>
        <param name="otucorr_in"
               type="data"
               format="mothur.otu.corr"
               optional="true"
               label="otucorr - OTU correlation from otu.association"/>
        <param name="corraxes_in"
               type="data"
               format="mothur.axes"
               optional="true"
               label="corraxes - axes from corr.axes"/>
        <param name="list"
               type="data"
               format="mothur.list"
               optional="true"
               label="list - allows you to input a list parameter to select OTUs from"/>
        <param name="shared"
               type="data"
               format="mothur.shared"
               optional="true"
               label="shared - input a shared file to select OTUs from"/>
    </inputs>
    <outputs>
        <data format="txt" name="logfile" label="${tool.name} on ${on_string}: logfile" />
        <data name="constaxonomy_out" format_source="constaxonomy_in" label="${tool.name} on ${on_string}: pick.cons.taxonomy">
            <filter>constaxonomy_in != None</filter>
        </data>
        <data name="otucorr_out" format_source="otucorr_in" label="${tool.name} on ${on_string}: pick.otu.corr">
            <filter>otucorr_in != None</filter>
        </data>
        <data name="corraxes_out" format_source="corraxes_in" label="${tool.name} on ${on_string}: pick.otu.corraxes">
            <filter>corraxes_in != None</filter>
        </data>
    </outputs>
    <tests>
        <test>
            <param name="accnos" value="amazon.accnos.otulabels"/>
            <param name="corraxes_in" value="amazon.pcoa.axes"/>
           
            <expand macro="logfile-test" />
            <output name="corraxes_out" md5="9bffef40bf6e879737835cf7323c5ce4" />
        </test>
        <!--
        Adding just one or two ID's from the taxanomy file results in a crash of mothur...
        <test>
            <param name="accnos" value="abrecovery.pds.wang.accnos.otulabels"/>
            <param name="constaxonomy_in" value="abrecovery.pds.wang.taxonomy"/>
           
            <expand macro="logfile-test" />
            <ouptut name="constaxonomy_out" md5="9bffef40bf6e879737835cf7323c5ce4" />
        </test>
        -->
    </tests>
    <help>
<![CDATA[

@MOTHUR_OVERVIEW@

**Command Documenation**

The remove.otulabels_ command removes otu labels from the output from classify.otu_, corr.axes_ and otu.association_. This can be useful especially with subsampled datasets or when groups have been selected.

.. _classify.otu: http://www.mothur.org/wiki/Classify.otu
.. _corr.axes: http://www.mothur.org/wiki/Corr.axes
.. _otu.association: http://www.mothur.org/wiki/Otu.association
.. _remove.otulabels: http://www.mothur.org/wiki/Remove.otulabels
]]>
    </help>
    <expand macro="citations" />
</tool>
