<tool id="mothur_heatmap_sim" name="Heatmap.sim" version="@WRAPPER_VERSION@.0"  force_history_refresh="True">
    <description>Generate a heatmap for pariwise similarity</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements" />

    <command interpreter="python"><![CDATA[
        mothur_wrapper.py 
        --cmd='heatmap.sim'
        --outputdir='$logfile.extra_files_path'
        #if $as_datasets.__str__ == "yes":
            #if $input.source == 'shared':
                --result='^mothur.\S+\.logfile$:'$logfile
                --datasetid='$logfile.id' --new_file_path='$__new_file_path__'
                --new_datasets='^\S+?\.((unique|[0-9.]*)(\S+)\.heatmap\.sim\.svg)$:svg'
            #else:
                --result='^mothur.\S+\.logfile$:'$logfile,'^\S+\.heatmap\.sim\.svg$:'$heatmap
            #end if
        #else:
            --result='^mothur.\S+\.logfile$:'$logfile
        #end if
        #if $input.source == 'shared':
            --shared="$input.otu"
            #if $input.label.__str__ != "None" and len($input.label.__str__) > 0:
                --label='$input.label'
            #end if
            #if $input.groups.__str__ != "None" and len($input.groups.__str__) > 0:
                --groups="$input.groups"
            #end if
            #if $input.calc.__str__ != "None" and len($input.calc.__str__) > 0:
                    --calc='$input.calc'
            #end if
        #elif $input.source == 'column':
            --column="$input.dist"
            --name="$input.name"
        #elif $input.source == 'phylip':
            --phylip="$input.dist"
        #end if
        #if 100 > $fontsize > 0:
            --fontsize="$fontsize"
        #end if
        #if $count.__str__ != "None" and len($count.__str__) > 0:
            --count="$count"
        #end if
    ]]></command>
    <inputs>
        <conditional name="input">
            <param name="source" type="select" label="Generate Heatmap for">
                <option value="shared">shared - Sample Similarity - OTU Shared</option>
                <option value="phylip">phylip - Phylip Distance Matrix</option>
                <option value="column">colomn - Pairwise Column Distance Matrix</option>
            </param>
            <when value="shared">
                <param name="otu" type="data" format="mothur.shared" label="shared - OTU Shared"/>
                <param name="label" type="select" label="label - OTU Labels" multiple="true">
                        <expand macro="labeloptions"/>
                </param>
                <param name="groups" type="select" label="groups - Groups to include" multiple="true">
                    <options>
                        <filter type="data_meta" ref="otu" key="groups" />
                    </options>
                </param>
                <param name="calc" type="select" label="calc - Calculators (Uses defaults if none selected)" multiple="true">
                    <option value="jclass">jclass - Community Membership Similarity the traditional Jaccard similarity coefficient based on the observed richness</option>
                    <option value="jest" selected="true">jest - Community Membership Similarity the Jaccard similarity coefficient based on the Chao1 estimated richnesses</option>
                    <option value="sorclass">sorclass - Community Membership Similarity the Sorenson similarity coefficient based on the observed richness</option>
                    <option value="sorest">sorest - Community Membership Similarity the Sorenson similarity coefficient based on the Chao1 estimated richnesses</option>
                    <option value="braycurtis">braycurtis - Community Structure Similarity the Bray-Curtis similarity coefficient</option>
                    <option value="jabund">jabund - Community Structure Similarity the abundance-based Jaccard similarity coefficient</option>
                    <option value="morisitahorn">morisitahorn - Community Structure Similarity the Morisita-Horn similarity coefficient</option>
                    <option value="sorabund">sorabund - Community Structure Similarity the abundance-based Sorenson similarity coefficient</option>
                    <option value="thetan">thetan - Community Structure Similarity the Smith theta similarity coefficient</option>
                    <option value="thetayc" selected="true">thetayc - Community Structure Similarity the Yue &amp; Clayton theta similarity coefficient</option>
                </param>
            </when>
            <when value="column">
                <param name="dist" type="data" format="mothur.pair.dist" label="column - Distance Matrix"/>
                <param name="name" type="data" format="mothur.names" label="name - Names"/>
            </when>
            <when value="phylip">
                <param name="dist" type="data" format="lower.dist,square.dist" label="phylip - Distance Matrix"/>
            </when>
        </conditional>
        <param name="fontsize" type="integer" value="24" label="fontsize - Fontsize (default is 24)"/>
        <param name="as_datasets" type="boolean" truevalue="yes" falsevalue="no" checked="false" label="Create a new history dataset for each image"/>
        <param name="count" type="data" format="mothur.count_table" optional="true" label="count - a count_table" help="generated by count.seqs"/>
    </inputs>
    <outputs>
        <data format="html" name="logfile" label="${tool.name} on ${on_string}: logfile" />
        <data format="svg" name="heatmap" label="${tool.name} on ${on_string}: heatmap.sim.svg">
            <filter>as_datasets != 'true' and input['source'] != 'shared'</filter>
        </data>
    </outputs>
    <tests>
    </tests>
    <help>
<![CDATA[

@MOTHUR_OVERVIEW@

**Command Documenation**

The heatmap.sim_ command generates a heat map from data provided in either a shared_ file, a phylip_ distance matrix, or a column_ distance matrix and a name_ file.  For calc parameter choices see: http://www.mothur.org/wiki/Calculators

.. _shared: http://www.mothur.org/wiki/Shared_file
.. _phylip: http://www.mothur.org/wiki/Phylip-formatted_distance_matrix
.. _column: http://www.mothur.org/wiki/Column-formatted_distance_matrix
.. _name: http://www.mothur.org/wiki/Name_file
.. _heatmap.sim: http://www.mothur.org/wiki/Heatmap.sim

v.1.24.0: Updated to Mothur 1.33, added count parameter
]]>
    </help>
    <expand macro="citations" />
</tool>
