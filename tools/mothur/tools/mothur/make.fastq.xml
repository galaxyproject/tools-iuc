<tool profile="16.07" id="mothur_make_fastq" name="Make.fastq" version="@WRAPPER_VERSION@.0">
    <description>Convert fasta and quality to fastq</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <expand macro="version_command"/>
    <command detect_errors="aggressive"><![CDATA[
        echo 'make.fastq(
            fasta=$fasta,
            qfile=$qfile
            #if $chooseformat.use == "yes":
                ,format=${chooseformat.format}
            #end if
        )'
        | sed 's/ //g'  ## mothur trips over whitespace
        | mothur &&

        ## move output files to correct destination
        prefix='$fasta' &&
        mv \${prefix%.dat}*.fastq '$fastq' &&
        mv mothur.*.logfile '$logfile'
    ]]></command>
    <inputs>
        <param name="fasta" type="data" format="fasta" label="fasta - Fasta Sequence file"/>
        <param name="qfile" type="data" format="qual454,qualillumina,qualsolid,qual" label="qfile - Sequence Quality file"/>
        <conditional name="chooseformat">
            <param name="use" type="select" label="Choose quality format for your output sequences are" help="If none selected, this tool will keep the format of input qfile">
                <option value="no" selected="true">no</option>
                <option value="yes">yes</option>
            </param>
            <when value="yes">
                <param name="format" type="select" optional="true" multiple="true">
                    <option value="sanger" selected="true">sanger</option>
                    <option value="illumina1.8+">Illumina 1.8+</option>
                    <option value="illumina">Illumina</option>
                </param>
            </when>
            <when value="no"/>
        </conditional>
    </inputs>
    <outputs>
        <data name="logfile" format="txt" label="${tool.name} on ${on_string}: logfile"/>
        <data name="fastq" format="fasta" label="${tool.name} on ${on_string}: fastq">
            <change_format><!-- if set, chooseformat.format param should override qfile.ext format -->
                <when input="qfile.ext" value="qual454" format="fastqsanger"/>
                <when input="qfile.ext" value="qualillumina" format="fastqillumina"/>
                <when input="qfile.ext" value="qualsolid" format="fastqcssanger"/>
                <when input="chooseformat.format" value="sanger" format="fastqsanger"/>
                <when input="chooseformat.format" value="illumina1.8+" format="fastqsanger"/>
                <when input="chooseformat.format" value="illumina" format="fastqillumina"/>
            </change_format>
        </data>
    </outputs>
    <tests>
        <test><!-- test defaults -->
            <param name="fasta" value="Mock_S280_L001_R1_001_small.trim.contigs.fasta"/>
            <param name="qfile" value="Mock_S280_L001_R1_001_small.trim.contigs.qual" ftype="qual454"/>
            <output name="fastq" md5="e77b78321620e300946c23147ad599fd" ftype="fastqsanger"/>
            <expand macro="logfile-test"/>
        </test>
        <test><!-- test with quality score format conversion -->
            <param name="fasta" value="Mock_S280_L001_R1_001_small.trim.contigs.fasta"/>
            <param name="qfile" value="Mock_S280_L001_R1_001_small.trim.contigs.qual" ftype="qual454"/>
            <param name="use" value="yes"/>
            <param name="format" value="illumina"/>
            <output name="fastq" md5="c792253da205d4d1c66bc87a2969aa25" ftype="fastqillumina"/>
            <expand macro="logfile-test"/>
        </test>
    </tests>
    <help>
        <![CDATA[

@MOTHUR_OVERVIEW@

**Command Documenation**

The fastq.info_ command reads a fasta file and quality file and creates a fastq.


.. _fastq.info: http://www.mothur.org/wiki/Make.fastq
]]>
    </help>
    <expand macro="citations"/>
</tool>
