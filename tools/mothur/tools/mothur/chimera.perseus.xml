<tool id="mothur_chimera_perseus" name="Chimera.perseus" version="@WRAPPER_VERSION@.0" >
    <description>Find putative chimeras using chimeraCheck</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements" />

    <command interpreter="python"><![CDATA[
        mothur_wrapper.py 
        --cmd='chimera.perseus'
        --result='^mothur.\S+\.logfile$:'$logfile,'^\S+\.perseus\.chimeras?$:'$out_file
        --result='^mothur.\S+\.logfile$:'$logfile,'^\S+\.perseus\.chimeras?$:'$out_file,'^\S+\.perseus\.accnos$:'$out_accnos
        --outputdir='$logfile.extra_files_path'
        --fasta="$fasta"
        #if isinstance($name.datatype, $__app__.datatypes_registry.get_datatype_by_extension('name').__class__):
            --name="$name"
        #else
            --count="$name"
        #end if
        #if $group.__str__ != "None" and len($group.__str__) > 0:
            --group='$group'
        #end if
        #if $alpha.__str__ != '':
            --alpha="$alpha"
        #end if
        #if $beta.__str__ != '':
            --beta="$beta"
        #end if
        #if $cutoff.__str__ != '':
            --cutoff="$cutoff"
        #end if
        --processors=\${GALAXY_SLOTS:-8}
        "$dereplicate"
    ]]></command>
    <inputs>
        <param name="fasta" type="data" format="mothur.align" label="fasta - Candiate Aligned Sequences"/>
        <param name="name" type="data" format="mothur.names,count" label="name - Names or count_table"/>
        <param name="group" type="data" format="group" optional="true" label="group - Sequences Name reference"/>
        <param name="alpha" type="float" value="-5.54" optional="true" label="alpha" help="The default is -5.54"/>
        <param name="beta" type="float" value="0.33" optional="true" label="beta" help="The default is 0.33"/>
        <param name="cutoff" type="float" value="0.50" optional="true" label="cutoff" help="The default is 0.50"/>
        <param name="dereplicate" type="boolean" falsevalue="" truevalue="--dereplicate=true" checked="false" label="dereplicate - remove chimeric sequences from all groups, default=f" help="If parameter is false, then if one group finds the seqeunce to be chimeric, then all groups find it to be chimeric"/>
    </inputs>
    <outputs>
        <data format="html" name="logfile" label="${tool.name} on ${on_string}: logfile" />
        <data format="tabular" name="out_file" label="${tool.name} on ${on_string}: perseus.chimeras" />
        <data format="mothur.accnos" name="out_accnos" label="${tool.name} on ${on_string}: perseus.accnos" />
    </outputs>
    <tests>
    </tests>
    <help>
<![CDATA[

@MOTHUR_OVERVIEW@

**Command Documenation**

The chimera.perseus_ command reads a fasta and name file, and outputs potentially chimeric sequences.

.. _chimera.perseus: http://www.mothur.org/wiki/Chimera.perseus

]]>
    </help>
    <expand macro="citations" />
</tool>
