<tool id='pysradb_search' name='pysradb search' version='@TOOL_VERSION@+galaxy@SUFFIX_VERSION@' profile='20.01'>
    <description>query sequence metadata from NCBI SRA</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro='requirements' />
    <expand macro="bio_tools"/>
    <command detect_errors='exit_code'><![CDATA[
    pysradb search
    --db 'sra' ## ena and geo also allowed
    #if $max
        --max $max
    #end if
    #if $query
        --query '${query}' 
    #end if
    #if $accesssion
        --accession '${accession}'
    #end if
    #if $organism
        --organism '${organism}'
    #end if
    --layout $layout
    #if $mbases
        --mbases $mbases
    #end if
    #if $publication_date
        --publication-date '${publication_date}'
    #end if
    --platform $conditional.platform
    #end if
    #if $selection
        --selection $selection
    #end if
    --source $source
    #if $selection
    --selection $selection
    #end if
    --strategy $strategy
    -v 3
    --saveto 'csv'
    ]]></command>
        <inputs>
            <!--param argument="-\-db" type="select" label="Database" help="TODO">
                <option value="sra">SRA</option>
                <option value="ena">ENA</option>
                <option value="geo">GEO</option>
            </param-->
            <param argument="--max" type="integer" min="1" max="1000" value="20" label="Maximum number of entries" help="TODO" />
            <param argument="--query" type="text" value="" optional="true"
                label="Query keywords" help="Multiple keywords should be separated by spaces; note that if no query is supplied, at least one of the following flags must be present">
                <sanitizer invalid_char="">
                    <valid initial="string.letters,string.digits">
                        <add value="_" />
                        <add value="-" />
                        <add value=" " />
                    </valid>
            </sanitizer>
            <validator type="regex">[0-9a-zA-Z_- ]+</validator>
        </param>
        <param argument="--accession" type="text" value="" label="Accession number" help="TODO">
            <sanitizer invalid_char="">
                <valid initial="string.letters,string.digits"/>
            </sanitizer>
            <validator type="regex">[0-9a-zA-Z]+</validator>
        </param>
        <param argument="--organism" type="text" label="Scientific name of the sample organism" help="TODO">
            <sanitizer invalid_char="">
                <valid initial="string.letters">
                    <add value=" " />
                </valid>
            </sanitizer>
            <validator type="regex">[a-zA-Z ]+</validator>
        </param>
        <param argument="layout" type="select" label="Library layout" help="TODO">
            <option value="single">Single reads</option>
            <option value="paired">Paired reads</option>
        </param>
        <param argument="--mbases" type="integer" min="0" value="" optional="true" 
            label="Sample size" help="Size of the sample rounded to the nearest megabase" />
        <param argument="--publication-date" type="text" value="" optional="true" 
            label="Publication date" help="Publication date of the run in the format dd-mm-yyyy. 
                If a date range is desired, enter the start date, followed by end date, separated by a colon ':'.
                Example: 01-01-2010:31-12-2010">
            <sanitizer invalid_char="">
                <valid initial="string.letters,string.digits">
                    <add value=":" />
                    <add value="-" />
                </valid>
            </sanitizer>
            <validator type="regex">[0-9a-zA-Z:-]+</validator>
        </param>
        <conditional name="conditional">
            <param argument="--platform" type="select" label="Platform" help="TODO">
                <option value="illumina">Illumina</option>
                <option value="oxford nanopore">Oxford Nanopore</option>
                <option value="pacbio smrt">PacBio SMRT</option>
            </param>
            <when value="illumina">
                <expand macro="platform_macro" >
                    <option value="Illumina NovaSeq 6000">TODO: </option>
                    <option value="Illumina MiSeq">TODO: </option>
                    <option value="NextSeq 500">TODO: </option>
                    <option value="Illumina HiSeq 2000">TODO: </option>
                    <option value="Illumina HiSeq 4000">TODO: </option>
                    <option value="HiSeq X Ten">TODO: </option>
                    <option value="Illumina HiSeq 4000">TODO: </option>
                </expand>
            </when>
            <when value="nanopore">
                <expand macro="platform_macro" >
                    <option value="Sequel"></option>
                    <option value="Sequel II"></option>
                </expand>
            </when>
            <when value="pacbio">
                <expand macro="platform_macro" >
                    <option value="MinION"></option>
                    <option value="PromethION"></option>
                    <option value="GridION"></option>
                </expand>
            </when>
        </conditional>
        <param argument="--selection" type="select" optional="true" label="Library selection" help="This option is optional">
            <option value="5 methylcytidine antibody">Not specified</option>
            <option value="cage">cDNA</option>
            <option value="cdna">ChIp-seq</option>
            <option value="chip"></option>
            <option value="chip seq"></option>
            <option value="dnase"></option>
            <option value="hmpr"></option>
            <option value="hybrid selection"></option>
            <option value="inverse rrna"></option>
            <option value="mbd2 protein methyl cpg binding domain"></option>
            <option value="mda"></option>
            <option value="mf"></option>
            <option value="mnase"></option>
            <option value="msII"></option>
            <option value="oligo dt"></option>
            <option value="padlock proves capture method"></option>
            <option value="pcr"></option>
            <option value="polya"></option>
            <option value="race"></option>
            <option value="random"></option>
            <option value="random pcr"></option>
            <option value="reduced representation"></option>
            <option value="repeat fractionation"></option>
            <option value="restriction digest"></option>
            <option value="rt pcr"></option>
            <option value="size fractionation"></option>
        </param>
        <param argument="--source" type="select" label="Library source" help="TODO">
            <option value="genomic">Genomic</option>
            <option value="transcriptomic">Transcriptomic</option>
            <option value="metagenomic">Metagenomic</option>
            <option value="genomic single cell">Genomic single cell</option>
            <option value="transcriptomic single cell">Transcriptomic single cell</option>
            <option value="metatranscriptomic">Metatranscriptomic</option>
            <option value="viral rna">Viral RNA</option>
            <option value="synthetic">Synthetic</option>
            <option value="other">Other</option>
        </param>
        <param argument="--strategy" type="select" label="Library preparation strategy" help="TODO">
            <option value="amplicon">Amplicon</option>
            <option value="atac seq">ATAC-seq</option>
            <option value="bisulfite seq">Bisulfite-seq</option>
            <option value="chia pet">Chromatin interaction analysis with paired-end tag (ChIA-PET)</option>
            <option value="chip">ChIP</option>
            <option value="chip seq">ChIP-seq</option>
            <option value="cts">Coding transcriptome sequencing (CTS)</option>
            <option value="dnase hypersensitivity">DNase-seq</option>
            <option value="est">EST</option>
            <option value="faire seq">FAIRE-seq</option>
            <option value="fl cdna">FL-cDNA</option>
            <option value="gbs">Genotyping-by-sequencing (GBS)</option>
            <option value="hi c">Hi-C</option>
            <option value="medip seq">Methylated DNA immunoprecipitation sequencing (MeDIP-Seq)</option>
            <option value="mbd seq">Methyl-binding domain sequencing (MBD-seq)</option>
            <option value="mnase seq">Micrococcal nuclease sequencing (MNase-seq)</option>
            <option value="mirna seq">miRNA-seq</option>
            <option value="mre seq">Methylation sensitive restriction enzyme sequencing (MRE-seq)</option>
            <option value="ncrna seq">ncRNA-seq</option>
            <option value="other">Other</option>
            <option value="poolclone">POOLCLONE</option>
            <option value="rad seq">Restriction site-associated DNA sequencing (RAD-seq)</option>
            <option value="rip seq">RNA immunoprecipitation sequencing (RIP-seq)</option>
            <option value="rna seq">RNA-seq</option>
            <option value="selex">Systematic evolution of ligands by exponential enrichment (SELEX)</option>
            <option value="synthetic long read">Synthetic long-read sequencing</option>
            <option value="target capture">Target capture sequencing (TCS)</option>
            <option value="tn seq">Tn-seq</option>
            <option value="wcs">Whole chromosome shotgun (WCS)</option>
            <option value="wga">Whole genome amplification (WGA)</option>
            <option value="wgs">Whole-genome sequencing (WGS) </option>
            <option value="wxs">Whole-exome sequencing (WXS)</option>
        </param>
    </inputs>      
    <outputs>
        <data name="metadata_file" from_work_dir="" format="csv" label="${tool.name} on ${on_string}: metadata"/>
    </outputs>
    <tests>
    </tests>
    <help><![CDATA[
.. class:: infomark

**Purpose**

Hello, world!

    ]]>    </help>
    <expand macro="citations" />
</tool>
