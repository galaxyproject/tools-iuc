<tool id="rm_spurious_events.py" name="Remove spurious" version="1.0.0">
    <description>crosslinking events</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <expand macro="stdio"/>
    <command>
        <![CDATA[
rm_spurious_events.py
'$positional_1'

--threshold '$threshold'
--outfile '$default'
]]>
    </command>
    <inputs>
        <param label="bed6 file containing alignments." name="positional_1" type="data" format="bed"/>
        <param help="(--threshold)" label="Threshold for spurious event removal." name="threshold" optional="true" type="float" value="0.1"/>
    </inputs>
    <outputs>
        <data format="bed" name="default"/>
    </outputs>
    <tests>
        <test>
            <param name="positional_1" value="merged_pcr_dupes_spurious.bed"/>
            <param name="threshold" value="0.5"/>
            <output name="default" file="merged_pcr_dupes_spurious_filtered_thresh05.bed"/>
        </test>
    </tests>
    <help>
        <![CDATA[
Remove spurious events originating from errors in random sequence tags.

This tool compares all events sharing the same coordinates. Among each group
of events the maximum number of PCR duplicates is determined. All events that
are supported by less than 10 percent of this maximum count are removed.

Input::

* bed6 file containing crosslinking events with score field set to number of PCR duplicates

Output::

* bed6 file with spurious crosslinking events removed, sorted by fields chrom, start, stop, strand
]]>
    </help>
    <expand macro="citations"/>
</tool>
