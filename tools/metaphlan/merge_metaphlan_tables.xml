<tool id="merge_metaphlan_tables" name="Merge" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="@PROFILE@">
    <description>MetaPhlAn abundance tables</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="edam_ontology"/>
    <expand macro="requirements"/>
    <version_command>metaphlan -v</version_command>
    <command detect_errors="aggressive"><![CDATA[
merge_metaphlan_tables.py
    #for $element in $inputs
        '$element'
    #end for
    > '$output'
]]>
    </command>
    <inputs>
        <param name="inputs" type="data" format="tabular,txt" multiple="true" label="Predicted taxon relative abundance tables generaed by MetaPhlAn"/>
    </inputs>
    <outputs>
        <data name="output" format="tabular" label="${tool.name} on ${on_string}: Merged taxon relative abundance tables"/>
    </outputs>
    <tests>
        <test expect_num_outputs="1">
            <param name="inputs" value="SRS014464-Anterior_nares-abundances.tabular,SRS014464-Anterior_nares-abundances.tabular"/>
            <output name="output" ftype="tabular">
                <assert_contents>
                    <has_text text="k__Bacteria|p__Actinobacteria|c__Actinobacteria|o__Corynebacteriales|f__Corynebacteriaceae|g__Corynebacterium|s__Corynebacterium_accolens"/>
                    <has_text text="dataset_"/>
                    <has_text text="clade_name"/>
                    <has_line_matching expression="#.*"/>
                </assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[
What it does
============

MetaPhlAn is a computational tool for profiling the composition of microbial communities (Bacteria, 
Archaea and Eukaryotes) from metagenomic shotgun sequencing data (i.e. not 16S) at the species-level. 

This tool performs a table join on one or more tab-separated files with the predicted taxon relative abundances
that have been generated by MetaPhlAn.
    ]]></help>
    <expand macro="citations"/>
</tool>
