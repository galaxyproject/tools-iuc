<?xml version="1.0"?>
<macros>
    <token name="@TOOL_VERSION@">5.2.10.49</token>
    <token name="@VERSION_SUFFIX@">0</token>
    <xml name="requirements">
        <requirements>
            <requirement type="package" version="@TOOL_VERSION@">pisces</requirement>
            <requirement type="package" version="1.11">samtools</requirement>
        </requirements>
    </xml>
    <xml name="version_command">
    	<version_command><![CDATA[@DOTNET@ @PISCES@ -v 2>&1 | grep 'Pisces' | cut -f 2 -d ' ' ]]></version_command> <!-- TODO -->
    </xml>
    <xml name="citations">
	    <citations>
	        <citation type="doi">10.1101/291641</citation>
	        <citation type="doi">10.1093/bioinformatics/bty849</citation>
	    </citations>
    </xml>

    <!-- command -->
	
    <token name="@DOTNET@"><![CDATA[/home/stephan/Projects/tools/pisces/dotnet-runtime-2.0.0-linux-x64/dotnet]]></token> <!-- TODO remove -->
    <token name="@PISCES@"><![CDATA[/home/stephan/Projects/tools/pisces/Pisces_@TOOL_VERSION@/Pisces.dll]]></token> <!-- TODO remove --> 
    <token name="@CREATEGENOMESIZEFILE@"><![CDATA[/home/stephan/Projects/tools/pisces/CreateGenomeSizeFile_@TOOL_VERSION@/CreateGenomeSizeFile.dll]]></token> <!-- TODO remove -->


    <token name="@GENOMESIZE@"><![CDATA[
## process genome to create GenomeSize.xml
mkdir genome &&
ln -s '$genome' 'genome/genome.fasta' &&
@DOTNET@ @CREATEGENOMESIZEFILE@ ## TODO
-g 'genome/' ## folder, '/' required
-s '$genome_description' &&
    ]]></token>

    <token name="@BAM@"><![CDATA[
## process samples
mkdir data &&
#for $i, $current in enumerate($b)
    ln -s '${current}' 'data/sample_${i}.bam' && ## TODO name pattern?
    ln -s '${current.metadata.bam_index}' 'data/sample_${i}.bam.bai' &&
#end for
    ]]></token>



    <!-- 
        configfile - parser cannot handle indents
    -->
	
    <!--
        input 
    -->    

    <xml name="gender">
		<param argument="--gender" type="select" label="Select gender of the sample">
		    <option value="" selected="true">No</option>
		    <option value="true">Male</option>
		    <option value="false">Female</option>
		</param>
    </xml>

    <xml name="vcf">
		<param argument="--vcf" type="data" format="vcf" multiple="true" label="Select input file"/>
    </xml>



    <!--
        output 
    -->

    <!--
        Help
    -->

    <token name="@WID@">
    </token>

    <token name="@REFERENCES@"><![CDATA[
More information are available on `GitHub <https://github.com/Illumina/Pisces/>`_ and in the `user guide <https://github.com/Illumina/Pisces/wiki>`_.
    ]]></token>
</macros>