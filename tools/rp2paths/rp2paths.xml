<tool id="rp2paths" name="RP2paths" version="@TOOL_VERSION@" profile="21.09">
    <description>Enumerate and seperate the different pathways generated by RetroPath2.0</description>
    <macros>
        <token name="@TOOL_VERSION@">1.5.1</token>
    </macros>
    <requirements>
        <requirement type="package" version="@TOOL_VERSION@">rp2paths</requirement>
    </requirements>
    <stdio>
        <regex match="TIMEOUT:" level="fatal" />
        <regex match="ERROR:"   level="fatal" />
        <regex match="WARNING:" level="warning" />
    </stdio>
    <command detect_errors="exit_code"><![CDATA[
        mkdir out &&
        python -m rp2paths all
        '$rp2_pathways'
        --outdir out
        --timeout '$adv.timeout' &&
        cp out/compounds.txt '$compounds' &&
        if test -f 'out/out_paths.csv'; then
            cp out/out_paths.csv '$master_pathways';
        fi
    ]]></command>
    <inputs>
        <param name="rp2_pathways" type="data" format="csv" label="RetroPath2.0 Pathways" help="Retrosynthesis network CSV file outputted by the RetroPath2 tool which desribes the network linking the targeted compound to the chassis."/>
        <section name="adv" title="Advanced Options" expanded="false">
            <param name="timeout" type="integer" value="1800" label="Time Out" help="Time out before killing a process (in seconds), default: 30 minutes." />
        </section>
    </inputs>
    <outputs>
        <data name="master_pathways" format="csv" label="${tool.name} on ${rp2_pathways.name} : Enumerated Pathways" />
        <data name="compounds" format="tabular" label="${tool.name} on ${rp2_pathways.name} : Compounds" />
    </outputs>
    <tests>
        <test>
            <!-- test 1: check if identical outputs are produced with default parameters  -->
            <param name="rp2_pathways" value="retropath2_pathways.csv" />
            <output name="master_pathways" file="rp2paths_pathways.csv" ftype="csv" compare="diff"/>
            <output name="compounds" file="rp2paths_compounds.tsv" ftype="tabular" compare="diff"/>
        </test>
    </tests>
    <help><![CDATA[
RP2paths
========


**RP2paths** extracts the set of heterologous pathways that lies in a metabolic space file outputted by the "RetroPath2.0 workflow" into individual pathways and enumerate them.
This analysis is required to ensure that only pathways fulfilling all the precursor needs are retained for further analysis.
This tool takes as input a retrosynthesis network in the CSV file produced by `RetroPath2.0 <https://toolshed.g2.bx.psu.edu/view/tduigou/retropath2/9c8ac9980bd6>`_ ,
and outputs the enumerated pathways (using `EC numbers <https://en.wikipedia.org/wiki/Enzyme_Commission_number>`_ ) as well as the structure of involved chemicals (as SMILES: Simplified Molecular-Input Line-Entry System) in TSV format.


An example of **enumerated pathways** is illustred in the figure below for the production of a target molecule: `Styrene <https://en.wikipedia.org/wiki/Styrene>`_. **Compounds** are represented by their structures, and **reactions** by their `EC numbers <https://en.wikipedia.org/wiki/Enzyme_Commission_number>`_.


.. image:: ${static_path}/images/enumerated_pathways.png
    :width: 40 %
    :align: center

|

Input
-----

Required information:

* **RetroPath2.0 Pathways**\ : Retrosynthesis network CSV file outputted by the RetroPath2 tool which desribes the network linking the targeted compound to the chassis.

Advanced options:

* **Time Out**\ : (integer) Timeout before killing a process (in seconds), default: 30 minutes.

Output
------

* **Enumerated Pathways**\ : Describes all the indiviudal enumerated pathways that produce the compound of interest.
* **Compounds**\ : Describes the structure of all the chemical species involved in all pathways as SMILES (Simplified Molecular-Input Line-Entry System).

Project Links
---------------------

* `GitHub <https://github.com/brsynth/rp2paths>`_

License
-------

`MIT <https://github.com/brsynth/rp2paths/blob/master/LICENSE.md>`_

Acknowledgments
---------------

* Joan HÃ©risson

    ]]></help>
    <citations>
        <citation type="doi">10.1016/j.ymben.2017.12.002</citation>
    </citations>
</tool>
