<tool id="hicexplorer_hicfindtads" name="@BINARY@" version="@WRAPPER_VERSION@.0">
    <description>identify TAD boundaries by computing the degree of separation of each Hi-C matrix bin</description>
    <macros>
        <token name="@BINARY@">findRestSite</token>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <command detect_errors="exit_code"><![CDATA[
        @BINARY@
            --fasta $fasta 
            --searchPattern $searchPattern
            --outFile restriction_site.bed

    ]]></command>
    <inputs>
        <param argument="--fasta" type="data" format='fasta'
                        label="Fasta file for the organism genome."
                        help="The organism genome fasta file to compute the restriction enzyme position."/>
        <param argument="--searchPattern" type="text" value=""
                label="Restriction enzyme sequence"
                help='Search pattern. For example, for HindIII this pattern is \"AAGCTT\". 
                    Both, forward and reverse strand are searched for a match. The pattern 
                    is a regexp and can contain regexp specif syntax 
                    (see https://docs.python.org/2/library/re.html). For example the pattern
                    CG..GC will find all occurrence of CG followed by any two bases and then GC.'/>       
    </inputs>
    <outputs>

        <data name="restrictionSites" from_work_dir="restriction_site.bed" format="bed" label="${tool.name} on ${fasta.name} ${searchPattern} [${on_string}]: Restriction sites"/>
    
    </outputs>
    <tests>
        <test>
            <param name="fasta" value="hicFindRestrictionSites/reference_genome.fasta"/>

            <param name="searchPattern" value="GTAC"/>
            
            <output name="restrictionSites" file="hicFindRestrictionSites/restriction_sites.bed" ftype="bed" compare="sim_size"/>
        </test>
    </tests>
    <help><![CDATA[

Find restriction sites
======================================

This scripts find the locations of a given restriction enzyme sequence. This file can be used to build an Hi-C interaction matrix with restriction enzyme resolution by hicBuildMatrix.


For more information about HiCExplorer please consider our documentation on readthedocs.io_

.. _readthedocs.io: http://hicexplorer.readthedocs.io/en/latest/index.html
]]></help>
    <expand macro="citations" />
</tool>
