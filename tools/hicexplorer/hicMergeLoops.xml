<tool id="hicexplorer_hicmergeloops" name="@BINARY@" version="@WRAPPER_VERSION@.0">
    <description>merge detected loops of different resolutions.</description>
    <macros>
        <token name="@BINARY@">hicMergeLoops</token>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <command detect_errors="exit_code"><![CDATA[
        #for $counter, $loopfile in enumerate($inputFiles):
            ln -s '$loopfile' ${counter}_loop_file.bedgraph &&
        #end for
        #set $m = '" "'.join([ '%s_loop_file.bedgraph' % $counter for $counter, $inputfile in enumerate($inputFiles) ])
       
        @BINARY@
            --inputFiles "$m"
            --lowestResolution $lowestResolution
            --outFileName merged_loops.bedgraph
    ]]></command>
    <inputs>
        <param argument="--inputFiles" type="data" format='bed'
                        label="Loop files to merge"
                        help="The loop files from hicDetectLoops. To use files from other sources, 
                                please follow \'chr start end chr start end\' format and remove any header." multiple="true" />
        <param argument="--lowestResolution" type="integer" value=""
                label="Lowest used resolution"
                help='The lowest resolution of all loop files, i.e. 5kb, 10kb and 25kb, please use 25000.'/>       
    </inputs>
    <outputs>
        <data name="mergedLoops" from_work_dir="merged_loops.bedgraph" format="bed" label="${tool.name} on  [${on_string}]: Merged loops"/>
    </outputs>
    <tests>
        <test>
            <param name="inputFiles" ftype='bed' value="hicMergeLoops/gm12878_10kb.bedgraph,hicMergeLoops/gm12878_5kb.bedgraph,hicMergeLoops/gm12878_25kb.bedgraph"/>
            <param name="lowestResolution" value="25000"/>
            <output name="mergedLoops" file="hicMergeLoops/gm12878_all.bedgraph" ftype="bed" compare="sim_size" delta='40000'/>
        </test>
    </tests>
    <help><![CDATA[

Merge detected loops
====================

For more information about HiCExplorer please consider our documentation on readthedocs.io_

.. _readthedocs.io: http://hicexplorer.readthedocs.io/en/latest/index.html
]]></help>
    <expand macro="citations" />
</tool>
