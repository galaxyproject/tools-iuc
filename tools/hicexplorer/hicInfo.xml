<tool id="hicexplorer_hicinfo" name="@BINARY@" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@">
    <description>get information about the content of a Hi-C matrix</description>
    <macros>
        <token name="@BINARY@">hicInfo</token>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <command detect_errors="exit_code"><![CDATA[

        ln -s '$matrix_h5_cooler' 'matrix_name.$matrix_h5_cooler.ext' &&
        @BINARY@
        --matrices 'matrix_name.$matrix_h5_cooler.ext'
        -o hicInfo.txt
]]>
    </command>
    <inputs>
        <expand macro='matrix_h5_cooler_macro' />
    </inputs>
    <outputs>
        <data name="info" from_work_dir="hicInfo.txt" format="txt" label="${tool.name} on ${matrix_h5_cooler.name} [${on_string}]: matrix info" />
    </outputs>
    <tests>
        <test>
            <param name="matrix_h5_cooler" value="small_test_matrix.h5" />
            <output name="info" file="hicInfo/hicInfo_output.txt" ftype="txt" lines_diff="3" />
        </test>
    </tests>
    <help><![CDATA[

Get information about you Hi-C matrix
=====================================

This scripts returns useful information about your Hi-C interaction matrix. However, the following information can be included if it is provided by the Hi-C interaction matrix meta data. In case the meta data is missing, the information can be less.

.. code-block:: text

    # Matrix information file. Created with HiCExplorer's hicInfo version 3.2-dev
    File:	/tmp/tmpyyll1kwi.cool
    Date:	2019-08-11T19:46:15.959678
    Genome assembly:	dm3
    Size:	33,754
    Bin_length:	5000
    Number of chromosomes:	15
    Non-zero elements:	35,857
    The following columns are available: ['chrom' 'start' 'end']


    Generated by:	HiCMatrix-11-dev
    Cooler library version:	cooler-0.8.5
    HiCMatrix url:	https://github.com/deeptools/HiCMatrix
    Interaction matrix created with:	HiCExplorer-3.2-dev
    URL:	https://github.com/deeptools/HiCExplorer


    Build statistics:

    File	/tmp/tmpyyll1kwi.cool
    Sequenced reads	99983
    Min rest. site distance	300
    Max library insert size	1000

    #	count	(percentage w.r.t. total sequenced reads)
    Pairs mappable, unique and high quality	52726	(52.73)
    Hi-C contacts	37321	(37.33)
    One mate unmapped	8777	(8.78)
    One mate not unique	3603	(3.60)
    Low mapping quality	34877	(34.88)

    #	count	(percentage w.r.t. mappable, unique and high quality pairs)
    dangling end	0	(0.00)
    self ligation (removed)	0	(0.00)
    One mate not close to rest site	0	(0.00)
    same fragment	15393	(29.19)
    self circle	0	(0.00)
    duplicated pairs	12	(0.02)

    #	count	(percentage w.r.t. total valid pairs used)
    inter chromosomal	5955	(15.96)
    Intra short range (< 20kb)	8853	(23.72)
    Intra long range (>= 20kb)	22513	(60.32)
    Read pair type: inward pairs	7145	(19.14)
    Read pair type: outward pairs	9731	(26.07)
    Read pair type: left pairs	7156	(19.17)
    Read pair type: right pairs	7334	(19.65)


Please have in mind that the provided information depends on the tool and its version with which the matrix was created.

| For more information about HiCExplorer please consider our documentation on readthedocs.io_

.. _readthedocs.io: http://hicexplorer.readthedocs.io/en/latest/index.html
]]>    </help>
    <expand macro="citations" />
</tool>
