<tool id="r-upsetr" name="UpSetR" version="@VERSION@.0">
    <description>visualize set intersections</description>
     <macros>
        <token name="@VERSION@">1.0.3</token>
    </macros>

    <requirements>
        <requirement type="package" version="@VERSION@">r-upsetr</requirement>
    </requirements>

    <command detect_errors="exit_code"><![CDATA[
        Rscript '$script'
    ]]></command>

    <configfiles>
        <configfile name="script"><![CDATA[
## Setup R error handling to go to stderr
options(show.error.messages=F, error=function(){cat(geterrmessage(),file=stderr());q("no",1,F)})
loc <- Sys.setlocale("LC_MESSAGES", "en_US.UTF-8")

## Import library
library("UpSetR")

## List Input

l <- list()
#for $i in $list_input
    l <- append(l, "${i.input2}")
#end for
l <- lapply(l, function(x){x <- as.numeric(unlist(strsplit(x, ",")))})
names(l) <- c("one", "two", "three")
png("$output")
upset(fromList(l), order.by = "freq")
dev.off()





        ]]></configfile>
    </configfiles>

    <inputs>
        <param name="input" type="data" format="txt" label="A list of named vectors to be converted to a data frame" help="Enter named lists in a file each separted by a line. No spaces in list names, use underscore instead. The name of the list is followed by a colon and elements seperated are by a comma. e.g. List1: 1, 2, 3, 4, 5" />

        <repeat name="list_input" title="List Input">
            <param name="input2" type="text" />
        </repeat>
    </inputs>

    <outputs>
        
        <data name="output" format="png" />
        
    </outputs>

    <tests>
        <test>
        
          
            
        </test>
    </tests>

    <help><![CDATA[
        UpSetR generates static UpSet plots. The UpSet technique visualizes set intersections in a matrix layout and introduces aggregates based on groupings and queries. The matrix layout enables the effective representation of associated data, such as the number of elements in the aggregates and intersections, as well as additional summary statistics derived from subset or element attributes.
    ]]></help>

    <citations>
          <citation type="doi">/10.1093/bioinformatics/btx364</citation>
    </citations>

</tool>