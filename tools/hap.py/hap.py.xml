<tool id="hap.py" name="hap.py" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="20.01">
	<description>A tool to perform comparisons only based on chromosome, position, and allele identity for comparison of somatic callsets.</description>
	
	<macros>
		<token name="@TOOL_VERSION@">0.3.14</token>
		<token name="@VERSION_SUFFIX@">0</token>
	</macros>
	
	<requirements>
		<requirement type="package" version="@TOOL_VERSION@">hap.py</requirement>
	</requirements>
	
    <command detect_errors="exit_code"><![CDATA[
		export HGREF='$reference' && 
		samtools faidx '$reference' &&
        som.py
		'$truth'
		'$query'
		-r '$reference'
		-o 'happy' > results.tsv
        ]]>
	</command>
	
	<inputs>
		<param name="truth" type="data" format="vcf" label="ground truth variant calls"/>
		<param name="query" type="data" format="vcf" label="query variant calls"/>
		<param name="reference" argument="-r" type="data" format="fa,fasta,fna" label="reference genome"/>
	</inputs>
	
    <outputs>
		<data name="results" label="${tool.name} on ${on_string}" format="tabular"/>
    </outputs>
	
	<tests>
        <test expect_num_outputs="1">
            <param name="truth" value="small_NA12878-Freebayes-chr21.vcf"/>
            <param name="query" value="small_NA12878-GATK3-chr21.vcf"/>
			<param name="reference" value="chr21.fa"/>
            
			<output name="results" file="results.tsv"/>
        </test>
    </tests>

	<help><![CDATA[
		Hap.py is a tool to compare diploid genotypes at haplotype level.
		In this implementation of the tool comparisons are only based on chromosome,
		position, and allele identity. This comparison will not resolve haplotypes and
		only verify that the same alleles were observed at the same positions
		(e.g. for comparison of somatic callsets).
    ]]></help>

</tool>