<tool id="aegean_gaeval" name="GAEVAL" version="0.1.0" python_template_version="3.5">
  <description>- compute coverage and integrity scores for gene models using transcript alignments.</description>
  <requirements>
        <requirement type="package" version="0.16.0">aegean</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        gaeval '$input1' '$input2' 
	-a $alpha
	-b $beta
	-g $gamma
	-e $epsilon
	-c $expcds
	-5 $exp5putr
	-3 $exp3putr > '$output1'
    ]]></command>
    <inputs>
      <param type="data" name="alignmentGFF3file" label="Alignment GFF3 file" format="gff3" />
        <param type="data" name="genesGFF3file" label="Genes GFF3 file" format="gff3" />
	<!-- Weight options -->
	<section name="weights-for-calculating-integrity-score"
		 title="Weights for calculating integrity score"
		 expanded="False">
	<param type="float" name="alpha"
	       label="Introns confirmed, or % expected CDS lenght for single-exon genes (-a)"
	       value="0.6" min="0" max="1"
	       help="The percentage of introns confirmed by an alignment gap; for single-exon gene predictions lacking introns, it represents the ratio of the observed CDS length to the expected CDS length. "/>
	<param type="float" name="beta"
	       label="Exon coverage (-b)"
	       value="0.3" min="0" max="1"
	       help="Overall percentage of individual exons spanned by at least one sequencing read."/>
	<param type="float" name="gamma"
	       label="% expected 5' UTR length (-g)"
	       value="0.05" min="0" max="1"
	       help="The ratio of the observed 5’ UTR length to the expected 5’ UTR length."/>
	<param type="float" name="epsilon"
	       label="% expected 3' UTR lenght (-e)"
	       value="0.05" min="0" max="1"
	       help="The ratio of the observed 3’ UTR length to the expected 3’ UTR length."/>
	</section>

	<!-- Expected feature lenght options -->
	<section name="expected-feature-lenght"
		 title="Expected feature lenghts for calculating integrity score"
		 expanded="False">
	<param type="integer" name="expcds"
	       label="Expected CDs length (in bp) (-c)"
	       value="400" min="0" max="1000"/>
	<param type="integer" name="exp5putr"
	       label="Expected 5' UTR length (-5)"
	       value="200" min="0" max="1000"/>
	<param type="integer" name="exp3putr"
	       label="Expected 3' UTR length (-3)"
	       value="100" min="0" max="1000"/>
	</section>
    </inputs>
    <outputs>
        <data name="output1" format="txt" />
    </outputs>
    <tests>
        <test>
            <param name="input1" value="TAIR10_GFF3_alignment.gff"/>
            <param name="input2" value="TAIR10_GFF3_genes.gff"/>
            <output name="output1" file="gaeval_output.txt"/>
        </test>
    </tests>
    <help><![CDATA[
.. class:: infomark

**Purpose**

GAEVAL is a program for computing coverage and integrity scores for gene models using transcript alignments. The integrity score is a value between 0 and 1 that indicates the level of agreement between the gene model and any related transcript alignments, with 0 corresponding to no transcript support and 1 corresponding to complete transcript support.

-----

.. class:: infomark

**Input**

Input for GAEVAL is two GFF3 files, one containing gene predictions/annotations and one containing transcript alignments. Although the GFF3 Specification explicitly supports several similar encoding conventions for alignment features, only one is supported by GAEVAL, as shown below.

::

    ctg123 . cDNA_match 1050  1500  5.8e-42  +  . ID=match00001;Target=cdna0123 12 462
    ctg123 . cDNA_match 5000  5500  8.1e-43  +  . ID=match00001;Target=cdna0123 463 963
    ctg123 . cDNA_match 7000  9000  1.4e-40  +  . ID=match00001;Target=cdna0123 964 2964


GAEVAL will accept alignments with types cDNA_match, EST_match, and the generic nucleotide_match, depending on the source of the data.

The Target and Gap attributes are not disallowed by GAEVAL, but they are not interpreted by GAEVAL either. Gapped or spliced alignments must be encoded as multifeatures, with each segment of the alignment on its own distinct line and all segments of a single alignment sharing the same ID attribute.

-----

.. class:: infomark

**Output**

GAEVAL computes coverage and integrity scores for each mRNA feature in the gene prediction input. The output will be identical to the input, except that each mRNA feature will have two new attribtues: gaeval_coverage and gaeval_integrity.


    ]]></help>
    <citations>
        <citation type="bibtex">
@misc{githubAEGeAn,
  author = {Standage, Daniel S.},
  year = {2015},
  title = {AEGeAn},
  publisher = {GitHub},
  journal = {GitHub repository},
  url = {https://github.com/BrendelGroup/AEGeAn},
}</citation>
    </citations>
</tool>
