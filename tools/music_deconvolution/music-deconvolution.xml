<tool id="music-deconvolution" name="MuSiC" version="@GALAXY_VERSION@+@PACKAGE_VERSION@" python_template_version="3.5">
    <requirements>
        <requirement type="package" version="@PACKAGE_VERSION@" >music-deconvolution</requirement>
    </requirements>
    <macros>
        <token name="@GALAXY_VERSION@">0</token>
        <token name="@PACKAGE_VERSION@">0.1.1</token>
    </macros>
    <command detect_errors="exit_code"><![CDATA[




    ]]></command>
    <inputs>
        <param name="bulk_eset" label="Bulk RNA Dataset" type="data" format="rdata" />
        <param name="scrna_eset" label="scRNA Dataset" type="data" format="rdata" />

        <conditional name="purpose" >
            <param name="do" type="select" label="Purpose" >
                <option value="estprop">Estimate Proportions</option>
                <option value="dendrog">Compute Dendrogram</option>
            </param>
            <when value="estprop" >
                <param name="clusters_label" type="text" value="cellType"
                       label="Cluster Identifier from scRNA dataset" />
                <param name="samples_label" type="text" value="sampleID"
                       label="Samples Identifier from scRNA dataset" />
                <param name="celltypes" type="text" optional="true"
                       label="List of cell types to use" help="If NULL, then use all cell types." />
                <param name="methods" type="select" label="Cell Proportion Method" >
                    <option value="MuSiC" />
                    <option value="NNLS" />
                </param>
                <param name="phenotype_factors" type="text"
                       label="List of phenotypes factors" help="If NULL, then use all phenotypes." />
                <param name="phenotype_gene" type="text" label="Causative Gene"
                       help="MUST exist in the phenotype factors above." />
                <param name="sample_groups" type="text" label="List of Sample Groups" />
                <param name="sample_disease_group" type="text" label="Sample Disease Group"
                       help="MUST exist in the sample_groups above." />
                <param name="sample_disease_group_scale" type="integer"
                       label="Sample Disease Group (Scale)" value="5"
                       help="Used to accentutate certain features in the plots. Increase this number to reduce the effect."/>
                <param name="healthy_phenotype" type="text" label="Healthy Phenotype" value="Normal" />
                <param name="compare_title" type="text" label="Plot Title" value="" />
                <!-- more sophisticated jitter below -->
            </when>
            <when value="dendrog" >
                <!-- TODO! -->
            </when>
        </conditional>
    </inputs>
    <outputs>
        <data name="out_file" format="rdata" label="${tool.name} on ${on_string}: RData" />
        <data name="out_pdf" format="pdf" label="${tool.name} on ${on_string}: PDF Plots" />
    </outputs>
    <help><![CDATA[
        TODO: Fill in help.
    ]]></help>
</tool>