<macros>
    <token name="@TOOL_VERSION@">14.3</token>
    <token name="@VERSION_SUFFIX@">1</token>
    <token name="@PROFILE@">21.01</token>
    <token name="@LICENSE@">MIT</token>
    <token name="@PROFILE_AND_LICENSE@">profile="@PROFILE@" license="@LICENSE@"</token>
    <token name="@SETUP_CERTIFICATES@"><![CDATA[
## If running in container use certificate from ca-certificates instead of outdated / missing container certificates
[ -f /usr/local/ssl/cacert.pem ] && export SSL_CERT_FILE="/usr/local/ssl/cacert.pem";
        ]]></token>
    <xml name="requirements">
        <requirements>
            <requirement type="package" version="@TOOL_VERSION@">ncbi-datasets-cli</requirement>
            <requirement type="package" version="2022.9.24">ca-certificates</requirement>
            <requirement type="package" version="16.02">p7zip</requirement>
        </requirements>
    </xml>
    <xml name="annotation">
        <param argument="--annotated" type="boolean" truevalue="--annotated" falsevalue="" label="Only include genomes with annotation ?"/>
    </xml>
    <xml name="assembly_level">
        <param argument="--assembly-level" type="select" label="Restrict assemblies to a comma-separated list of one or more of these" multiple="true" optional="true">
            <option value="chromosome">Chromosome</option>
            <option value="complete">Complete Genome</option>
            <option value="contig">Contig</option>
            <option value="scaffold">Scaffold</option>
        </param>
    </xml>
    <xml name="assembly_source">
        <param argument="--assembly-source" type="select" optional="true" label="Assembly source" help="Default (nothing selected) is both " >
            <option value="refseq">RefSeq</option>
            <option value="genbank">GenBank</option>
        </param>
    </xml>
    <xml name="text_or_file" token_what="accession" token_what_extended="NCBI Assembly accession" token_help="Can be NCBI Assembly or BioProject accession">
        <conditional name="text_or_file" label="How do you want to specify the @WHAT@(s) to download">
            <param name="text_or_file" type="select" label="Enter @WHAT@ or read from file ?">
                <option value="text">Enter @WHAT@s</option>
                <option value="file">Read a list of @WHAT_EXTENDED@s from a dataset</option>
            </param>
            <when value="text">
                <param name="accession" type="text" label="Enter space separated list of @WHAT@s" help="@HELP@">
                    <yield/>
                </param>
            </when>
            <when value="file">
                <param argument="--inputfile" type="data" format="txt" label="Select dataset with list of @WHAT_EXTENDED@s" help="@HELP@"/>
            </when>
        </conditional>
    </xml>
    <xml name="chromosomes">
        <param argument="--chromosomes" type="text" label="Limit chromosomes to a comma-delimited list of chromosomes">
            <sanitizer invalid_char="">
                <valid initial="string.letters,string.digits">
                    <add value="_" />
                    <add value="." />
                    <add value="," />
                </valid>
            </sanitizer>
        </param>
    </xml>
    <xml name="include">
        <param argument="--include" type="select" multiple="true" optional="true">
            <option value="genome" selected="true">genomic sequence (genome)</option>
            <option value="rna">transcript (rna)</option>
            <option value="protein">amnio acid sequences (protein)</option>
            <option value="cds">nucleotide coding sequences (cds)</option>
            <option value="gff3">general feature file (gff3)</option>
            <option value="gtf">gene transfer format (gtf)</option>
            <option value="gbff">GenBank flat file (gbff)</option>
            <option value="seq-report">sequence report file (seq-report)</option>
        </param>
    </xml>
    <token name="@INCLUDE@"><![CDATA[
        --include
        #if $file_choices.include
            #echo ",".join($file_choices.include)
        #else
            none
        #end if
    ]]></token>

    <xml name="tsv_report_columns">
        <param name="report_columns" type="select" multiple="true" optional="false" label="Columns in the report">
            <option value="accession">accession</option>
            <option value="annotinfo-busco-complete">annotinfo-busco-complete</option>
            <option value="annotinfo-busco-duplicated">annotinfo-busco-duplicated</option>
            <option value="annotinfo-busco-fragmented">annotinfo-busco-fragmented</option>
            <option value="annotinfo-busco-lineage">annotinfo-busco-lineage</option>
            <option value="annotinfo-busco-missing">annotinfo-busco-missing</option>
            <option value="annotinfo-busco-singlecopy">annotinfo-busco-singlecopy</option>
            <option value="annotinfo-busco-totalcount">annotinfo-busco-totalcount</option>
            <option value="annotinfo-busco-ver">annotinfo-busco-ver</option>
            <option value="annotinfo-featcount-gene-non-coding">annotinfo-featcount-gene-non-coding</option>
            <option value="annotinfo-featcount-gene-other">annotinfo-featcount-gene-other</option>
            <option value="annotinfo-featcount-gene-protein-coding">annotinfo-featcount-gene-protein-coding</option>
            <option value="annotinfo-featcount-gene-pseudogene">annotinfo-featcount-gene-pseudogene</option>
            <option value="annotinfo-featcount-gene-total">annotinfo-featcount-gene-total</option>
            <option value="annotinfo-method">annotinfo-method</option>
            <option value="annotinfo-name">annotinfo-name</option>
            <option value="annotinfo-pipeline">annotinfo-pipeline</option>
            <option value="annotinfo-provider">annotinfo-provider</option>
            <option value="annotinfo-release-date">annotinfo-release-date</option>
            <option value="annotinfo-release-version">annotinfo-release-version</option>
            <option value="annotinfo-report-url">annotinfo-report-url</option>
            <option value="annotinfo-software-version">annotinfo-software-version</option>
            <option value="annotinfo-status">annotinfo-status</option>
            <option value="assminfo-atypicalis-atypical">assminfo-atypicalis-atypical</option>
            <option value="assminfo-atypicalwarnings">assminfo-atypicalwarnings</option>
            <option value="assminfo-bioproject-lineage-accession">assminfo-bioproject-lineage-accession</option>
            <option value="assminfo-bioproject-lineage-parent-accession">assminfo-bioproject-lineage-parent-accession</option>
            <option value="assminfo-bioproject-lineage-parent-accessions">assminfo-bioproject-lineage-parent-accessions</option>
            <option value="assminfo-bioproject-lineage-title">assminfo-bioproject-lineage-title</option>
            <option value="assminfo-biosample-accession">assminfo-biosample-accession</option>
            <option value="assminfo-biosample-attribute-name">assminfo-biosample-attribute-name</option>
            <option value="assminfo-biosample-attribute-value">assminfo-biosample-attribute-value</option>
            <option value="assminfo-biosample-bioproject-accession">assminfo-biosample-bioproject-accession</option>
            <option value="assminfo-biosample-bioproject-parent-accession">assminfo-biosample-bioproject-parent-accession</option>
            <option value="assminfo-biosample-bioproject-parent-accessions">assminfo-biosample-bioproject-parent-accessions</option>
            <option value="assminfo-biosample-bioproject-title">assminfo-biosample-bioproject-title</option>
            <option value="assminfo-biosample-description-comment">assminfo-biosample-description-comment</option>
            <option value="assminfo-biosample-description-organism-common-name">assminfo-biosample-description-organism-common-name</option>
            <option value="assminfo-biosample-description-organism-infraspecific-breed">assminfo-biosample-description-organism-infraspecific-breed</option>
            <option value="assminfo-biosample-description-organism-infraspecific-cultivar">assminfo-biosample-description-organism-infraspecific-cultivar</option>
            <option value="assminfo-biosample-description-organism-infraspecific-ecotype">assminfo-biosample-description-organism-infraspecific-ecotype</option>
            <option value="assminfo-biosample-description-organism-infraspecific-isolate">assminfo-biosample-description-organism-infraspecific-isolate</option>
            <option value="assminfo-biosample-description-organism-infraspecific-sex">assminfo-biosample-description-organism-infraspecific-sex</option>
            <option value="assminfo-biosample-description-organism-infraspecific-strain">assminfo-biosample-description-organism-infraspecific-strain</option>
            <option value="assminfo-biosample-description-organism-name">assminfo-biosample-description-organism-name</option>
            <option value="assminfo-biosample-description-organism-pangolin">assminfo-biosample-description-organism-pangolin</option>
            <option value="assminfo-biosample-description-organism-tax-id">assminfo-biosample-description-organism-tax-id</option>
            <option value="assminfo-biosample-description-title">assminfo-biosample-description-title</option>
            <option value="assminfo-biosample-ids-db">assminfo-biosample-ids-db</option>
            <option value="assminfo-biosample-ids-label">assminfo-biosample-ids-label</option>
            <option value="assminfo-biosample-ids-value">assminfo-biosample-ids-value</option>
            <option value="assminfo-biosample-last-updated">assminfo-biosample-last-updated</option>
            <option value="assminfo-biosample-models">assminfo-biosample-models</option>
            <option value="assminfo-biosample-owner-contact-lab">assminfo-biosample-owner-contact-lab</option>
            <option value="assminfo-biosample-owner-name">assminfo-biosample-owner-name</option>
            <option value="assminfo-biosample-package">assminfo-biosample-package</option>
            <option value="assminfo-biosample-publication-date">assminfo-biosample-publication-date</option>
            <option value="assminfo-biosample-status-status">assminfo-biosample-status-status</option>
            <option value="assminfo-biosample-status-when">assminfo-biosample-status-when</option>
            <option value="assminfo-biosample-submission-date">assminfo-biosample-submission-date</option>
            <option value="assminfo-blast-url">assminfo-blast-url</option>
            <option value="assminfo-description">assminfo-description</option>
            <option value="assminfo-level">assminfo-level</option>
            <option value="assminfo-linked-assmaccession">assminfo-linked-assmaccession</option>
            <option value="assminfo-linked-assmtype">assminfo-linked-assmtype</option>
            <option value="assminfo-name">assminfo-name</option>
            <option value="assminfo-paired-assmaccession">assminfo-paired-assmaccession</option>
            <option value="assminfo-paired-assmname">assminfo-paired-assmname</option>
            <option value="assminfo-paired-assmstatus">assminfo-paired-assmstatus</option>
            <option value="assminfo-refseq-category">assminfo-refseq-category</option>
            <option value="assminfo-sequencing-tech">assminfo-sequencing-tech</option>
            <option value="assminfo-status">assminfo-status</option>
            <option value="assminfo-submission-date">assminfo-submission-date</option>
            <option value="assminfo-submitter">assminfo-submitter</option>
            <option value="assminfo-synonym">assminfo-synonym</option>
            <option value="assminfo-type">assminfo-type</option>
            <option value="assmstats-contig-l50">assmstats-contig-l50</option>
            <option value="assmstats-contig-n50">assmstats-contig-n50</option>
            <option value="assmstats-gaps-between-scaffolds-count">assmstats-gaps-between-scaffolds-count</option>
            <option value="assmstats-gc-count">assmstats-gc-count</option>
            <option value="assmstats-gc-percent">assmstats-gc-percent</option>
            <option value="assmstats-number-of-component-sequences">assmstats-number-of-component-sequences</option>
            <option value="assmstats-number-of-contigs">assmstats-number-of-contigs</option>
            <option value="assmstats-number-of-scaffolds">assmstats-number-of-scaffolds</option>
            <option value="assmstats-scaffold-l50">assmstats-scaffold-l50</option>
            <option value="assmstats-scaffold-n50">assmstats-scaffold-n50</option>
            <option value="assmstats-total-number-of-chromosomes">assmstats-total-number-of-chromosomes</option>
            <option value="assmstats-total-sequence-len">assmstats-total-sequence-len</option>
            <option value="assmstats-total-ungapped-len">assmstats-total-ungapped-len</option>
            <option value="current-accession">current-accession</option>
            <option value="organelle-assembly-name">organelle-assembly-name</option>
            <option value="organelle-bioproject-accessions">organelle-bioproject-accessions</option>
            <option value="organelle-description">organelle-description</option>
            <option value="organelle-infraspecific-name">organelle-infraspecific-name</option>
            <option value="organelle-submitter">organelle-submitter</option>
            <option value="organelle-total-seq-length">organelle-total-seq-length</option>
            <option value="organism-common-name">organism-common-name</option>
            <option value="organism-infraspecific-breed">organism-infraspecific-breed</option>
            <option value="organism-infraspecific-cultivar">organism-infraspecific-cultivar</option>
            <option value="organism-infraspecific-ecotype">organism-infraspecific-ecotype</option>
            <option value="organism-infraspecific-isolate">organism-infraspecific-isolate</option>
            <option value="organism-infraspecific-sex">organism-infraspecific-sex</option>
            <option value="organism-infraspecific-strain">organism-infraspecific-strain</option>
            <option value="organism-name">organism-name</option>
            <option value="organism-pangolin">organism-pangolin</option>
            <option value="organism-tax-id">organism-tax-id</option>
            <option value="source_database">source_database</option>
            <option value="wgs-contigs-url">wgs-contigs-url</option>
            <option value="wgs-project-accession">wgs-project-accession</option>
            <option value="wgs-url">wgs-url</option>
            <yield/>
        </param>
    </xml>
    <xml name="released_options" token_released_what="genomes" token_before_or_after="before">
        <param argument="--released-@BEFORE_OR_AFTER@" type="text" optional="true" label="Only include @RELEASED_WHAT@ that have been released @BEFORE_OR_AFTER@ a specified date (MM/DD/YYYY)">
            <validator type="regex" message="enter a date in the form MM/DD/YYYY">[0-9]{2}/[0-9]{2}/[0-9]{4}</validator>
        </param>
    </xml>
    <token name="@RELEASED_BEFORE@">#if $filters.released_before:
--released-before '$filters.released_before'
#end if
    </token>
    <token name="@RELEASED_AFTER@">#if $filters.released_after:
--released-after '$filters.released_after'
#end if
    </token>

    <xml name="genome_fasta_assert" tokens="el1,el2,expression" token_expression_n="1">
        <element name="@EL1@">
            <element name="@EL2@">
                <assert_contents>
                    <has_text_matching expression="@EXPRESSION@" n="@EXPRESSION_N@"/>
                </assert_contents>
            </element>
        </element>
    </xml>
</macros>
