<tool id="spades" name="SPAdes" version="@TOOL_VERSION@+@WRAPPER_VERSION@">
    <description>@DESCRIPTION@ genomes of regular and single-cell projects</description>
    
    <macros>
        <import>macros.xml</import>
    </macros>

    <expand macro="requirements"/>

    <expand macro="stdio"/>

    <command detect_errors="exit_code"><![CDATA[
        ## run: spades
        spades.py
            ## files
            #for $i, $library in enumerate( $libraries, start=1)
                @LIBTYPE_SPADES-PLASMID-META-RNA@
                @LIBTYPE_SPADES-PLASMID@
                @FILETYPE_SPADES-PLASMID-META-RNA@
            #end for
            ## shared parameter
            @PARAM_ALL@ 
            @PARAM_SPADES-PLASMID@  
            @PARAM_SPADES-PLASMID-META@
            @PARAM_SPADES-PLASMID-RNA@
            @PARAM_SPADES-PLASMID-META-RNA@
            ## specific parameter
            $sc

        ## additional output:
        @OUTPUT_SPADES_PLASMID_META@
    ]]></command>

    <configfiles>
        <!-- parse config.fasta and scaffolds.fasta and create $out_configstats and $out_scaffoldstats -->
        <expand macro="config_script"/>
    </configfiles>

    <inputs>
        <!-- files -->
        <repeat name="libraries" min="1" max="9" title="Libraries" help="">
            <param name="libtype" type="select" label="Type" >
                <expand macro="in_libtype_spades_plasmid_meta_rna"/>
                <expand macro="in_libtype_spades_plasmid"/>
            </param>
            <expand macro="in_files"/>
        </repeat>
        <!-- shared parameter -->
        <expand macro="in_param_spades_plasmid_meta_rna"/>
        <expand macro="in_param_spades_plasmid"/>
        <expand macro="in_param_spades_plasmid_rna"/>
        <expand macro="in_param_spades_plasmid_meta"/>
        <!-- specific parameter -->
        <param argument="--sc" name="sc" type="boolean" truevalue="--sc" falsevalue="" label="MDA (single-cell) data" help="This option is required for MDA (single-cell) data."/>
        <!-- output options -->
        <section name="in_outoptions" title="Set optional outputs" expanded="false">
            <expand macro="in_outoptions_spades_plasmid_meta_rna"/>            
            <expand macro="in_outoptions_spades_plasmid_meta"/>
        </section>       
    </inputs>

    <outputs>
        <expand macro="out_spades_plasmid_meta"/>
        <expand macro="out_spades_plasmid_meta_rna"/>
    </outputs>
        
    <tests>
        <test>
            <expand macro="test_filetypes_spades" k="33" filetype="fastq" fileext="fq"/>        
        </test>   
        <test>
            <expand macro="test_filetypes_spades" k="33" filetype="fasta" fileext="fasta" />        
        </test>
        <test>
            <expand macro="test_filetypes_spades" k="33" filetype="fastq.gz" fileext="fq.gz"/>        
        </test>                
        <test>
            <expand macro="test_filetypes_spades" k="77" filetype="fastq" fileext="fq"/>        
        </test>          
        <test>
            <expand macro="test_filetypes_spades" filetype="fastq" fileext="fq"/>        
        </test>   
        <test>
            <expand macro="test_filetypes_spades" k="33" filetype="fastqsanger" fileext="fq"/>        
        </test>
        <test>
            <expand macro="test_filetypes_spades" k="33" filetype="fastqsanger.gz" fileext="fq.gz"/>        
        </test>
    </tests>

    <help><![CDATA[
.. class:: infomark

**What it does**

SPAdes – St. Petersburg genome assembler – is an assembly toolkit containing various assembly pipelines. 

More information can be found on the `project website <http://cab.spbu.ru/software/spades/>`_, in the `manual <http://cab.spbu.ru/files/release@TOOL_VERSION@/manual.html>`_ and on `github <https://github.com/ablab/spades>`_.

@HELP_ACKNOWLEDGMENTS@
    ]]></help>

    <expand macro="citations"/>
</tool>