<macros>
    <xml name="requirements">
        <requirements>
            <requirement type="package" version="@TOOL_VERSION@">cactus</requirement>
        </requirements>
    </xml>
    <token name="@TOOL_VERSION@">2.9.9</token>
    <token name="@VERSION_SUFFIX@">0</token>
    <token name="@PROFILE@">25.1</token>
    <token name="@UNCOMPRESS_PAF@"><![CDATA[
        #if $input_paf.is_of_type('paf.gz')
            gunzip -c '$input_paf' |
        #else
            cat '$input_paf' |
        #end if
        ]]>
    </token>
    <token name="@COMPRESS_PAF@"><![CDATA[
        #if $compression.type == 'gz'
            | gzip -c > '$out_file'
        #else
            > '$out_file'
        #end if
        ]]>
    </token>
    <token name="@UNCOMPRESS_FASTA@"><![CDATA[
        #for $i, $fasta_file in enumerate($input_fasta):
            #set $temp_input = "input_%s.fasta" % $i
            #if $fasta_file.is_of_type('fasta.gz')
                gunzip -c '$fasta_file' > '$temp_input' &&
            #else if $fasta_file.is_of_type('fasta.bz2')
                bunzip2 -c '$fasta_file' > '$temp_input' &&
            #else
                ln -s '$fasta_file' '$temp_input' &&
            #end if
        #end for
        ]]>
    </token>
    <token name="@LOOP_UNCOMPRESS_FASTA@"><![CDATA[
        #for $i, $fasta_file in enumerate($input_fasta):
            'input_${i}.fasta'
        #end for
        ]]>
    </token>
    <token name="@COMPRESS_FASTA@"><![CDATA[
        #if $compression.type == 'gz':
            | gzip -c > '$out_file'
        #else if $compression.type == 'bz2':
            | bzip2 -c > '$out_file'
        #else:
            > '$out_file'
        #end if
        ]]>
    </token>
    <xml name="stdio">
        <stdio>
            <!-- Anything other than zero is an error -->
            <exit_code range="1:"/>
            <exit_code range=":-1"/>
            <!-- In case the return code has not been set properly check stderr too -->
            <regex source="stderr"  match="Error:"/>
            <regex source="stderr"  match="Exception:"/>
        </stdio>
    </xml>
    <xml name="input_paf">
        <param name="input_paf" type="data" format="paf,paf.gz" label="PAF file"/>
    </xml>
    <xml name="params_fastaList">
        <param name="input_fasta" type="data" format="fasta,fasta.gz,fasta.bz2" multiple="true" label="FASTA file(s)"/>      
    </xml>
    <xml name="params_trimFraction">
        <param argument="--trimFraction" type="float" min="0" value="1" max="1" label="Trim fraction" help="Fraction of aligned bases to trim from each end of the alignment"/>   
    </xml>
    <xml name="params_conditional_compression">	
        <conditional name="compression">
            <param name="type" type="select" label="Compress output">
                <option value="" selected="true">Don't compress output (default)</option>
                <option value="gz">Compress output to .gz</option>
            </param>
            <when value=""/>
            <when value="gz"/>
        </conditional>
    </xml> 
    <xml name="params_conditional_compression_fasta">	
        <conditional name="compression">
            <param name="type" type="select" label="Compress output">
                <option value="" selected="true">Don't compress output (default)</option>
                <option value="gz">Compress output to .gz</option>
                <option value="bz2">Compress output to .bz2</option>
            </param>
            <when value=""/>
            <when value="gz"/>
            <when value="bz2"/>
        </conditional>
    </xml> 
    <xml name="creator">
        <creator>
            <person givenName="Niklas" familyName="Mayle" url="https://github.com/Maed0x"/>
            <person givenName="Saim" familyName="Momin" url="https://github.com/SaimMomin12"/>
            <organization name="Galaxy Europe" url="https://galaxyproject.org/eu/"/>
        </creator>
    </xml>
    <xml name="citation">
        <citations>
                <citation type="bibtex">
                @misc{githubpaffy,
                author = {Glenn Hickey, Benedict Paten, Mark Diekhans, Adam Novak},
                year = {},
                title = {paffy},
                publisher = {GitHub},
                journal = {GitHub repository},
                url = {https://github.com/ComparativeGenomicsToolkit/paffy},
                }</citation>
                <citation type="doi">10.1038/s41586-020-2871-y</citation>
        </citations>
    </xml>
</macros>