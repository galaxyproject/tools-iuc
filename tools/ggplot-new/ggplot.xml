<tool id="ggplot-new" name="new ggplot with uber cool features" version="@VERSION_SCRIPT@+@VERSION_WRAPPER@" >
    <description>New ggplot update, change this description</description>
    <macros>
        <token name="@VERSION_SCRIPT@">0.1</token>
        <token name="@VERSION_WRAPPER@">1</token>
        <!-- Common Conditionals -->
        <macro name="conditional_ordering" >
            <conditional name="ordering" >
                <param name="use" type="select" label="Ordered" >
                    <option value="ordered">Yes</option>
                    <option value="notordered">No</option>
                </param>
                <yield />
            </conditional>
        </macro>
        <import>macros_option_text.xml</import>
        <import>macros_chart_parameters.xml</import>
        <import>macros_plots_numeric.xml</import>
    </macros>
    <version_command><![CDATA[
Rscript '$__tool_directory__/scripts/make_charts.R' --version
]]>
    </version_command>
    <command detect_errors="exit_code"><![CDATA[
Rscript '$__tool_directory__/scripts/make_charts.R '$userconf'
    ]]></command>
    <configfiles>
        <configfile name="userconf" ><![CDATA[
## WE WILL FILL THIS IN LATER

]]>
        </configfile>
    </configfiles>
    <inputs>
        <param name="input" type="data" format="tabular" label="Data Set" />
        <repeat name="layers" title="Plot Layer">
            <conditional name="hierarchy" >
                <param name="use" type="select" label="By" >
                    <option value="flat" >Name</option>
                    <option value="compatibility" >Compatibility</option>
                    <option value="guided">Guided Search</option>
                </param>
                <when value="flat" >
                    <conditional name="chart" >
                        <param name="use" type="select" label="Search" >
                            <expand macro="option_2ddensityplot" />
                            <expand macro="option_3dscatterorsurface" />
                            <expand macro="option_abline" />
                            <expand macro="option_areaplot" />
                            <expand macro="option_barchart" />
                            <expand macro="option_bin2d" />
                            <expand macro="option_boxplot" />
                            <expand macro="option_bubbleplot" />
                            <expand macro="option_connectedscatterplot" />
                            <expand macro="option_correlogram" />
                            <expand macro="option_dendrogram" />
                            <expand macro="option_densityplot" />
                            <expand macro="option_heatmap" />
                            <expand macro="option_histogram" />
                            <expand macro="option_lineplot" />
                            <expand macro="option_pca" />
                            <expand macro="option_ridgeline" />
                            <expand macro="option_scatterandmarginalplot" />
                            <expand macro="option_scatterplot" />
                            <expand macro="option_stackedareaplot" />
                            <expand macro="option_streamgraph" />
                            <expand macro="option_violinplot" />
                        </param>
                        <expand macro="when_2ddensityplot_params" />
                        <expand macro="when_3dscatterorsurface_params" />
                        <expand macro="when_abline_params" />
                        <expand macro="when_areaplot_params" />
                        <expand macro="when_barchart_params" />
                        <expand macro="when_bin2d_params" />
                        <expand macro="when_boxplot_params" />
                        <expand macro="when_bubbleplot_params" />
                        <expand macro="when_connectedscatterplot_params" />
                        <expand macro="when_correlogram_params" />
                        <expand macro="when_dendrogram_params" />
                        <expand macro="when_densityplot_params" />
                        <expand macro="when_heatmap_params" />
                        <expand macro="when_histogram_params" />
                        <expand macro="when_lineplot_params" />
                        <expand macro="when_pca_params" />
                        <expand macro="when_ridgeline_params" />
                        <expand macro="when_scatterandmarginalplot_params" />
                        <expand macro="when_scatterplot_params" />
                        <expand macro="when_stackedareaplot_params" />
                        <expand macro="when_streamgraph_params" />
                        <expand macro="when_violinplot_params" />
                    </conditional>
                </when>
                <when value="compatibility" />
                <when value="guided" >
                    <conditional name="chart_type" >
                        <param name="use" type="select" label="Chart Type">
                            <option value="numeric">Numeric</option>
                            <option value="categoric">Categoric</option>
                            <option value="numandcat">Numeric and Categoric</option>
                            <option value="maps">Maps</option>
                            <option value="network">Network</option>
                            <option value="time">Time Series</option>
                        </param>
                        <when value="numeric" >
                            <conditional name="decision_level_1" >
                                <param name="use" type="select" label="Numeric Type">
                                    <option value="one_vars">One Numeric Variable</option>
                                    <option value="two_vars">Two Numeric Variables</option>
                                    <option value="three_vars">Three Numeric Variables</option>
                                    <option value="many_vars">Several Numeric Variables</option>
                                </param>
                                <when value="one_vars" >
                                    <expand macro="numeric_one_macro" />
                                </when>
                                <when value="two_vars">
                                    <expand macro="conditional_ordering" >
                                        <when value="notordered" >
                                            <conditional name="many_or_few" >
                                                <param name="use" type="select" label="Points" >
                                                    <option value="few">Few</option>
                                                    <option value="many">Many</option>
                                                </param>
                                                <when value="few">
                                                    <expand macro="numeric_two_notordered_few_macro" />
                                                </when>
                                                <when value="many">
                                                    <expand macro="numeric_two_notordered_many_macro" />
                                                </when>
                                            </conditional>
                                        </when>
                                        <when value="ordered" >
                                            <expand macro="numeric_two_ordered_macro" />
                                        </when>
                                    </expand>
                                </when>
                                <when value="three_vars" >
                                    <expand macro="conditional_ordering" >
                                        <when value="notordered" >
                                            <expand macro="numeric_three_notordered" />
                                        </when>
                                        <when value="ordered" >
                                            <expand macro="numeric_three_or_many_ordered" />
                                        </when>
                                    </expand>
                                </when>
                                <when value="many_vars" >
                                    <expand macro="conditional_ordering" >
                                        <when value="ordered" >
                                            <!-- Yes this is a duplicate of the previous plots -->
                                            <expand macro="numeric_three_or_many_ordered" />
                                        </when>
                                        <when value="notordered" >
                                            <expand macro="numeric_many_notordered" />
                                        </when>
                                    </expand>
                                </when>
                            </conditional>
                        </when>
                        <!-- TODO: -->
                        <when value="categoric" />
                        <when value="numandcat" />
                        <when value="maps" />
                        <when value="network" />
                        <when value="time" />
                    </conditional>
                </when>
            </conditional>
        </repeat>
    </inputs>
    <outputs>
        <data name="outpng" format="png" label="${tool.name} on ${on_string}: PNG" />
    </outputs>
    <tests>
        <test>
        </test>
    </tests>
    <help><![CDATA[

This is the new GGplot tool that we will update later

]]>
    </help>
    <citations>
    </citations>
</tool>
