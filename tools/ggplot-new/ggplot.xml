<tool id="ggplot-new" name="new ggplot with uber cool features" version="@VERSION_SCRIPT@+@VERSION_WRAPPER@" >
    <description>New ggplot update, change this description</description>
    <macros>
        <!-- Common Conditionals -->
        <macro name="conditional_ordering" >
            <conditional name="ordering" >
                <param name="use" type="select" label="Ordered" >
                    <option value="ordered">Yes</option>
                    <option value="notordered">No</option>
                </param>
                <yield />
            </conditional>
        </macro>
        <import>macros_option_text.xml</import>
        <import>macros_chart_parameters.xml</import>
        <import>macros_plots_numeric.xml</import>        
    </macros>
    <version_command><![CDATA[
Rscript '$__tool_directory__/scripts/make_charts.R' --version
]]>
    </version_command>
    <command detect_errors="exit_code"><![CDATA[
Rscript '$__tool_directory__/scripts/make_charts.R '$userconf'
    ]]></command>
    <configfiles>
        <configfile name="userconf" ><![CDATA[
## WE WILL FILL THIS IN LATER

dplot = formals(dotplot)

## dplot$x
## dplot$y

#if $series.chart_type.chart == "dotplot":
dplot$x = $series.chart_type.adv_param1
dplot$y = $series.chart_type.adv_param1
#end if




]]>
        </configfile>
    </configfiles>
    <inputs>
        <param name="input" type="data" format="tabular" label="Data Set" />
        <repeat name="layers" title="Plot Layer">
            <conditional name="chart_type" >
                <param name="use" type="select" label="Chart Type">
                    <option value="numeric">Numeric</option>
                    <option value="categoric">Categoric</option>
                    <option value="numandcat">Numeric and Categoric</option>
                    <option value="maps">Maps</option>
                    <option value="network">Network</option>
                    <option value="time">Time Series</option>
                </param>
                <when value="numeric" >
                    <conditional name="decision_level_1" >
                        <param name="use" type="select" label="Numeric Type">
                            <option value="one_vars">One Numeric Variable</option>
                            <option value="two_vars">Two Numeric Variables</option>
                            <option value="three_vars">Three Numeric Variables</option>
                            <option value="many_vars">Several Numeric Variables</option>
                        </param>
                        <when value="one_vars" >
                            <expand macro="numeric_one_macro" />
                        </when>
                        <when value="two_vars">
                            <expand macro="conditional_ordering" >
                                <when value="notordered" >
                                    <conditional name="many_or_few" >
                                        <param name="use" type="select" label="Points" >
                                            <option value="few">Few</option>
                                            <option value="many">Many</option>
                                        </param>
                                        <when value="few">
                                            <expand macro="numeric_two_notordered_few_macro" />
                                        </when>
                                        <when value="many">
                                            <expand macro="numeric_two_notordered_many_macro" />
                                        </when>
                                    </conditional>
                                </when>
                                <when value="ordered" >
                                    <expand macro="numeric_two_ordered_macro" />
                                </when>
                            </expand>
                        </when>
                        <when value="three_vars" >
                            <expand macro="conditional_ordering" >
                                <when value="notordered" >
                                    <expand macro="numeric_three_notordered" />
                                </when>
                                <when value="ordered" >
                                    <expand macro="numeric_three_or_many_ordered" />
                                </when>
                            </expand>
                        </when>
                        <when value="many_vars" >
                            <expand macro="conditional_ordering" >
                                <when value="ordered" >
                                    <!-- Yes this is a duplicate of the previous plots -->
                                    <expand macro="numeric_three_or_many_ordered" />
                                </when>
                                <when value="notordered" >
                                    <expand macro="numeric_many_notordered" />
                                </when>                                    
                            </expand>
                        </when>
                    </conditional>
                </when>
                <!-- TODO: -->
                <when value="categoric" />
                <when value="numandcat" />
                <when value="maps" />
                <when value="network" />
                <when value="time" />
            </conditional>
        </repeat>
    </inputs>
    <outputs>
        <data name="outpng" format="png" label="${tool.name} on ${on_string}: PNG" />
    </outputs>
    <tests>
        <test>
        </test>
    </tests>
    <help><![CDATA[

This is the new GGplot tool that we will update later

]]>
    </help>
    <citations>
    </citations>
</tool>
