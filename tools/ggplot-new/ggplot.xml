<tool id="ggplot2" name="Plotting Tool" version="@VERSION_SCRIPT@+@VERSION_WRAPPER@" >
    <description>with ggplot2</description>
    <macros>
        <token name="@VERSION_SCRIPT@">0.1</token>
        <token name="@VERSION_WRAPPER@">1</token>
        <!-- Common Conditionals -->
        <macro name="conditional_ordering" >
            <conditional name="ordering" >
                <param name="use" type="select" label="Ordering" >
                    <option value="ordered">Ordered</option>
                    <option value="notordered">Unordered</option>
                </param>
                <yield />
            </conditional>
        </macro>
        <macro name="headerselection_macro" >
            <!-- TODO: Subselect columns -->
        </macro>
        <import>macros_aesthetics.xml</import>
        <import>macros_hierarchy_flat.xml</import>
        <import>macros_hierarchy_compatibility.xml</import>
        <import>macros_hierarchy_guided.xml</import>
    </macros>
    <version_command><![CDATA[
Rscript '$__tool_directory__/scripts/make_charts.R' --version
]]>
    </version_command>
    <command detect_errors="exit_code"><![CDATA[
Rscript '$__tool_directory__/scripts/make_charts.R '$userconf'
    ]]></command>
    <configfiles>
        <configfile name="userconf" ><![CDATA[
## WE WILL FILL THIS IN LATER

area.params = formals(areaplot)
#if user.selects.chart == "area":
    area.params$stat = $hierarchy.flat.chart.start
    area.param$stat = $flathierarchy.start


]]>
        </configfile>
    </configfiles>
    <inputs>
        <param name="input" type="data" format="tabular" label="Data Set" />
        <param name="headers" type="boolean" checked="no" label="File has header line?"  />
        <repeat name="layers" title="Plot Layer" min="1">
            <conditional name="hierarchy" >
                <param name="use" type="select" label="By" >
                    <option value="flat" >Name</option>
                    <option value="compatibility" >Compatibility</option>
                    <option value="guided">Guided Search</option>
                </param>
                <expand macro="when_hierarchy_flat_macro" />
                <expand macro="when_hierarchy_compatibility_macro" />
                <expand macro="when_hierarchy_guided_macro" />
            </conditional>
            <expand macro="headerselection_macro" />
            <expand macro="aesthetics_macro" />
        </repeat>
    </inputs>
    <outputs>
        <data name="outpng" format="png" label="${tool.name} on ${on_string}: PNG" />
    </outputs>
    <tests>
        <test>
        </test>
    </tests>
    <help><![CDATA[

This is the new GGplot tool that we will update later

]]>
    </help>
    <citations>
    </citations>
</tool>
