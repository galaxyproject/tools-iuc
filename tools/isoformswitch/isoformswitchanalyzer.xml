<tool id="isoformswitchanalyzer" name="IsoformSwitchAnalyzeR" version="@TOOL_VERSION@+galaxy@SUFFIX_VERSION@">
    <description>statistical identification of isoform switching</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro='requirements'/>
    <expand macro='xrefs'/>
    <stdio>
        <regex match="Execution halted"
           source="both"
           level="fatal"
           description="Execution halted." />
        <regex match="Error in"
           source="both"
           level="fatal"
           description="An undefined error occurred, please check your input carefully and contact your administrator." />
        <regex match="Fatal error"
           source="both"
           level="fatal"
           description="An undefined error occurred, please check your input carefully and contact your administrator." />
    </stdio>
    <command><![CDATA[
Rscript '${__tool_directory__}/IsoformSwitchAnalyzerR.R'

]]></command>
    <inputs>
    <conditional name="function_mode">
        <param name="selector" type="select" label="Tool function mode" 
            help="The first step of a IsoformSwitchAnalyzeR workflow is to import and integrate the isoform quantification 
                with its basic annotation. Once you have all the relevant data imported into R (IsoformSwitchAnalyzeR will 
                also help you with that), the workflow for identification and analysis of isoform switches with functional 
                consequences can be divided into two parts.">
            <option value="data_import">Analysis part 1: Import data</option>
            <option value="first_step">Analysis part 2: Extract isoform switches and their sequences</option>
            <option value="second_step">Analysis part 3: Plot all isoform switches and their annotation</option>
        </param>
        <when value="data_import">
            <conditional name="input_source">
                <param name="selector" type="select" label="Input data source" help="IsoformSwitchAnalyzeR has different functions for importing data from tools.">
                    <option value="stringtie">Stringtie</option>
                    <option value="salmon">Salmon/Kallisto</option>
                </param>
                <when value="stringtie">
                    <repeat name="rep_factorLevel" title="Factor level" min="2" default="2">
                        <param name="factorLevel" type="text" value="FactorLevel" label="Specify a factor level, typical values could be 'tumor' or 'treated'"
                            help="Only letters, numbers and underscores will be retained in this field">
                            <sanitizer>
                                <valid initial="string.letters,string.digits"><add value="_" /></valid>
                            </sanitizer>
                        </param>
                        <param name="trans_counts" type="data" format="tabular" multiple="true" 
                            label="Transcript-level expression measurements" help="It is generate by Stringtie with the -B option." /> 
                    </repeat>
                </when>
                <when value="salmon">
                </when>
            </conditional>
            <param name="genome_annotation" type="data" format="gtf,gtf.gz" label="Genome annotation (GTF)" 
                help="It is used to integrate the coding sequence (CDS) regions from in the GTF file as the ORF regions used by IsoformSwitchAnalyzeR." />
            <param name="transcriptome" type="data" format="fasta,fasta.gz" label="Transcriptome" 
                help="Please note this different from a fasta file with the sequences of the entire genome." />
        </when>
        <when value="first_step">

        </when>
        <when value="second_step">

        </when>
    </conditional>


    </inputs>
    <outputs>

    </outputs>

    <tests>
    </tests>
    <help><![CDATA[
.. class:: infomark

    ]]></help>
    <expand macro="citations" />
</tool>
