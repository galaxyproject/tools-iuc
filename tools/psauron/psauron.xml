<tool id="psauron" name="Psauron" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@">
    <description>Machine learning model for rapid assessment of protein coding gene annotation</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <requirements>
        <requirement type="package" version="@TOOL_VERSION@">psauron</requirement>
        <requirement type="package" version="69.5.1">setuptools</requirement>

    </requirements>
    <version_command>psauron --version</version_command>
    <command detect_errors="exit_code">

        <![CDATA[
        psauron
        -i '$fasta' 
        -c
        --minimum-length '$MinimumLength'
        --exclude '$Exclude'
        --inframe '$Inframe'
        --outframe '$Outframe'
        $SingleFrame
        $Protein
        -o psauron_score.csv
        ]]>
    </command>
    <inputs>
        <param name="fasta" argument="-i" type="data" format="fasta" label="Input fasta" help="FASTA with spliced CDS sequence or protein sequence. A spliced CDS fasta can be created from a GTF/GFF and a reference FASTA by using gffread."/>       
        <param name="MinimumLength" argument="--minimum-length" type="integer" min="0" value="5" optional="true" label="Exclude all proteins shorter than m amino acids, default=5"/>
        <param name="Exclude" argument="--exclude" type="text" value="" optional="true" label="Exclude any CDS where FASTA description contains given text (case invariant), e.g. hypothetical, default=None"/>
        <param name="Inframe" argument="--inframe" type="float" min="0" max="1" value="0.5" optional="true" label="Probability threshold used to determine final psauron score, in-frame, higher number decreases sensitivity and increases specificity, default=0.5"/>
        <param name="Outframe" argument="--outframe" type="float" min="0" max="1" value="0.5" optional="true" label="Probability threshold used to determine final psauron score, out-of-frame, higher number increases sensitivity and decreases specificity, default=0.5"/>
        <!--c option not included-->
        <param name="SingleFrame" argument="-s" type="boolean" label="to score only the in-frame CDS, which may lower accuracy of the model, default=False" truevalue="-s" falsevalue="" value="False" /> 
        <param name="Protein" argument="-p" type="boolean" label="set to True if your FASTA contains amino acid protein sequence, which may lower accuracy of the model, default=False" truevalue="-p" falsevalue="" value="False" /> 
        <!--v option not included-->
    </inputs>
    <outputs>
        <data name="Psauron_score_file" format="csv" from_work_dir="psauron_score.csv" label="${tool.name} on ${on_string}: csv with scores for all reading frames"></data>
     </outputs>
    <tests>
        <!-- TEST 1 : nucleotide coding sequences (CDS) -->
        <test expect_num_outputs="1">
            <param name="fasta" value="seq_test_CDS.fa" ftype="fasta"/>
            <output name="Psauron_score_file" ftype="csv">
                <assert_contents>
                    <has_text_matching expression="psauron score" />
                </assert_contents>
            </output>
        </test>
        <!-- TEST 2 : protein (amino acid) sequence -->
        <test expect_num_outputs="1">
            <param name="fasta" value="seq_test_protein.faa" ftype="fasta"/>
            <param name="Protein" value="true"/>
            <output name="Psauron_score_file" ftype="csv">
                <assert_contents>
                    <has_text_matching expression="psauron score" />
                </assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[
.. class:: infomark

**PSAURON**

PSAURON is a machine learning model for rapid assessment of protein coding gene annotation

]]></help>
    <citations>
        <citation type="doi">10.1093/nargab/lqae189</citation>
    </citations>
</tool>
