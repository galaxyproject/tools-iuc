<tool id="pimento_auto" name="PIMENTO Primer cutoff prediction" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" license="@LICENSE@">
    <description>Infers primers by predicting optimal cutoff points from read conservation patterns</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="creators"/>
    <expand macro="requirements"/>
    <command detect_errors="aggressive"><![CDATA[
        pimento auto -i '$input' -st '$strand' -o sample
    ]]></command>
    <inputs>
        <param name="input" type="data" label="Input reads" format="fastqsanger.gz"/>
        <param name="strand" type="select" label="Strand" format="fastqsanger.gz">
            <option value="F">Forward</option>
            <option value="R">Reverse</option>
            <option value="FR">Both, forward and reverse</option>
        </param>
    </inputs>    
    <outputs>
        <data name="output" label="${tool.name} on ${on_string}: Automatically inferred primers" format="fasta" from_work_dir="sample_auto_primers.fasta"/>
    </outputs>
    <tests>
        <test expect_num_outputs="1">
            <param name="input" value="test.fastq.gz"/>
            <param name="strand" value="FR"/>
            <output name="output">
                <assert_contents>
                    <has_line line=">F_auto"/>
                    <has_line line="CCTACGGGDGGCWGCAGT"/>
                    <has_n_lines n="4"/>
                </assert_contents>
            </output>
        </test>
    </tests>
    <help><![CDATA[ 
        Runs the primer cutoff strategy for primer inference. Using patterns of
        base-conservation values for input reads, this strategy identifies potential
        cutoff points where a primer sequence could end. An optimal choice of cutoff
        based on the change in base-conservation before and after a cutoff is then
        made. Finally a consensus sequence is generated using this cutoff point and
        the input reads, which are saved to an output FASTA file.
    ]]></help>
    <expand macro="citations"/>
</tool>
