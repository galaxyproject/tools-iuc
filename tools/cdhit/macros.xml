<?xml version="1.0"?>
<macros>
    <token name="@TOOL_VERSION@">4.8.1</token>
    <token name="@VERSION_SUFFIX@">0</token>
    <xml name="requirements">
        <requirements>
        	<!-- both recipes use the same GitHub repository -->
        	<requirement type="package" version="@TOOL_VERSION@">cd-hit</requirement>
        	<requirement type="package" version="@TOOL_VERSION@">cd-hit-auxtools</requirement>
        </requirements>
    </xml>
    <xml name="citations">
    	<citations>
			<citation type="doi">10.1093/bioinformatics/17.3.282</citation>
			<citation type="doi">10.1093/bioinformatics/18.1.77</citation>
			<citation type="doi">10.1093/bioinformatics/btl158</citation>
			<citation type="doi">10.1093/bioinformatics/bts565</citation>
			<citation type="doi">10.1093/bioinformatics/btq003</citation>
			<citation type="doi">10.1186/1471-2105-11-187</citation>
			<citation type="doi">10.1093/bib/bbs035</citation>
		</citations>
    </xml>

    <!--
        command
    -->

    <!--
        input
    -->

    <xml name="a" token_default="">
		<param argument="-a" type="float" value="@DEFAULT@" label="Set abundance cutoff"/>
	</xml>

	<xml name="A">
		<param argument="-A" type="integer" min="0" value="0" label="Set minimal alignment coverage control for both sequences" help="Minimum number of residues of both sequences that must be covered"/>
	</xml>

	<xml name="aL">
    	<param argument="-aL" type="float" min="0.0" max="1.0" value="0.0" label="Alignment coverage for the longer sequence" help="Fraction of the longer sequence that must be covered."/>
    </xml>
	<xml name="AL">
    	<param argument="-AL" type="integer" min="0" value="99999999" label="Alignment coverage control for the longer sequence" help="If set to 60, and the length of the sequence is 400, then the alignment must be >= 340 (400-60) residues."/>
    </xml>
	<xml name="aS">
    	<param argument="-aS" type="float" min="0.0" max="1.0" value="0.0" label="Alignment coverage for the shorter sequence" help="Fraction of the shorter sequence that must be covered."/>
    </xml>
    <xml name="AS">
    	<param argument="-AS" type="integer" min="0" value="99999999" label="Alignment coverage control for the shorter sequence" help="If set to 60, and the length of the sequence is 400, then the alignment must be >= 340 (400-60) residues."/>
	</xml>
    <xml name="b" token_default="">
		<param argument="-b" type="integer" min="0" value="@DEFAULT@" label="Set band width of alignment"/>
    </xml>
    <xml name="bak">
    	<param argument="-bak" type="boolean" truevalue="-bak 1" falsevalue="" label="Create backup cluster file?"/>
    </xml> <!-- todo required -->
    <xml name="c" token_default="">
		<param argument="-c" type="float" min="0.0" max="1.0" value="@DEFAULT@" label="Set sequence identity threshold" help="Global sequence identity: number of identical alignment positions divided by the full length of the shorter sequence."/>
    </xml>
    <xml name="d">
        <param argument="-d" type="integer" value="0" label="Set description length" help="Truncate at the first whitespace character."/>
    </xml>
	<xml name="g">
    	<param argument="-g" type="boolean" truevalue="-g 1" falsevalue="-g 0" checked="false" label="Use accurate but slow mode?" help="By cd-hit's default algorithm, a sequence is clustered to the first cluster that meet the threshold (fast cluster). If set to true, the program will cluster it into the most similar cluster that meet the threshold (accurate but slow mode) but either 1 or 0 won't change the representatives of final clusters."/>
    </xml>
	<xml name="G">
	    <conditional name="G_cond">
	        <param name="G_sel" type="select" label="Select sequence identity type to set advanced parameters" help="Local sequence identity: number of identical amino alignment positions divided by the length of the alignment. Note: in local mode one of -aL, aS, or A must be > 0!">
	            <option value="-G 1" selected="true">Global (-G 1)</option>
	            <option value="-G 0">Local (-G 0)</option>
	        </param>
	        <when value="-G 1"/>
	        <when value="-G 0">
	            <expand macro="aL"/>
	            <expand macro="AL"/>
	            <expand macro="aS"/>
	            <expand macro="AS"/>
	            <expand macro="A"/>
	            <param argument="-s" type="float" min="0.0" max="1.0" value="0.0" label="Set length difference cutoff" help="If set to 0.9, the shorter sequences need to be at least 90% length of the representative of the cluster"/>
	            <param argument="-S" type="integer" min="0" value="999999" label="Set length difference cutoff in residues" help="If set to 60, the length difference between the shorter sequences and the representative of the cluster can not be bigger than 60"/>
	            <yield/>
	        </when>
	    </conditional>
	</xml>    
	<xml name="gap" token_default="">
		<param argument="-gap" type="integer" value="@DEFAULT@" label="Set gap opening score"/>
	</xml>
	<xml name="gapext">
		<param name="gapext" argument="-gap-ext" type="integer" value="-1" label="Set gap extension score"/>
	</xml>
    <xml name="log">
    	<param name="log" type="boolean" label="Create log file?"/>
    </xml>
	<xml name="match">
		<param argument="-match" type="integer" value="2" label="Set match score" help="1 for T-U and N-N"/>
	</xml>
	<xml name="mismatch" token_default="">
		<param argument="-mismatch" type="integer" value="@DEFAULT@" label="Set mismatch score"/>
	</xml>
    <xml name="n" token_default="" token_help="">
        <param argument="-n" type="integer" value="@DEFAULT@" label="Set word length" help="@HELP@"/>
    </xml>

    <!--
        help
    -->

    <token name="@WID@"><![CDATA[
*CD-HIT* is a greedy incremental clustering approach. The basic *CD-HIT* algorithm sorts the input sequences from long to short, and processes them sequentially from the longest to the shortest. The first sequence is automatically classified as the first cluster representative sequence. Then each query sequence of the remaining sequences is compared to the representative sequences found before it, and is classified as redundant or representative based on whether it is similar to one of the existing representative sequences. In default manner (fast mode), a query is grouped into the first representative without comparing to other representatives. In accurate mode, a query is compared to all representatives and grouped to the most similar one. 
    ]]></token>

    <token name="@REFERENCES@"><![CDATA[
More information can be found on the `project website <http://weizhongli-lab.org/cd-hit/>`_ and `GitHub <https://github.com/weizhongli/cdhit>`_. A web server is a available `here <http://weizhong-lab.ucsd.edu/cdhit-web-server/cgi-bin/index.cgi>`_.
    ]]></token>
</macros>