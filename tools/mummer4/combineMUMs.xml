<tool id="combineMUMs" name="combineMUMs" version="0.1.0">
    <requirements>
        <requirement type="package" version="4.0.0beta2">mummer4</requirement>
    </requirements>
    <command detect_errors="exit_code">
        <![CDATA[
        combineMUMs
            $difference
            -N $break
            $strings
            $qheader
            -v $verbose
            -W '$filename'
            $cover
            -e $cutoff
            '$reference_sequence'
            '$matchfile'
            '$mgaps' > '$mgaps_output'
        ]]>
    </command>
    <inputs>
        <param name="reference_sequence" type="data" format="fasta" label="Reference Seqeunce" />
        <param name="matchfile" type="data" format="txt" label="Matchfile from nucmer or promer" />
        <param name="mgaps" type="data" format="txt" label="Gaps File" />
        <param name="difference" type="boolean" argument="-D" truevalue="-D" falsevalue="" label="Only output the difference positions and characters" />
        <param name="break" type="integer" argument="-N" value="5" label="Breaks" help="Number of consecutive non-ACGTs to break matches at" />
        <param name="qlabel" type="text" argument="-q" optional="True" value="query" label="Query match label" />
        <param name="rlabel" type="text" argument="-r" optional="True" value="reference" label="Reference match label" /> 
        <param name="strings" type="boolean" argument="-s" truevalue="-s" falsevalue="" label="Output all differences in strings" />
        <param name="qheader" type="boolean" argument="-t" truevalue="-t" falsevalue="" label="Label query matches with query fasta header" />
        <param name="verbose" type="select" argument="-v" label="Set verbose level for extra output" >
            <option value="0">0</option>
            <option value="1">1</option>
            <option value="2">2</option>
        </param>
        <param name="filename" type="text" argument="-W" value="witherrors.gaps" label="Output filename" />
        <param name="cover" type="boolean" argument="-x" truevalue="-x" falsevalue="" label="Don't output .cover files" />
        <param name="cutoff" type="float" argument="-e" min="0.0" max="100.0" value="0.02" label="Error-rate cutoff" />
    </inputs>
    <outputs>
        <data name="errors_output" format="txt" from_work_dir="witherrors.gaps" />
        <data name="mgaps_output" format="txt" from_work_dir="combineMUMs.txt" />
    </outputs>
    <tests>
        <test>
            <param name="reference_sequence" ftype="fasta" value="human_aqp3.fasta" />
            <param name="matchfile" ftype="txt" value="nucmer.txt" />
            <param name="mgaps" ftype="txt" value="mgaps.txt" />
            <param name="label_selector" value="no" />
            <output name="errors_output" ftype="txt" value="witherrors.txt" label="with_errors" />
            <output name="mgaps_output" ftype="txt" value="combineMUMs.txt" label="combineMUMs" />
        </test>
    </tests>
    <help><![CDATA[
        This program reads the output of the mgaps program and adds alignment information to it. Part of the MUMmer4.x pipeline and can only be used on the output of the mgaps program. This -D option alters this behavior and only outputs the positions of difference, e.g. SNPs.
    ]]></help>
    <citations>
        <citation type="bibtex">
            @misc{githubmummer,
            author = {Art Delcher, Stefan Kurtz, Adam Phillippy, Steven Salzberg},
            year = {2012},
            title = {mummer4},
            publisher = {GitHub},
            journal = {GitHub repository},
            url = {https://github.com/mummer4/mummer},
        }</citation>
    </citations>
</tool>
