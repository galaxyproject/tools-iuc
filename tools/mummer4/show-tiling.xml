<tool id="show-tiling" name="Show-Tiling" version="0.1.0">
    <requirements>
        <requirement type="package" version="4.0.0beta2">mummer4</requirement>
    </requirements>
    <command detect_errors="exit_code">
        <![CDATA[
        show-tiling
            $path
            $circular
            -g $gap
            -i $identity
            -l $length
            #if $pseudo.pseudo_yes_no == "yes":
                -p $pseudo.pseudo_name
            #end if
            $repetitive
            #if $tigr.tigr_yes_no == "yes":
                -t '$tigr.tigr_name'
            #end if
            #if $unusable.unusable_yes_no == "yes":
                -u '$unusable.usable_name'
            #end if
            -v $min_coverage
            -V $coverage_diff
            $xml
            '$delta'
        ]]>
    </command>
    <inputs>
        <param name="delta" type="data" format="txt" label="Output from either nucmer or promer" />
        <param name="path" type="boolean" argument="-a" truevalue="-a" falsevalue="" label="Tiling path" help="Describe the tiling path by printing the tab-delimited alignment region coordinates to stdout" />
        <param name="circular" type="boolean" argument="-c" truevalue="-c" falsevalue="" label="Assume circular" help="Assume the reference sequences are circular, and allow tiled contigs to span the origin" />
        <param name="gap" type="integer" argument="-g" value="1000" min="-1" label="Set maximum gap between clustered alignments" help="A value of -1 will reprensent infinity. nucmer default=1000, promer default=-1" />
        <param name="identity" type="float" argument="-i" value="90.0" min="0" max="100" label="Set minimum percent identity to tile" help="nucmer default=90.0, promer default=55.0" />
        <param name="length" type="integer" argument="-l" value="1" min="-1" label="Set minimum length contig to report" help="A value of -1 will reprensent infinity" />
        <conditional name="pseudo" >
            <param name="pseudo_yes_no" type="select" label="Output a pseudo molecule of the query contigs?" >
                <option value="no">No</option>
                <option value="yes">Yes</option>
            </param>
            <when value="yes" >
                <param name="pseudo_name" type="text" argument="-p" label="Output file name" />
            </when>
            <when value="no" />
        </conditional>
        <param name="repetitive" type="boolean" argument="-R" truevalue="-R" falsevalue="" label="Repetitive contigs" help="Deal with repetitive contigs by randomly placing them in one of their copy locations" />
        <conditional name="tigr" >
            <param name="tigr_yes_no" type="select" label="Output a TIGR style contig list of each query sequence that sufficiently matches the reference" help="" >
                <option value="no">No</option>
                <option value="yes">Yes</option>
            </param>
            <when value="yes" >
                <param name="tigr_name" type="text" argument="-t" label="Output file name" />
            </when>
            <when value="no" />
        </conditional>
        <conditional name="unusable" >
         <param name="unusable_yes_no" type="select" label="Output the tab-delimited alignment region coordinates of the unusable contigs" help="" >
                <option value="no">No</option>
                <option value="yes">Yes</option>
            </param>
            <when value="yes">
                <param name="unusable_name" type="text" argument="-u" label="Output file name" />
            </when>
            <when value="no" />
        </conditional>
        <param name="min_coverage" type="float" argument="-v" value="95.0" min="0" max="100" label="Set minimum contig coverage to tile" help="nucmer default = 95.0 (sum of individual alignments(, promer default = 50.0 (extent of syntenic region)" />
        <param name="coverage_diff" type="float" argument="-V" value="10.0" min="0" max="100" label="Set minimum contig coverage difference" help="i.e. the difference needed to determine one alignment
        is 'better' than another alignment. 
        nucmer default = 10.0 (sum of individual alignments)
        promer default = 30.0 (extent of syntenic region)" />
        <param name="xml" type="boolean" argument="-x" truevalue="-x" falsevalue="" label="XML" help="Describe the tiling path by printing the XML contig linking information to stdout" />
    </inputs>
    <outputs>
        <data name="output" format="txt" from_work_dir="show-tiling.txt" />
    </outputs>
    <tests>
        <test>
            <param name="delta" ftype="txt" value="nucmer.txt" />
            <param name="pseudo_yes_no" value="no" />
            <param name="tigr_yes_no" value="no" />
            <param name="unusable_yes_no" value="no" />
            <output name="output" ftype="txt" compare="diff" value="show-tiling.txt" />
        </test>
    </tests>
    <help><![CDATA[
        This program attempts to construct a tiling path out of the query contigs as mapped to the reference sequences. Given the delta alignment information of a few long reference sequences and many small query contigs, show-tiling will determine the best location on a reference for each contig. Note that each contig may only be tiled once, so repetitive regions may cause this program some difficulty. This program is useful for aiding in the scaffolding and closure of an unfinished set of contigs, if a suitable, high similarity, reference genome is available. Or, if using promer, show-tiling will help in the identification of syntenic regions and their contig's mapping the the references.
    ]]></help>
    <citations>
        <citation type="bibtex">
            @misc{githubmummer,
            author = {Art Delcher, Stefan Kurtz, Adam Phillippy, Steven Salzberg},
            year = {2012},
            title = {mummer4},
            publisher = {GitHub},
            journal = {GitHub repository},
            url = {https://github.com/mummer4/mummer},
        }</citation>
    </citations>
</tool>

