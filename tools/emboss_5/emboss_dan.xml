<tool id="EMBOSS: dan19" name="dan"  version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="@PROFILE@">
  <description>Calculates DNA RNA/DNA melting temperature</description>
  <macros>
    <token name="@COMMAND@">dan</token>
    <import>macros.xml</import>
  </macros>
  <expand macro="bio_tools" />
  <expand macro="requirements" />
  <expand macro="version_command" />
  <command><![CDATA[
    @COMMAND@
      -sequence '$input1'
      -windowsize $window
      -shiftincrement $shift
      -dnaconc $dnaconc
      -saltconc $saltconc
      -mintemp $mintemp

      -outfile $out_file1
      -graph png
      -goutfile 'goutfile'
      -gtitle '$input1.element_identifier'

      #if $product_cond.product != ''
        $product_cond.product
        -formamide $product_cond.formamide
        -mismatch $product_cond.mismatch
        -prodlen $product_cond.prodlen
      #end if
      #if $thermo_cond.thermo != ''
        $thermo_cond.thermo
        -temperature $temperature
      #end if
      $rna

      ## Advanced (Unprompted) qualifiers
      $plot1
      -auto
  ]]></command>
  <inputs>
    <param name="input1" type="data" format="data" label="On query" />
    <param name="window" type="integer" value="20" min="1" max="100" label="Window size" />
    <param name="shift" type="integer" value="1" label="Step size (shift increment)" />
    <param name="dnaconc" type="float" value="50.0" min="1" max="100000" label="DNA Concentration (nM)" />
    <param name="saltconc" type="float" value="50.0" min="1" max="1000" label="Salt concentration (mM)" />
    <param name="mintemp" type="float" value="55.0" min="1" max="150" label="Enter a minimum value for the temperature scale (y-axis) of the plot" />
    <conditional name="product_cond">
      <param name="product" type="select" label="Output the DeltaG, DeltaH and DeltaS values">
        <option value="-product">Yes</option>
        <option value="">No</option>
      </param>
      <when value="-product">
        <param name="formamide" type="float" value="0.0" min="0" max="100" label="Percent formamide to be used in calculations" />
        <param name="mismatch" type="float" value="0.0" min="0" max="100" label="Percent mismatch to be used in calculations" />
        <param name="prodlen" type="integer" value="20" label="Product length to be used in calculations" />
      </when>
      <when value=""/>
    </conditional>
    <conditional name="thermo_cond">
      <param name="thermo" type="select" label="Output the DeltaG, DeltaH and DeltaS values">
        <option value="-thermo">Yes</option>
        <option value="">No</option>
      </param>
      <when value="-thermo">
        <param name="temperature" type="float" value="25.0" label="Temperature at which to calculate the DeltaG, DeltaH and DeltaS values" />
      </when>
      <when value=""/>
    </conditional>
    <param name="rna" type="boolean" truevalue="-rna" falsevalue="" checked="false" label="Sequence is RNA"/>
    <param name="plot1" type="boolean" truevalue="-plot" falsevalue="" checked="true" label="Create a graph"/>
  </inputs>
  <outputs>
    <data name="out_file1" format="dan" label="${tool.name} on ${on_string}: data">
      <filter>not plot1</filter>
    </data>
    <data name="goutfile" format="png" from_work_dir="goutfile.1.png" label="${tool.name} on ${on_string}: image">
      <filter>plot1</filter>
    </data>
  </outputs>
  <tests>
    <test expect_num_outputs="1">
      <param name="input1" value="X13776.fas"/>
      <param name="window" value="20"/>
      <param name="shift" value="1"/>
      <param name="dnaconc" value="50"/>
      <param name="saltconc" value="50"/>
      <conditional name="thermo_cond">
        <param name="thermo" value="-thermo"/>
        <param name="temperature" value="25"/>
      </conditional>
      <conditional name="product_cond">
        <param name="product" value="-product"/>
        <param name="formamide" value="0"/>
        <param name="mismatch" value="0"/>
        <param name="prodlen" value="20"/>
      </conditional>
      <param name="rna" value="false"/>
      <param name="plot1" value="false"/>
      <output name="out_file1" file="emboss_dan.txt" lines_diff="8"/>
    </test>
    <test expect_num_outputs="1">
      <param name="input1" value="X13776.fas"/>
      <param name="window" value="20"/>
      <param name="shift" value="1"/>
      <param name="dnaconc" value="50"/>
      <param name="saltconc" value="50"/>
      <conditional name="thermo_cond">
        <param name="thermo" value="-thermo"/>
        <param name="temperature" value="25"/>
      </conditional>
      <conditional name="product_cond">
        <param name="product" value="-product"/>
        <param name="formamide" value="0"/>
        <param name="mismatch" value="0"/>
        <param name="prodlen" value="20"/>
      </conditional>
      <param name="rna" value="false"/>
      <param name="plot1" value="true"/>
      <output name="goutfile">
        <assert_contents>
          <has_size min="1"/>
        </assert_contents>
      </output>
    </test>
  </tests>
  <help>
@DOC_LINK@
  </help>
  <expand macro="citations" />
</tool>
