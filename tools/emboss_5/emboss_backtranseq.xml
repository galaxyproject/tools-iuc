<tool id="EMBOSS: backtranseq2" name="backtranseq"  version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="@PROFILE@">
  <description>Back translate a protein sequence</description>
  <macros>
    <token name="@COMMAND@">backtranseq</token>
    <import>macros.xml</import>
  </macros>
  <expand macro="bio_tools" />
  <expand macro="requirements" />
  <expand macro="version_command" />
    <command><![CDATA[
    @COMMAND@
      -sequence '$input1'
      -outfile '$out_file1'
      -cfile $cfile
      -osformat2 $out_format1
      -auto
    ]]></command>
    <inputs>
        <param name="input1" type="data" format="fasta" label="Protein sequence" help="In FASTA format" />
        <param name="cfile" type="select" label="Codon usage file">
            <expand macro="codon_usage_options"/>
        </param>
        <param name="out_format1" type="select" label="Output sequence file format">
            <option value="fasta">FASTA (m)</option>
            <option value="acedb">ACeDB (m)</option>
            <option value="asn1">ASN.1 (m)</option>
            <option value="clustal">Clustal (m)</option>
            <option value="codata">CODATA (m)</option>
            <option value="embl">EMBL (m)</option>
            <option value="fitch">Fitch (m)</option>
            <option value="gcg">Wisconsin Package GCG 9.x and 10.x (s)</option>
            <option value="genbank">GENBANK (m)</option>
            <option value="gff">GFF (m)</option>
            <option value="hennig86">Hennig86 (m)</option>
            <option value="ig">Intelligenetics (m)</option>
            <option value="jackknifer">Jackknifer (m)</option>
            <option value="jackknifernon">Jackknifernon (m)</option>
            <option value="mega">Mega (m)</option>
            <option value="meganon">Meganon (m)</option>
            <option value="msf">Wisconsin Package GCG's MSF (m)</option>
            <option value="pir">NBRF (PIR) (m)</option>
            <option value="ncbi">NCBI style FASTA (m)</option>
            <option value="nexus">Nexus/PAUP (m)</option>
            <option value="nexusnon">Nexusnon/PAUPnon (m)</option>
            <option value="phylip">PHYLIP interleaved (m)</option>
            <option value="phylipnon">PHYLIP non-interleaved (m)</option>
            <option value="selex">SELEX (m)</option>
            <option value="staden">Staden (s)</option>
            <option value="strider">DNA strider (m)</option>
            <option value="swiss">SwisProt entry (m)</option>
            <option value="text">Plain sequence (s)</option>
            <option value="treecon">Treecon (m)</option>
        </param>
    </inputs>
    <outputs>
        <data name="out_file1" format="fasta" />
    </outputs>
    <tests>
        <test>
            <param name="input1" value="emboss_transeq_out.fasta"/>
            <param name="cfile" value="Ehuman.cut"/>
            <param name="out_format1" value="fasta"/>
            <output name="out_file1" file="emboss_backtranseq_out.fasta" ftype="fasta" />
        </test>
        <!-- Test with multiple sequence FASTA input -->
        <test>
            <param name="input1" value="emboss_getorf_out.fasta" />
            <param name="cfile" value="Ehuman.cut"/>
            <param name="out_format1" value="fasta"/>
            <output name="out_file1" file="emboss_backtranseq_out2.fasta" ftype="fasta" />
        </test>
    </tests>
    <help>
.. class:: warningmark

Back-translate a protein sequence to the nucleic acid sequence it is most likely to have come from. ``backtranseq`` uses a codon usage table which gives the frequency of usage of each codon for each amino acid. For each amino acid in the input sequence, the corresponding most frequently occuring codon is used in the nucleic acid sequence that is output.

-----

@DOC_LINK@
    </help>
    <expand macro="citations" />
</tool>
