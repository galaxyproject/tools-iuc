<tool
    id="b2btools_single_sequence"
    name="b2bTools: Biophysical predictors for single sequences"
    version="3.0.4+galaxy0"
    license="GPL-3.0"
    python_template_version="3.5"
    profile="21.05">
    <description>from their amino-acid sequences</description>
    <xrefs>
        <xref type="bio.tools">b2btools</xref>
    </xrefs>
    <requirements>
        <requirement type="package" version="3.0.4">b2btools</requirement>
    </requirements>
    <command detect_errors="exit_code"><![CDATA[
        mkdir tabular;
        mkdir plots;
        python '$__tool_directory__/script.py' --file '$section_input_file.input'
                                               $section_predictors.dynamine
                                               $section_predictors.disomine
                                               $section_predictors.efoldmine
                                               $section_predictors.agmata
                                               $section_plot.highlight
                                               $section_plot.plot
                                               $section_plot.plot_all
                                               --output ./tabular
                                               --plot-output ./plots
                                               --json '$predictions_output'
    ]]></command>
    <inputs>
        <section name="section_input_file" title="Input file" help="Configure this section to plug a valid input in FASTA format">
            <param type="data" name="input" format="fasta" label="Protein sequences in FASTA format" help="FASTA file of protein sequences (up to 10 sequences if AgMata is selected)"/>
        </section>
        <section name="section_predictors" title="Biophyisical predictors" help="Configure this section to select the predictions to be executed">
            <param
                name="dynamine"
                type="boolean"
                label="DynaMine: Dynamics"
                truevalue="--dynamine"
                falsevalue=""
                help="Fast predictor of protein backbone dynamics using only sequence information as input. The version here also predicts side-chain dynamics and secondary structure predictors using the same principle." />
            <param
                name="disomine"
                type="boolean"
                label="DisoMine: Disorder"
                truevalue="--disomine"
                falsevalue=""
                help="Predicts protein disorder with recurrent neural networks not directly from the amino acid sequence, but instead from more generic predictions of key biophysical properties, here protein dynamics, secondary structure and early folding."/>
            <param
                name="efoldmine"
                type="boolean"
                label="EFoldMine: Early folding"
                truevalue="--efoldmine"
                falsevalue=""
                help="Predicts from the primary amino acid sequence of a protein, which amino acids are likely involved in early folding events."/>
            <param
                name="agmata"
                type="boolean"
                label="Agmata: Beta aggregation"
                truevalue="--agmata"
                falsevalue=""
                help="(Max. 10 sequences) Single-sequence based predictor of protein regions that are likely to cause beta-aggregation."/>
        </section>
        <section name="section_plot" title="Plot options" help="Configure plot output">
            <param name="plot" type="boolean" label="Plot predicted values by sequence" truevalue="--plot" falsevalue="" help="This option plots predicted values in different files"/>
            <param name="plot_all" type="boolean" label="Plot all sequences together" truevalue="--plot_all" falsevalue="" help="This option plots all sequences together in order to compare predicted values of different sequences"/>
            <param name="highlight" type="boolean" label="Highlight regions of interest" truevalue="--highlight" falsevalue="" help="Highlight biophysical regions on the background of the plots"/>
        </section>
    </inputs>
    <outputs>
        <data name="predictions_output" label="Predictions in JSON format" format="json" />
        <collection name="split_output" type="list" label="Tabular predictions by sequence">
            <discover_datasets pattern="__name_and_ext__" format="tabular" directory="tabular" visible="true" />
        </collection>
        <collection name="split_output_plots" type="list" label="Plots">
            <discover_datasets pattern="__name_and_ext__" format="png" directory="plots" visible="true" />
        </collection>
    </outputs>
    <tests>
        <test>
            <param name="input" value="input.fasta" ftype="fasta"/>
            <param name="dynamine" value="true"/>
            <param name="disomine" value="false"/>
            <param name="efoldmine" value="false"/>
            <param name="agmata" value="false"/>
            <param name="plot" value="true"/>
            <param name="plot_all" value="true"/>
            <param name="highlight" value="true"/>
            <assert_command>
                <has_text text="--dynamine" />
                <has_text text="--json" />
                <has_text text="--plot" />
                <has_text text="--plot_all" />
                <has_text text="--highlight" />
            </assert_command>
            <!-- <output name="predictions_output" value="test_output.json" ftype="json" lines_diff="1"/> -->
        </test>
    </tests>
    <help><![CDATA[
        Bio2byte tools (b2btools) offer the following single protein sequence based predictions:

        - Backbone and sidechain dynamics (DynaMine) - Helix, sheet, coil and polyproline-II propensity
        - Early folding propensity (EFoldMine)
        - Disorder (DisoMine)
        - Beta-sheet aggregation (Agmata)

        This tool is available on the Python Package Index (PyPI): https://pypi.org/project/b2bTools/
    ]]>
    </help>
    <creator>
        <organization name="bio2Byte" url="https://bio2byte.be" email=""/>
        <organization name="Vrije Universiteit Brussel" url="https://vub.be" alternateName="VUB"/>
        <person honorificPrefix="Prof." givenName="Wim" familyName="Vranken" email="Wim.Vranken@vub.be" identifier="http://orcid.org/0000-0001-7470-4324" />
        <person givenName="Jose" familyName="Gavalda-Garcia" email="Jose.Gavalda.Garcia@vub.be" identifier="http://orcid.org/0000-0001-6431-3442" />
        <person givenName="Adrian" familyName="Diaz" email="Adrian.Diaz@vub.be" identifier="http://orcid.org/0000-0003-0165-1318" />
    </creator>
    <citations>
        <citation type="doi">10.1038/ncomms3741</citation>
        <citation type="doi">10.1101&#47;2020.05.25.115253</citation>
        <citation type="doi">10.1038&#47;s41598-017-08366-3</citation>
        <citation type="doi">10.1093/bioinformatics/btz912</citation>
    </citations>
</tool>