<tool id="mg_toolkit_bulk_download" name="Metagenomics toolkit Bulk Download" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="23.0">
    <description>Download result files in bulks for an entire study</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="creators" />
    <expand macro="biotools" />
    <expand macro="requirements" />
    <command><![CDATA[
        mg-toolkit -d bulk_download -a $accession
        -p $version_result_group.pipeline
        -g $version_result_group.result_group.result_group &&
        mv ${accession}/${accession}_metadata.tsv '$metadata' > /dev/null || true &&
        gunzip ${accession}/${version_result_group.pipeline}/functional_analysis/*.tsv.gz > /dev/null || true &&
        gunzip ${accession}/${version_result_group.pipeline}/pathways_and_systems/*.embl.gz > /dev/null || true &&
        gunzip ${accession}/${version_result_group.pipeline}/non-coding_rnas/*.fasta.gz > /dev/null || true &&
        mv ${accession}/${version_result_group.pipeline}/* . > /dev/null
    ]]></command>
    
    <inputs>
        <param name="accession" type="text" label="Accession" help="Study/project accession (e.g., MGYS00002115)" optional="false">
            <validator type="regex" message="ENA study accession or MGnify study ID">^([A-Za-z]{3,5}\d+)$</validator>
        </param>
        <conditional name="version_result_group">
            <param argument="--pipeline" type="select" label="Pipeline Version">
                <option value="1.0">1.0</option>
                <option value="2.0">2.0</option>
                <option value="3.0">3.0</option>
                <option value="4.0">4.0</option>
                <option value="4.1">4.1</option>
                <option value="5.0">5.0</option>
            </param>
            <when value="1.0">
            <conditional name="result_group">
                <param argument="--result_group" type="select" label="Result Group">
                    <expand macro="all_versions_result_group" />
                    <expand macro="v1.0-v3.0_result_group" />
                </param>
                <when value="statistics">
                    <expand macro="file_type_statistics"/>
                </when>
                <when value="sequence_data">
                    <expand macro="file_type_sequence_data" />
                </when>
                <when value="functional_analysis">
                    <expand macro="file_type_functional_analysis" />
                </when>
                <when value="taxonomic_analysis">
                    <expand macro="file_type_taxonomic_analysis" />
                </when>
            </conditional>
            </when>
            <when value="2.0">
            <conditional name="result_group">
                <param argument="--result_group" type="select" label="Result Group">
                    <expand macro="all_versions_result_group" />
                    <expand macro="v1.0-v3.0_result_group" />
                </param>
                <when value="statistics">
                    <expand macro="file_type_statistics"/>
                </when>
                <when value="sequence_data">
                    <expand macro="file_type_sequence_data" />
                </when>
                <when value="functional_analysis">
                    <expand macro="file_type_functional_analysis" />
                </when>
                <when value="taxonomic_analysis">
                    <expand macro="file_type_taxonomic_analysis" />
                </when>
            </conditional>
            </when>
            <when value="3.0">
            <conditional name="result_group">
                <param argument="--result_group" type="select" label="Result Group">
                    <expand macro="all_versions_result_group" />
                    <expand macro="v1.0-v3.0_result_group" />
                </param>
                <when value="statistics">
                    <expand macro="file_type_statistics" />
                </when>
                <when value="sequence_data">
                    <expand macro="file_type_sequence_data" />
                </when>
                <when value="functional_analysis">
                    <expand macro="file_type_functional_analysis" />
                </when>
                <when value="taxonomic_analysis">
                    <expand macro="file_type_taxonomic_analysis" />
                </when>
            </conditional>
            </when>
            <when value="4.0">
            <conditional name="result_group">
                <param argument="--result_group" type="select" label="Result Group">
                    <expand macro="all_versions_result_group" />
                    <expand macro="v4.0-v5.0_result_group" />
                </param>
                <when value="statistics">
                    <expand macro="file_type_statistics" />
                </when>
                <when value="sequence_data">
                    <expand macro="file_type_sequence_data" />
                </when>
                <when value="functional_analysis">
                    <expand macro="file_type_functional_analysis" />
                </when>
                <when value="taxonomic_analysis_ssu_rrna">
                    <expand macro="file_type_taxonomic_analysis_ssu_rrna" />
                </when>
                <when value="taxonomic_analysis_lsu_rrna">
                    <expand macro="file_type_taxonomic_analysis_lsu_rrna" />
                </when>
                <when value="non-coding_rnas">
                    <expand macro="file_type_non-coding_rnas" />
                </when>
            </conditional>
            </when>
            <when value="4.1">
            <conditional name="result_group">
                <param argument="--result_group" type="select" label="Result Group">
                    <expand macro="all_versions_result_group" />
                    <expand macro="v4.0-v5.0_result_group" />
                </param>
                <when value="statistics">
                    <expand macro="file_type_statistics" />
                </when>
                <when value="sequence_data">
                    <expand macro="file_type_sequence_data" />
                </when>
                <when value="functional_analysis">
                    <expand macro="file_type_functional_analysis" />
                </when>
                <when value="taxonomic_analysis_ssu_rrna">
                    <expand macro="file_type_taxonomic_analysis_ssu_rrna" />
                </when>
                <when value="taxonomic_analysis_lsu_rrna">
                    <expand macro="file_type_taxonomic_analysis_lsu_rrna" />
                </when>
                <when value="non-coding_rnas">
                    <expand macro="file_type_non-coding_rnas" />
                </when>
            </conditional>
            </when>
            <when value="5.0">
            <conditional name="result_group">
                <param argument="--result_group" type="select" label="Result Group">
                    <expand macro="all_versions_result_group" />
                    <expand macro="v4.0-v5.0_result_group" />
                    <expand macro="v5.0_result_group" />
                </param>
                <when value="statistics">
                    <expand macro="file_type_statistics" />
                </when>
                <when value="sequence_data">
                    <expand macro="file_type_sequence_data" />
                </when>
                <when value="functional_analysis">
                    <expand macro="file_type_functional_analysis" />
                </when>
                <when value="taxonomic_analysis_ssu_rrna">
                    <expand macro="file_type_taxonomic_analysis_ssu_rrna" />
                </when>
                <when value="taxonomic_analysis_lsu_rrna">
                    <expand macro="file_type_taxonomic_analysis_lsu_rrna" />
                </when>
                <when value="non-coding_rnas">
                    <expand macro="file_type_non-coding_rnas" />
                </when>
                <when value="taxonomic_analysis_itsonedb">
                    <expand macro="file_type_taxonomic_analysis_itsonedb" />
                </when>
                <when value="taxonomic_analysis_unite">
                    <expand macro="file_type_taxonomic_analysis_unite" />
                </when>
                <when value="taxonomic_analysis_motu">
                    <expand macro="file_type_taxonomic_analysis_motu" />
                </when>
                <when value="pathways_and_systems">
                    <expand macro="file_type_pathways_and_systems" />
                </when>
            </conditional>
            </when>
        </conditional>
    </inputs>
    <outputs>
        <data name="metadata" format="tsv" label="Metadata" />

        <!--statistics-->
        <collection name="taxa_abundance_distribution" type="list" label="Taxa abundance distribution">
            <filter>"taxa_abundance_distribution" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*_fold-change)\.svg" format="svg" directory="statistics" />
            <discover_datasets pattern="(?P&lt;designation&gt;.*_tad-plots)\.svg" format="svg" directory="statistics" />
        </collection>

        <!--sequence_data-->
        <collection name="processed_contigs_nucleotide_reads" type="list" label="Processed contigs/nucleotide reads">
            <filter>"processed_contigs_nucleotide_reads" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*FASTQ(?:_[0-9][0-9][0-9])?)\.fasta\.gz" format="fasta.gz" directory="sequence_data" />
            <discover_datasets pattern="(?P&lt;designation&gt;.*FASTA(?:_[0-9][0-9][0-9])?)\.fasta\.gz" format="fasta.gz" directory="sequence_data" />
        </collection>
        <collection name="processed_contigs_reads_with_annotation" type="list" label="Processed contigs/reads with annotation">
            <filter>"processed_contigs_reads_with_annotation" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*interproscan(?:_[0-9][0-9][0-9])?)\.fasta\.gz" format="fasta.gz" directory="sequence_data" />
        </collection>
        <collection name="processed_contigs_reads_without_annotation" type="list" label="Processed contigs/reads without annotation">
            <filter>"processed_contigs_reads_without_annotation" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*noFunction(?:_[0-9][0-9][0-9])?)\.fasta\.gz" format="fasta.gz" directory="sequence_data" />
        </collection>
        <collection name="processed_contigs_reads_with_pcds" type="list" label="Processed contigs/reads with pCDS">
            <filter>"processed_contigs_reads_with_pcds" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*contigsWithpCDS(?:_[0-9][0-9][0-9])?)\.fasta\.gz" format="fasta.gz" directory="sequence_data" />
            <discover_datasets pattern="(?P&lt;designation&gt;.*readsWithpCDS(?:_[0-9][0-9][0-9])?)\.fasta\.gz" format="fasta.gz" directory="sequence_data" />
        </collection>
        <collection name="predicted_cds" type="list" label="Predicted CDS (aa)">
            <filter>"predicted_cds" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*predicted_cds(?:_[0-9][0-9][0-9])?)\.faa\.gz" format="fasta.gz" directory="sequence_data" />
        </collection>
        <collection name="predicted_cds_with_annotation" type="list" label="Predicted CDS with annotation">
            <filter>"predicted_cds_with_annotation" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*CDS_annotated(?:_[0-9][0-9][0-9])?)\.faa\.gz" format="fasta.gz" directory="sequence_data" />
        </collection>
        <collection name="predicted_cds_without_annotation" type="list" label="Predicted CDS without annotation">
            <filter>"predicted_cds_without_annotation" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*CDS_unannotated(?:_[0-9][0-9][0-9])?)\.faa\.gz" format="fasta.gz" directory="sequence_data" />
        </collection>
        <collection name="predicted_orf" type="list" label="Predicted ORF (nt)">
            <filter>"predicted_orf" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*predicted_orf(?:_[0-9][0-9][0-9])?)\.ffn\.gz" format="fasta.gz" directory="sequence_data" />
        </collection>
        <collection name="predicted_orf_with_annotation" type="list" label="Predicted ORF with annotation">
            <filter>"predicted_orf_with_annotation" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*ORF_annotated(?:_[0-9][0-9][0-9])?)\.ffn\.gz" format="fasta.gz" directory="sequence_data" />
        </collection>
        <collection name="predicted_orf_without_annotation" type="list" label="Predicted ORF without annotation">
            <filter>"predicted_orf_without_annotation" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*ORF_unannotated(?:_[0-9][0-9][0-9])?)\.ffn\.gz" format="fasta.gz" directory="sequence_data" />
        </collection>

        <!--functional_analysis-->
        <collection name="complete_go_annotation" type="list" label="Complete GO annotation">
            <filter>"complete_go_annotation" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*GO(?:_[0-9][0-9][0-9])?)\.csv" format="csv" directory="functional_analysis" />
        </collection>
        <collection name="go_slim_annotation" type="list" label="GO slim annotation">
            <filter>"go_slim_annotation" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*GO_slim(?:_[0-9][0-9][0-9])?)\.csv" format="csv" directory="functional_analysis" />
        </collection>
        <collection name="interpro_summary" type="list" label="InterPro summary">
            <filter>"interpro_summary" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*InterPro(?:_[0-9][0-9][0-9])?)\.csv" format="csv" directory="functional_analysis" />
        </collection>
        <collection name="interpro_matches" type="list" label="InterPro matches">
            <filter>"interpro_matches" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*InterPro(?:_[0-9][0-9][0-9])?)\.tsv" format="tsv" directory="functional_analysis" />
        </collection>
        <collection name="kegg_orthologues_annotation" type="list" label="KEGG orthologues annotation">
            <filter>"kegg_orthologues_annotation" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*ko(?:_[0-9][0-9][0-9])?)\.tsv" format="tsv" directory="functional_analysis" />
        </collection>
        <collection name="pfam_annotation" type="list" label="Pfam annotation">
            <filter>"pfam_annotation" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*pfam(?:_[0-9][0-9][0-9])?)\.tsv" format="tsv" directory="functional_analysis" />
        </collection>
        <collection name="combined_annotation" type="list" label="Combined (eggNOG, InterPro, antiSMASH) annotation">
            <filter>"combined_annotation" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*annotations(?:_[0-9][0-9][0-9])?)\.gff\.bgz" format="gff3.gz" directory="functional_analysis" />
        </collection>
        <collection name="diamond_annotation" type="list" label="Diamond annotation">
            <filter>"diamond_annotation" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*diamond(?:_[0-9][0-9][0-9])?)\.tsv" format="tsv" directory="functional_analysis" />
        </collection>
        <collection name="eggnog_annotation" type="list" label="eggNOG annotation">
            <filter>"eggnog_annotation" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*emapper(?:_[0-9][0-9][0-9])?\.annotations)\.tsv" format="tsv" directory="functional_analysis" />
        </collection>
        <collection name="eggnog_seed_orthologs" type="list" label="eggNOG seed orthologs">
            <filter>"eggnog_seed_orthologs" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*emapper(?:_[0-9][0-9][0-9])?\.seed_orthologs)\.tsv" format="tsv" directory="functional_analysis" />
        </collection>

        <!--taxonomic_analysis_ssu_rrna-->
        <collection name="reads_contigs_encoding_ssu" type="list" label="Reads/Contigs encoding SSU rRNA">
            <filter>"reads_contigs_encoding_ssu" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*(?:_[0-9][0-9][0-9])?)\.fasta\.gz" format="fasta.gz" directory="taxonomic_analysis_ssu_rrna" />
        </collection>
        <collection name="mapseq_ssu_assignments" type="list" label="MAPseq SSU assignments">
            <filter>"mapseq_ssu_assignments" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*(?:_[0-9][0-9][0-9])?)\.mseq\.gz" format="tabular" directory="taxonomic_analysis_ssu_rrna" />
        </collection>
        <collection name="ssu_otu_tables" type="list" label="SSU OTU tables">
            <filter>"ssu_otu_tables" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*(?:_[0-9][0-9][0-9])?)\.tsv" format="tsv" directory="taxonomic_analysis_ssu_rrna" />
        </collection>
        <collection name="ssu_hdf5_biom" type="list" label="SSU HDF5 BIOM files">
            <filter>"ssu_hdf5_biom" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*hdf5(?:_[0-9][0-9][0-9])?)\.biom" format="biom2" directory="taxonomic_analysis_ssu_rrna" />
            <discover_datasets pattern="(?P&lt;designation&gt;.*HDF5(?:_[0-9][0-9][0-9])?)\.biom" format="biom2" directory="taxonomic_analysis_ssu_rrna" />
        </collection>
        <collection name="ssu_json_biom" type="list" label="SSU JSON BIOM files">
            <filter>"ssu_json_biom" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*json(?:_[0-9][0-9][0-9])?)\.biom" format="biom1" directory="taxonomic_analysis_ssu_rrna" />
            <discover_datasets pattern="(?P&lt;designation&gt;.*JSON(?:_[0-9][0-9][0-9])?)\.biom" format="biom1" directory="taxonomic_analysis_ssu_rrna" />
        </collection>

        <!--taxonomic_analysis_lsu_rrna-->
        <collection name="reads_contigs_encoding_lsu" type="list" label="Reads/Contigs encoding LSU rRNA">
            <filter>"reads_contigs_encoding_lsu" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*(?:_[0-9][0-9][0-9])?)\.fasta\.gz" format="fasta.gz" directory="taxonomic_analysis_lsu_rrna" />
        </collection>
        <collection name="mapseq_lsu_assignments" type="list" label="MAPseq LSU assignments">
            <filter>"mapseq_lsu_assignments" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*(?:_[0-9][0-9][0-9])?)\.mseq\.gz" format="tabular" directory="taxonomic_analysis_lsu_rrna" />
        </collection>
        <collection name="lsu_otu_tables" type="list" label="LSU OTU tables">
            <filter>"lsu_otu_tables" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*(?:_[0-9][0-9][0-9])?)\.tsv" format="tsv" directory="taxonomic_analysis_lsu_rrna" />
        </collection>
        <collection name="lsu_hdf5_biom" type="list" label="LSU HDF5 BIOM files">
            <filter>"lsu_hdf5_biom" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*hdf5(?:_[0-9][0-9][0-9])?)\.biom" format="biom2" directory="taxonomic_analysis_lsu_rrna" />
            <discover_datasets pattern="(?P&lt;designation&gt;.*HDF5(?:_[0-9][0-9][0-9])?)\.biom" format="biom2" directory="taxonomic_analysis_lsu_rrna" />
        </collection>
        <collection name="lsu_json_biom" type="list" label="LSU JSON BIOM files">
            <filter>"lsu_json_biom" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*json(?:_[0-9][0-9][0-9])?)\.biom" format="biom1" directory="taxonomic_analysis_lsu_rrna" />
            <discover_datasets pattern="(?P&lt;designation&gt;.*JSON(?:_[0-9][0-9][0-9])?)\.biom" format="biom1" directory="taxonomic_analysis_lsu_rrna" />
        </collection>

        <!--non-coding_rnas-->
        <collection name="predicted_non_coding_rnas" type="list" label="Predicted non-coding RNAs">
            <filter>"predicted_non_coding_rnas" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*(?:_[0-9][0-9][0-9])?)\.fa" format="fasta" directory="non-coding_rnas" />
            <discover_datasets pattern="(?P&lt;designation&gt;.*(?:_[0-9][0-9][0-9])?)\.fasta" format="fasta" directory="non-coding_rnas" />
        </collection>

        <!--taxonomic_analysis_itsonedb-->
        <collection name="mapseq_itsonedb_assignments" type="list" label="MAPseq ITSoneDB assignments">
            <filter>"mapseq_itsonedb_assignments" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*(?:_[0-9][0-9][0-9])?)\.mseq\.gz" format="tabular" directory="taxonomic_analysis_itsonedb" />
        </collection>
        <collection name="itsonedb_otu_tables" type="list" label="ITSoneDB OTU tables">
            <filter>"itsonedb_otu_tables" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*OTU(?:_[0-9][0-9][0-9])?)\.tsv" format="tsv" directory="taxonomic_analysis_itsonedb" />
        </collection>
        <collection name="itsonedb_hdf5_biom" type="list" label="ITSoneDB HDF5 BIOM files">
            <filter>"itsonedb_hdf5_biom" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*HDF5(?:_[0-9][0-9][0-9])?)\.biom" format="biom2" directory="taxonomic_analysis_itsonedb" />
        </collection>
        <collection name="itsonedb_json_biom" type="list" label="ITSoneDB JSON BIOM files">
            <filter>"itsonedb_json_biom" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*JSON(?:_[0-9][0-9][0-9])?)\.biom" format="biom1" directory="taxonomic_analysis_itsonedb" />
        </collection>

        <!--taxonomic_analysis_unite-->
        <collection name="mapseq_unite_assignments" type="list" label="MAPseq UNITE assignments">
            <filter>"mapseq_unite_assignments" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*(?:_[0-9][0-9][0-9])?)\.mseq\.gz" format="tabular" directory="taxonomic_analysis_unite" />
        </collection>
        <collection name="unite_otu_tables" type="list" label="UNITE OTU tables">
            <filter>"unite_otu_tables" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*OTU(?:_[0-9][0-9][0-9])?)\.tsv" format="tsv" directory="taxonomic_analysis_unite" />
        </collection>
        <collection name="unite_hdf5_biom" type="list" label="UNITE HDF5 BIOM files">
            <filter>"unite_hdf5_biom" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*HDF5(?:_[0-9][0-9][0-9])?)\.biom" format="biom2" directory="taxonomic_analysis_unite" />
        </collection>
        <collection name="unite_json_biom" type="list" label="UNITE JSON BIOM files">
            <filter>"unite_json_biom" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*JSON(?:_[0-9][0-9][0-9])?)\.biom" format="biom1" directory="taxonomic_analysis_unite" />
        </collection>

        <!--taxonomic_analysis_motu-->
        <collection name="motus_taxonomic_profile" type="list" label="mOTUs taxonomic profile">
            <filter>"motus_taxonomic_profile" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*(?:_[0-9][0-9][0-9])?\.mOTUs)\.tsv" format="tsv" directory="taxonomic_analysis_motu" />
        </collection>

        <!--pathways_and_systems-->
        <collection name="antismash_annotation_gff3" type="list" label="antiSMASH annotation (gff3)">
            <filter>"antismash_annotation_gff3" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*antismash(?:_[0-9][0-9][0-9])?)\.gff\.bgz" format="gff3.gz" directory="pathways_and_systems" />
        </collection>
        <collection name="antismash_annotation_embl" type="list" label="antiSMASH annotation (embl)">
            <filter>"antismash_annotation_embl" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*antismash(?:_[0-9][0-9][0-9])?)\.embl" format="embl" directory="pathways_and_systems" />
        </collection>
        <collection name="antismash_annotation_genbank" type="list" label="antiSMASH annotation (genbank)">
            <filter>"antismash_annotation_genbank" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*antismash(?:_[0-9][0-9][0-9])?)\.gbk\.gz" format="genbank.gz" directory="pathways_and_systems" />
        </collection>
        <collection name="antismash_summary" type="list" label="antiSMASH summary">
            <filter>"antismash_summary" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*antismash_summary(?:_[0-9][0-9][0-9])?)\.csv" format="csv" directory="pathways_and_systems" />
        </collection>
        <collection name="genome_properties_annotation" type="list" label="Genome Properties annotation">
            <filter>"genome_properties_annotation" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*gp(?:_[0-9][0-9][0-9])?)\.csv" format="csv" directory="pathways_and_systems" />
        </collection>
        <collection name="kegg_pathway_annotation" type="list" label="KEGG pathway annotation">
            <filter>"kegg_pathway_annotation" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*kegg_pathways(?:_[0-9][0-9][0-9])?)\.csv" format="csv" directory="pathways_and_systems" />
        </collection>
        <collection name="kegg_pathway_annotation_contig" type="list" label="KEGG pathway annotation (contig)">
            <filter>"kegg_pathway_annotation_contig" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*kegg_pathways_contigs(?:_[0-9][0-9][0-9])?)\.tsv" format="tsv" directory="pathways_and_systems" />
        </collection>

        <!--taxonomic_analysis-->
        <collection name="phylogenetic_tree" type="list" label="Phylogenetic tree">
            <filter>"phylogenetic_tree" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*newick(?:_[0-9][0-9][0-9])?)\.tre" format="newick" directory="taxonomic_analysis" />
            <discover_datasets pattern="(?P&lt;designation&gt;.*pruned(?:_[0-9][0-9][0-9])?)\.tree" format="newick" directory="taxonomic_analysis" />
        </collection>
        <collection name="otus_counts_and_taxonomic_assignments_tsv" type="list" label="OTUs, counts and taxonomic assignments (table)">
            <filter>"otus_counts_and_taxonomic_assignments_tsv" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*otu(?:_[0-9][0-9][0-9])?)\.tsv" format="tsv" directory="taxonomic_analysis" />
        </collection>
        <collection name="otus_counts_and_taxonomic_assignments_biom1" type="list" label="OTUs, counts and taxonomic assignments (JSON)">
            <filter>"otus_counts_and_taxonomic_assignments_biom1" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*json(?:_[0-9][0-9][0-9])?)\.biom" format="biom1" directory="taxonomic_analysis" />
            <discover_datasets pattern="(?P&lt;designation&gt;.*otu(?:_[0-9][0-9][0-9])?)\.biom" format="biom1" directory="taxonomic_analysis" />
        </collection>
        <collection name="otus_counts_and_taxonomic_assignments_biom2" type="list" label="OTUs, counts and taxonomic assignments (HDF5)">
            <filter>"otus_counts_and_taxonomic_assignments_biom2" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*hdf5(?:_[0-9][0-9][0-9])?)\.biom" format="biom2" directory="taxonomic_analysis" />
        </collection>
        <collection name="reads_encoding_5s_rrna" type="list" label="Reads encoding 16S rRNA">
            <filter>"reads_encoding_5s_rrna" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*5SrRNA(?:_[0-9][0-9][0-9])?)\.fasta" format="fasta" directory="taxonomic_analysis" />
        </collection>
        <collection name="reads_encoding_16s_rrna" type="list" label="Reads encoding 23S rRNA">
            <filter>"reads_encoding_16s_rrna" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*16SrRNA(?:_[0-9][0-9][0-9])?)\.fasta" format="fasta" directory="taxonomic_analysis" />
        </collection>
        <collection name="reads_encoding_23s_rrna" type="list" label="Reads encoding 5S rRNA">
            <filter>"reads_encoding_23s_rrna" in str(version_result_group['result_group']['file_type'])</filter>
            <discover_datasets pattern="(?P&lt;designation&gt;.*23SrRNA(?:_[0-9][0-9][0-9])?)\.fasta" format="fasta" directory="taxonomic_analysis" />
        </collection>
    </outputs>
    <tests>
        <!--taxonomic_analysis_ssu_rrna_test-->
        <test expect_num_outputs="6">
            <param name="accession" value="MGYS00002098" />
            <param name="pipeline" value="4.0" />
            <param name="result_group" value="taxonomic_analysis_ssu_rrna" />
            <param name="file_type" value="reads_contigs_encoding_ssu,mapseq_ssu_assignments,ssu_otu_tables,ssu_hdf5_biom,ssu_json_biom" />
            <output name="metadata" file="taxonomic_analysis_ssu_rrna/MGYS00002098_metadata.tsv" />
            <output_collection name="reads_contigs_encoding_ssu" count="1">
                <element name="SRR5252247_FASTQ_SSU" ftype="fasta.gz" file="taxonomic_analysis_ssu_rrna/SRR5252247_FASTQ_SSU.fasta.gz" />
            </output_collection>
            <output_collection name="mapseq_ssu_assignments" count="1">
                <element name="SRR5252247_FASTQ_SSU_MAPSeq" ftype="tabular" file="taxonomic_analysis_ssu_rrna/SRR5252247_FASTQ_SSU_MAPSeq.mseq.gz" />
            </output_collection>
            <output_collection name="ssu_otu_tables" count="1">
                <element name="SRR5252247_FASTQ_SSU_OTU" ftype="tsv" file="taxonomic_analysis_ssu_rrna/SRR5252247_FASTQ_SSU_OTU.tsv" />
            </output_collection>
            <output_collection name="ssu_hdf5_biom" count="1">
                <element name="SRR5252247_FASTQ_SSU_OTU_TABLE_HDF5" ftype="biom2" file="taxonomic_analysis_ssu_rrna/SRR5252247_FASTQ_SSU_OTU_TABLE_HDF5.biom" />
            </output_collection>
            <output_collection name="ssu_json_biom" count="1">
                <element name="SRR5252247_FASTQ_SSU_OTU_TABLE_JSON" ftype="biom1" file="taxonomic_analysis_ssu_rrna/SRR5252247_FASTQ_SSU_OTU_TABLE_JSON.biom" />
            </output_collection>
        </test>
        <!--taxonomic_analysis_lsu_rrna_test-->
        <test expect_num_outputs="6">
            <param name="accession" value="MGYS00002316" />
            <param name="pipeline" value="4.1" />
            <param name="result_group" value="taxonomic_analysis_lsu_rrna" />
            <param name="file_type" value="reads_contigs_encoding_lsu,mapseq_lsu_assignments,lsu_otu_tables,lsu_hdf5_biom,lsu_json_biom" />
            <output name="metadata" file="taxonomic_analysis_lsu_rrna/MGYS00002316_metadata.tsv" />
            <output_collection name="reads_contigs_encoding_lsu" count="1">
                <element name="OFEK01_FASTA_LSU" ftype="fasta.gz" file="taxonomic_analysis_lsu_rrna/OFEK01_FASTA_LSU.fasta.gz" />
            </output_collection>
            <output_collection name="mapseq_lsu_assignments" count="1">
                <element name="OFEK01_FASTA_LSU_MAPSeq" ftype="tabular" file="taxonomic_analysis_lsu_rrna/OFEK01_FASTA_LSU_MAPSeq.mseq.gz" />
            </output_collection>
            <output_collection name="lsu_otu_tables" count="1">
                <element name="OFEK01_FASTA_LSU_OTU" ftype="tsv" file="taxonomic_analysis_lsu_rrna/OFEK01_FASTA_LSU_OTU.tsv" />
            </output_collection>
            <output_collection name="lsu_hdf5_biom" count="1">
                <element name="OFEK01_FASTA_LSU_OTU_TABLE_HDF5" ftype="biom2" file="taxonomic_analysis_lsu_rrna/OFEK01_FASTA_LSU_OTU_TABLE_HDF5.biom" />
            </output_collection>
            <output_collection name="lsu_json_biom" count="1">
                <element name="OFEK01_FASTA_LSU_OTU_TABLE_JSON" ftype="biom1" file="taxonomic_analysis_lsu_rrna/OFEK01_FASTA_LSU_OTU_TABLE_JSON.biom" />
            </output_collection>
        </test>
        <!--taxonomic_analysis_unite_test-->
        <test expect_num_outputs="5">
            <param name="accession" value="MGYS00002478" />
            <param name="pipeline" value="5.0" />
            <param name="result_group" value="taxonomic_analysis_unite" />
            <param name="file_type" value="mapseq_unite_assignments,unite_otu_tables,unite_hdf5_biom,unite_json_biom" />
            <output name="metadata" file="taxonomic_analysis_unite/MGYS00002478_metadata.tsv" />
            <output_collection name="mapseq_unite_assignments" count="2">
                <element name="ERR169331_FASTQ_ITS_UNITE_MAPSeq" ftype="tabular" file="taxonomic_analysis_unite/ERR169331_FASTQ_ITS_UNITE_MAPSeq.mseq.gz" />
                <element name="ERR169333_FASTQ_ITS_UNITE_MAPSeq" ftype="tabular" file="taxonomic_analysis_unite/ERR169333_FASTQ_ITS_UNITE_MAPSeq.mseq.gz" />
            </output_collection>
            <output_collection name="unite_otu_tables" count="2">
                <element name="ERR169331_FASTQ_ITS_UNITE_OTU" ftype="tsv" file="taxonomic_analysis_unite/ERR169331_FASTQ_ITS_UNITE_OTU.tsv" />
                <element name="ERR169333_FASTQ_ITS_UNITE_OTU" ftype="tsv" file="taxonomic_analysis_unite/ERR169333_FASTQ_ITS_UNITE_OTU.tsv" />
            </output_collection>
            <output_collection name="unite_hdf5_biom" count="2">
                <element name="ERR169331_FASTQ_ITS_UNITE_OTU_TABLE_HDF5" ftype="biom2" file="taxonomic_analysis_unite/ERR169331_FASTQ_ITS_UNITE_OTU_TABLE_HDF5.biom" />
                <element name="ERR169333_FASTQ_ITS_UNITE_OTU_TABLE_HDF5" ftype="biom2" file="taxonomic_analysis_unite/ERR169333_FASTQ_ITS_UNITE_OTU_TABLE_HDF5.biom" />
            </output_collection>
            <output_collection name="unite_json_biom" count="2">
                <element name="ERR169331_FASTQ_ITS_UNITE_OTU_TABLE_JSON" ftype="biom1" file="taxonomic_analysis_unite/ERR169331_FASTQ_ITS_UNITE_OTU_TABLE_JSON.biom" />
                <element name="ERR169333_FASTQ_ITS_UNITE_OTU_TABLE_JSON" ftype="biom1" file="taxonomic_analysis_unite/ERR169333_FASTQ_ITS_UNITE_OTU_TABLE_JSON.biom" />
            </output_collection>
        </test>
        <!--taxonomic_analysis_itsonedb_test-->
        <test expect_num_outputs="5">
            <param name="accession" value="MGYS00002478" />
            <param name="pipeline" value="5.0" />
            <param name="result_group" value="taxonomic_analysis_itsonedb" />
            <param name="file_type" value="mapseq_itsonedb_assignments,itsonedb_otu_tables,itsonedb_hdf5_biom,itsonedb_json_biom" />
            <output name="metadata" file="taxonomic_analysis_itsonedb/MGYS00002478_metadata.tsv" />
            <output_collection name="mapseq_itsonedb_assignments" count="2">
                <element name="ERR169331_FASTQ_ITS_ITSoneDB_MAPSeq" ftype="tabular" file="taxonomic_analysis_itsonedb/ERR169331_FASTQ_ITS_ITSoneDB_MAPSeq.mseq.gz" />
                <element name="ERR169333_FASTQ_ITS_ITSoneDB_MAPSeq" ftype="tabular" file="taxonomic_analysis_itsonedb/ERR169333_FASTQ_ITS_ITSoneDB_MAPSeq.mseq.gz" />
            </output_collection>
            <output_collection name="itsonedb_otu_tables" count="2">
                <element name="ERR169331_FASTQ_ITS_ITSoneDB_OTU" ftype="tsv" file="taxonomic_analysis_itsonedb/ERR169331_FASTQ_ITS_ITSoneDB_OTU.tsv" />
                <element name="ERR169333_FASTQ_ITS_ITSoneDB_OTU" ftype="tsv" file="taxonomic_analysis_itsonedb/ERR169333_FASTQ_ITS_ITSoneDB_OTU.tsv" />
            </output_collection>
            <output_collection name="itsonedb_hdf5_biom" count="2">
                <element name="ERR169331_FASTQ_ITS_ITSoneDB_OTU_TABLE_HDF5" ftype="biom2" file="taxonomic_analysis_itsonedb/ERR169331_FASTQ_ITS_ITSoneDB_OTU_TABLE_HDF5.biom" />
                <element name="ERR169333_FASTQ_ITS_ITSoneDB_OTU_TABLE_HDF5" ftype="biom2" file="taxonomic_analysis_itsonedb/ERR169333_FASTQ_ITS_ITSoneDB_OTU_TABLE_HDF5.biom" />
            </output_collection>
            <output_collection name="itsonedb_json_biom" count="2">
                <element name="ERR169331_FASTQ_ITS_ITSoneDB_OTU_TABLE_JSON" ftype="biom1" file="taxonomic_analysis_itsonedb/ERR169331_FASTQ_ITS_ITSoneDB_OTU_TABLE_JSON.biom" />
                <element name="ERR169333_FASTQ_ITS_ITSoneDB_OTU_TABLE_JSON" ftype="biom1" file="taxonomic_analysis_itsonedb/ERR169333_FASTQ_ITS_ITSoneDB_OTU_TABLE_JSON.biom" />
            </output_collection>
        </test>
        <!--non-coding_rnas_test-->
        <test expect_num_outputs="2">
            <param name="accession" value="MGYS00000856" />
            <param name="pipeline" value="5.0" />
            <param name="result_group" value="non-coding_rnas" />
            <param name="file_type" value="predicted_non_coding_rnas" />
            <output name="metadata" file="non-coding_rnas/MGYS00000856_metadata.tsv" />
            <output_collection name="predicted_non_coding_rnas" count="9">
                <element name="SRR1145431_FASTQ_5.8S" ftype="fasta">
                    <assert_contents>
                        <has_size size="8288533" />
                    </assert_contents>
                </element>
                <element name="SRR1145432_FASTQ_5.8S" ftype="fasta">
                    <assert_contents>
                        <has_size size="4869556" />
                    </assert_contents>
                </element>
                <element name="SRR1145433_FASTQ_5.8S" ftype="fasta">
                    <assert_contents>
                        <has_size size="15279085" />
                    </assert_contents>
                </element>
                <element name="SRR1145434_FASTQ_5.8S" ftype="fasta">
                    <assert_contents>
                        <has_size size="36176733" />
                    </assert_contents>
                </element>
                <element name="SRR1145435_FASTQ_5.8S" ftype="fasta">
                    <assert_contents>
                        <has_size size="16586259" />
                    </assert_contents>
                </element>
                <element name="SRR1145436_FASTQ_5.8S" ftype="fasta">
                    <assert_contents>
                        <has_size size="37363898" />
                    </assert_contents>
                </element>
                <element name="SRR1145437_FASTQ_5.8S" ftype="fasta">
                    <assert_contents>
                        <has_size size="42594149" />
                    </assert_contents>
                </element>
                <element name="SRR1145438_FASTQ_5.8S" ftype="fasta">
                    <assert_contents>
                        <has_size size="24752179" />
                    </assert_contents>
                </element>
                <element name="SRR1145439_FASTQ_5.8S" ftype="fasta">
                    <assert_contents>
                        <has_size size="24961616" />
                    </assert_contents>
                </element>
            </output_collection>
        </test>
        <!--taxonomic_analysis_motu_test-->
        <test expect_num_outputs="2">
            <param name="accession" value="MGYS00005650" />
            <param name="pipeline" value="5.0" />
            <param name="result_group" value="taxonomic_analysis_motu" />
            <param name="file_type" value="motus_taxonomic_profile" />
            <output name="metadata" file="taxonomic_analysis_motu/MGYS00005650_metadata.tsv" />
            <output_collection name="motus_taxonomic_profile" count="15">
                <element name="ERR4702550_MERGED_FASTQ.mOTUs" ftype="tsv" file="taxonomic_analysis_motu/ERR4702550_MERGED_FASTQ.mOTUs.tsv" />
                <element name="ERR4702551_MERGED_FASTQ.mOTUs" ftype="tsv" file="taxonomic_analysis_motu/ERR4702551_MERGED_FASTQ.mOTUs.tsv" />
                <element name="ERR4702552_MERGED_FASTQ.mOTUs" ftype="tsv" file="taxonomic_analysis_motu/ERR4702552_MERGED_FASTQ.mOTUs.tsv" />
                <element name="ERR4702553_MERGED_FASTQ.mOTUs" ftype="tsv" file="taxonomic_analysis_motu/ERR4702553_MERGED_FASTQ.mOTUs.tsv" />
                <element name="ERR4702554_MERGED_FASTQ.mOTUs" ftype="tsv" file="taxonomic_analysis_motu/ERR4702554_MERGED_FASTQ.mOTUs.tsv" />
                <element name="ERR4702555_MERGED_FASTQ.mOTUs" ftype="tsv" file="taxonomic_analysis_motu/ERR4702555_MERGED_FASTQ.mOTUs.tsv" />
                <element name="ERR4702556_MERGED_FASTQ.mOTUs" ftype="tsv" file="taxonomic_analysis_motu/ERR4702556_MERGED_FASTQ.mOTUs.tsv" />
                <element name="ERR4702557_MERGED_FASTQ.mOTUs" ftype="tsv" file="taxonomic_analysis_motu/ERR4702557_MERGED_FASTQ.mOTUs.tsv" />
                <element name="ERR4702558_MERGED_FASTQ.mOTUs" ftype="tsv" file="taxonomic_analysis_motu/ERR4702558_MERGED_FASTQ.mOTUs.tsv" />
                <element name="ERR4702559_MERGED_FASTQ.mOTUs" ftype="tsv" file="taxonomic_analysis_motu/ERR4702559_MERGED_FASTQ.mOTUs.tsv" />
                <element name="ERR4702560_MERGED_FASTQ.mOTUs" ftype="tsv" file="taxonomic_analysis_motu/ERR4702560_MERGED_FASTQ.mOTUs.tsv" />
                <element name="ERR4702561_MERGED_FASTQ.mOTUs" ftype="tsv" file="taxonomic_analysis_motu/ERR4702561_MERGED_FASTQ.mOTUs.tsv" />
                <element name="ERR4702562_MERGED_FASTQ.mOTUs" ftype="tsv" file="taxonomic_analysis_motu/ERR4702562_MERGED_FASTQ.mOTUs.tsv" />
                <element name="ERR4702563_MERGED_FASTQ.mOTUs" ftype="tsv" file="taxonomic_analysis_motu/ERR4702563_MERGED_FASTQ.mOTUs.tsv" />
                <element name="ERR4702564_MERGED_FASTQ.mOTUs" ftype="tsv" file="taxonomic_analysis_motu/ERR4702564_MERGED_FASTQ.mOTUs.tsv" />
            </output_collection>
        </test>
        <!--pathways_and_systems_test-->
        <test expect_num_outputs="8">
            <param name="accession" value="MGYS00006583" />
            <param name="pipeline" value="5.0" />
            <param name="result_group" value="pathways_and_systems" />
            <param name="file_type" value="antismash_annotation_gff3,antismash_annotation_embl,antismash_annotation_genbank,antismash_summary,genome_properties_annotation,kegg_pathway_annotation,kegg_pathway_annotation_contig" />
            <output name="metadata" file="pathways_and_systems/MGYS00006583_metadata.tsv" />
            <output_collection name="antismash_annotation_gff3" count="1">
                <element name="ERZ21819995_FASTA_antismash" ftype="gff3.gz" file="pathways_and_systems/ERZ21819995_FASTA_antismash.gff.bgz" />
            </output_collection>
            <output_collection name="antismash_annotation_embl" count="1">
                <element name="ERZ21819995_FASTA_antismash" ftype="embl">
                    <assert_contents>
                        <has_size size="19749942" />
                    </assert_contents>
                </element>
            </output_collection>
            <output_collection name="antismash_annotation_genbank" count="1">
                <element name="ERZ21819995_FASTA_antismash" ftype="genbank.gz">
                    <assert_contents>
                        <has_size size="19439182" />
                    </assert_contents>
                </element>
            </output_collection>
            <output_collection name="antismash_summary" count="1">
                <element name="ERZ21819995_FASTA_antismash_summary" ftype="csv" file="pathways_and_systems/ERZ21819995_FASTA_antismash_summary.csv" />
            </output_collection>
            <output_collection name="genome_properties_annotation" count="1">
                <element name="ERZ21819995_FASTA_gp" ftype="csv" file="pathways_and_systems/ERZ21819995_FASTA_gp.csv" />
            </output_collection>
            <output_collection name="kegg_pathway_annotation" count="1">
                <element name="ERZ21819995_FASTA_kegg_pathways" ftype="csv" file="pathways_and_systems/ERZ21819995_FASTA_kegg_pathways.csv" />
            </output_collection>
            <output_collection name="kegg_pathway_annotation_contig" count="1">
                <element name="ERZ21819995_FASTA_kegg_pathways_contigs" ftype="tsv">
                    <assert_contents>
                        <has_size size="2758456" />
                    </assert_contents>
                </element>
            </output_collection>
        </test>
        <!--statistics_test-->
        <test expect_num_outputs="2">
            <param name="accession" value="MGYS00001619" />
            <param name="pipeline" value="3.0" />
            <param name="result_group" value="statistics" />
            <param name="file_type" value="taxa_abundance_distribution" />
            <output name="metadata" file="statistics/MGYS00001619_metadata.tsv" />
            <output_collection name="taxa_abundance_distribution" count="1">
                <element name="ERR1014373_FASTQ_tad-plots" ftype="svg" file="statistics/ERR1014373_FASTQ_tad-plots.svg" />
            </output_collection>
        </test>
        <!--taxonomic_analysis_test-->
        <test expect_num_outputs="8">
            <param name="accession" value="MGYS00000356" />
            <param name="pipeline" value="1.0" />
            <param name="result_group" value="taxonomic_analysis" />
            <param name="file_type" value="phylogenetic_tree,otus_counts_and_taxonomic_assignments_tsv,otus_counts_and_taxonomic_assignments_biom1,otus_counts_and_taxonomic_assignments_biom2,reads_encoding_5s_rrna,reads_encoding_16s_rrna,reads_encoding_23s_rrna" />
            <output name="metadata" file="taxonomic_analysis/MGYS00000356_metadata.tsv" />
            <output_collection name="phylogenetic_tree" count="1">
                <element name="ERP000673_SL_FASTA_newick" ftype="newick" file="taxonomic_analysis/ERP000673_SL_FASTA_newick.tre" />
            </output_collection>
            <output_collection name="otus_counts_and_taxonomic_assignments_tsv" count="1">
                <element name="ERP000673_SL_FASTA_otu" ftype="tsv" file="taxonomic_analysis/ERP000673_SL_FASTA_otu.tsv" />
            </output_collection>
            <output_collection name="otus_counts_and_taxonomic_assignments_biom1" count="1">
                <element name="ERP000673_SL_FASTA_otu" ftype="biom1" file="taxonomic_analysis/ERP000673_SL_FASTA_otu.biom" />
            </output_collection>
            <output_collection name="otus_counts_and_taxonomic_assignments_biom2" count="0" />
            <output_collection name="reads_encoding_5s_rrna" count="1">
                <element name="ERP000673_SL_FASTA_5SrRNA" ftype="fasta" file="taxonomic_analysis/ERP000673_SL_FASTA_5SrRNA.fasta" />
            </output_collection>
            <output_collection name="reads_encoding_16s_rrna" count="1">
                <element name="ERP000673_SL_FASTA_16SrRNA" ftype="fasta" file="taxonomic_analysis/ERP000673_SL_FASTA_16SrRNA.fasta" />
            </output_collection>
            <output_collection name="reads_encoding_23s_rrna" count="1">
                <element name="ERP000673_SL_FASTA_23SrRNA" ftype="fasta" file="taxonomic_analysis/ERP000673_SL_FASTA_23SrRNA.fasta" />
            </output_collection>
        </test>
        <!--sequence_data_test-->
        <test expect_num_outputs="11">
            <param name="accession" value="MGYS00003607" />
            <param name="pipeline" value="4.1" />
            <param name="result_group" value="sequence_data" />
            <param name="file_type" value="processed_contigs_nucleotide_reads,processed_contigs_reads_with_annotation,processed_contigs_reads_without_annotation,processed_contigs_reads_with_pcds,predicted_cds,predicted_cds_with_annotation,predicted_cds_without_annotation,predicted_orf,predicted_orf_with_annotation,predicted_orf_without_annotation" />
            <output name="metadata" file="sequence_data/MGYS00003607_metadata.tsv" />
            <output_collection name="processed_contigs_nucleotide_reads" count="1">
                <element name="ERZ746984_FASTA" ftype="fasta.gz">
                    <assert_contents>
                        <has_size size="7611334" />
                    </assert_contents>
                </element>
            </output_collection>
            <output_collection name="processed_contigs_reads_with_annotation" count="1">
                <element name="ERZ746984_FASTA_interproscan" ftype="fasta.gz">
                    <assert_contents>
                        <has_size size="7308319" />
                    </assert_contents>
                </element>
            </output_collection>
            <output_collection name="processed_contigs_reads_without_annotation" count="1">
                <element name="ERZ746984_FASTA_noFunction" ftype="fasta.gz">
                    <assert_contents>
                        <has_size size="304091" />
                    </assert_contents>
                </element>
            </output_collection>
            <output_collection name="processed_contigs_reads_with_pcds" count="1">
                <element name="ERZ746984_FASTA_readsWithpCDS" ftype="fasta.gz">
                    <assert_contents>
                        <has_size size="7611323" />
                    </assert_contents>
                </element>
            </output_collection>
            <output_collection name="predicted_cds" count="0" />
            <output_collection name="predicted_cds_with_annotation" count="1">
                <element name="ERZ746984_FASTA_CDS_annotated" ftype="fasta.gz">
                    <assert_contents>
                        <has_size size="2072545" />
                    </assert_contents>
                </element>
            </output_collection>
            <output_collection name="predicted_cds_without_annotation" count="1">
                <element name="ERZ746984_FASTA_CDS_unannotated" ftype="fasta.gz">
                    <assert_contents>
                        <has_size size="2365190" />
                    </assert_contents>
                </element>
            </output_collection>
            <output_collection name="predicted_orf" count="0" />
            <output_collection name="predicted_orf_with_annotation" count="0" />
            <output_collection name="predicted_orf_without_annotation" count="1">
                <element name="ERZ746984_FASTA_ORF_unannotated" ftype="fasta.gz">
                    <assert_contents>
                        <has_size size="3413452" />
                    </assert_contents>
                </element>
            </output_collection>
        </test>
        <!--functional_analysis_test-->
        <test expect_num_outputs="11">
            <param name="accession" value="MGYS00006583" />
            <param name="pipeline" value="5.0" />
            <param name="result_group" value="functional_analysis" />
            <param name="file_type" value="complete_go_annotation,go_slim_annotation,interpro_summary,interpro_matches,kegg_orthologues_annotation,pfam_annotation,combined_annotation,diamond_annotation,eggnog_annotation,eggnog_seed_orthologs" />
            <output name="metadata" file="functional_analysis/MGYS00006583_metadata.tsv" />
            <output_collection name="complete_go_annotation" count="1">
                <element name="ERZ21819995_FASTA_GO" ftype="csv">
                    <assert_contents>
                        <has_size size="174565" />
                    </assert_contents>
                </element>
            </output_collection>
            <output_collection name="go_slim_annotation" count="1">
                <element name="ERZ21819995_FASTA_GO_slim" ftype="csv">
                    <assert_contents>
                        <has_size size="7531" />
                    </assert_contents>
                </element>
            </output_collection>
            <output_collection name="interpro_summary" count="1">
                <element name="ERZ21819995_FASTA_InterPro" ftype="csv">
                    <assert_contents>
                        <has_size size="570181" />
                    </assert_contents>
                </element>
            </output_collection>
            <output_collection name="interpro_matches" count="1">
                <element name="ERZ21819995_FASTA_InterPro" ftype="tsv">
                    <assert_contents>
                        <has_size size="15684535" />
                    </assert_contents>
                </element>
            </output_collection>
            <output_collection name="kegg_orthologues_annotation" count="1">
                <element name="ERZ21819995_FASTA_ko" ftype="tsv">
                    <assert_contents>
                        <has_size size="315669" />
                    </assert_contents>
                </element>
            </output_collection>
            <output_collection name="pfam_annotation" count="1">
                <element name="ERZ21819995_FASTA_pfam" ftype="tsv">
                    <assert_contents>
                        <has_size size="347414" />
                    </assert_contents>
                </element>
            </output_collection>
            <output_collection name="combined_annotation" count="1">
                <element name="ERZ21819995_FASTA_annotations" ftype="gff3.gz">
                    <assert_contents>
                        <has_size size="14662895" />
                    </assert_contents>
                </element>
            </output_collection>
            <output_collection name="diamond_annotation" count="1">
                <element name="ERZ21819995_FASTA_diamond" ftype="tsv">
                    <assert_contents>
                        <has_size size="5636503" />
                    </assert_contents>
                </element>
            </output_collection>
            <output_collection name="eggnog_annotation" count="1">
                <element name="ERZ21819995_FASTA_emapper.annotations" ftype="tsv">
                    <assert_contents>
                        <has_size size="13848757" />
                    </assert_contents>
                </element>
            </output_collection>
            <output_collection name="eggnog_seed_orthologs" count="1">
                <element name="ERZ21819995_FASTA_emapper.seed_orthologs" ftype="tsv">
                    <assert_contents>
                        <has_size size="2190490" />
                    </assert_contents>
                </element>
            </output_collection>
        </test>
    </tests>
    <help>
<![CDATA[
Download result files in bulks for an entire study from the MGnify archive, and a metadata table for the corresponding results files.

Usage
-----
1. Provide the Study/Project Accession:

   * Ensure the study is publicly available in MGnify.
   * Example format: MGYS00002098.

2. Select the Pipeline Version and Result Type:

   * Choose the pipeline version and the specific group type you are interested in.

3. Select the Output Types:

   * Select the output types you wish to download. (Multiple types can be selected)

License
-------
* `Apache-2.0 license <https://raw.githubusercontent.com/EBI-Metagenomics/emg-toolkit/master/LICENSE>`_
]]>
    </help>
    <expand macro="citations" />
</tool>