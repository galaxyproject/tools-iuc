<tool id="cemitool" name="CEMiTool" version="@TOOL_VERSION@+galaxy@VERSION_SUFFIX@" profile="21.05">
    <description>gene co-expression network analyses</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements" />
    <expand macro='xrefs'/>
    <command detect_errors="exit_code"><![CDATA[
        Rscript '$__tool_directory__/CEMiTool.R'
            -M '$expression_matrix'
        #if $annotation
            -A '$annotation'
        #end if
        #if $pathways
            -P '$pathways'
        #end if
        && ls -lah
        && ls -lah Reports
        && ls -lah Plots
        && ls -lah Tables
    ]]></command>
    <inputs>
        <param name="expression_matrix" type="data" format="tabular" label="Expression matrix"/>
        <param name="annotation" type="data" format="tabular" optional="true" label="Sample annotation" 
            help="It allows to build a more complete object and generate richer reports about the 
                expression data. Sample annotation can be supplied in a data.frame that specifies a 
                class for each sample. Classes can represent different conditions, phenotypes, cell lines, 
                time points, etc. " />
        <param name="pathways" type="data" format="txt" label="Pathways list" optional="true" help="CEMiTool can 
            determine which biological functions are associated with the modules by performing an over 
            representation analysis (ORA). To do this you must provide a pathway list in the form of GMT 
            file. CEMiTool will then analyze how these pathways are represented in the modules." />
        <param name="outputs" type="select" multiple="true" display="checkboxes" label="Outputs selector">
            <option value="report" selected="true">Report</option>
            <option value="tables" selected="true">Tables</option>
            <option value="plots">Plots</option>
        </param>
    </inputs>
    <outputs>
        <collection name="plots" type="list" label="${tool.name} on ${on_string}: Plots">
            <discover_datasets pattern="__designation_and_ext__" format="pdf" directory="Plots" />
            <filter>"plots" in outputs</filter>
        </collection>
        <data name="profile_plot" format="pdf" from_work_dir="Plots/profile.pdf" label="${tool.name} on ${on_string}: Profiles">
        </data>
        <data name="module" format="tabular" from_work_dir="Tables/module.tsv" label="${tool.name} on ${on_string}: Module">
            <filter>"tables" in outputs</filter>
        </data>
        <data name="modules_genes" format="tabular" from_work_dir="Tables/modules_genes.gmt" label="${tool.name} on ${on_string}: Module genes">
            <filter>"tables" in outputs</filter>
        </data>
        <data name="parameters" format="tabular" from_work_dir="Tables/parameters.tsv" label="${tool.name} on ${on_string}: Parameters">
            <filter>"tables" in outputs</filter>
        </data>
        <data name="selected_genes" format="txt" from_work_dir="Tables/selected_genes.txt" label="${tool.name} on ${on_string}: Selected genes">
            <filter>"tables" in outputs</filter>
        </data>
        <data name="summary_eigengene" format="tabular" from_work_dir="Tables/summary_eigengene.tsv" label="${tool.name} on ${on_string}: Summary eigengenes">
            <filter>"tables" in outputs</filter>
        </data>
        <data name="summary_mean" format="tabular" from_work_dir="Tables/summary_mean.tsv" label="${tool.name} on ${on_string}: Summary mean">
            <filter>"tables" in outputs</filter>
        </data>
        <data name="summary_median" format="tabular" from_work_dir="Tables/summary_median.tsv" label="${tool.name} on ${on_string}: Summary median">
            <filter>"tables" in outputs</filter>
        </data>
    </outputs>
    <help><![CDATA[

.. class:: infomark

**Purpose**

The CEMiTool R package provides users with an easy-to-use method to automatically implement gene co-expression network analyses, obtain key information about the 
discovered gene modules using additional downstream analyses and retrieve publication-ready results via a high-quality interactive report.

    ]]></help>
    <expand macro="citations" />
</tool>