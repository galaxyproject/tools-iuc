<tool id="cramtools" name="cramtools CRAM to BAM" version="3.0">
    <description>cramtools converting CRAM to BAM format</description>

    <macros>
        <import>cramtools_macros.xml</import>
    </macros>

    <expand macro="requirements" />
    <expand macro="stdio" />
    <expand macro="version_command" />

    <command>
    <![CDATA[
        @PREPROCESS_FASTA_FILE@
        
        ls -als $input_alignment ;
        java
            -jar \$CRAMTOOLS_ROOT_DIR/jars/cramtools-3.0.jar
            bam
                -l INFO
                -b
                -I $input_alignment
                -R $input_reference".fa"
                -O $output_alignment
    ]]>
    </command>

    <inputs>
        <param name="input_alignment" type="data" format="cram" label="CRAM file"/>
        <param name="input_reference" type="data" format="fasta" label="FASTA file"/>
    </inputs>

    <outputs>
        <data name="output_alignment" format="bam" label="{$tool.name} on ${on_string}"/>
    </outputs>

    <tests>
        <test>
            <param name="input_alignment" value="test.cram" />
            <param name="input_reference" value="test.fa" />
            
            <output name="output_alignment" file="test.bam"  compare="sim_size" delta="250" />
        </test>
    </tests>

    <help>
    </help>

    <citations>
    </citations>
</tool>
