<tool id="manorm" name="MAnorm" version="0.1.2">
  <description>Compare ChIP-Seq datasets</description>
  <requirements>
    <requirement type="package" version="0.1.2">manormfast</requirement>
  </requirements>
  <command>
    MAnormFast 
        --p1 $p1 
        --p2 $p2 
        --r1 $r1 
        --r2 $r2 
        -o output_dir
        #if $s1 
          --s1 $s1 
        #end if
        #if $s2 
          --s2 $s2 
        #end if
        #if $n 
          -n $n 
        #end if
        #if $e 
          -e $e 
        #end if
        #if $d 
          -d $d 
        #end if
        #if $p 
          -p $p 
        #end if
        #if $m 
          -m $m 
        #end if
        #if $u
        -u $u 
        #end if
        $s 
        $v
  </command>
  <inputs>
    <param name="p1" type="data" optional="false" label="peak file of sample 1" />
    <param name="p2" type="data" optional="false" label="peak file of sample 2" />
    <param name="r1" type="data" optional="false" label="reads file of sample 1" />
    <param name="r2" type="data" optional="false" label="reads file of sample 2" />
    <!-- optional params -->
    <param name="s1" type="integer" optional="true" value="100" label="read shift size of sample 1" help="Should be set as the average size of DNA fragments." />
    <param name="s2" type="integer" optional="true" value="100" label="read shift size of sample 2" help="hould be set as the average size of DNA fragments." />
    <param name="n"  type="integer" optional="true" value="5" label="number of random permutations to test the enrichment of overlapping between two peak sets." />
    <param name="e"  type="integer" optional="true" value="1000" label="2*extension=size of the window centered at peak summit to calculate reads density." help="The window size should match the typical length of peaks, thus we recommend extension=1000 for sharp histone marks like H3K4me2/3 or H3K9/27ac, extension=500 for transcription factor or DNase-seq." />
    <param name="d"  type="integer" optional="true" value="500" label="summit to summit distance cutoff, default=extension/2." help="Only those common peaks with distance between their summits in 2 samples smaller than this value will be considered as real common peaks for building the normalization model." />
    <param name="p"  type="float" optional="true" value="0.01" label="Cutoff of P-value to define biased (high-confidence sample 1 or 2-specific) peaks." />
    <param name="m"  type="integer" optional="true" value="1" label="Cutoff of M-value to define biased peaks." help="Sample 1 biased peaks are defined as sample 1 unique peaks with M-value &gt; mcut_biased and P-value &lt; pcut_biased, while sample 2 biased peaks are defined as sample 2 unique peaks with M-value &lt; -1*mcut_biased and P-value &lt; pcut_biased." />
    <param name="u"  type="integer" optional="true" value="1" label="Cutoff of M-value to define unbiased (high-confidence non-specific) peaksbetween 2 samples, default=1." help="They are defined to be the common peaks with -1*mcut_unbiased &lt; M-value &lt; mcut_unbiased and P-value &gt; pcut_biased." />
    <!-- output params -->
    <param name="s" type="boolean" truevalue="-s" falsevalue="" checked="false" help="By default, MAnorm will first separate both sets of input peaks into common and unique peaks, by checking whether they have overlap with any peak in the other sample, and then merge the 2 sets of common peaks into 1 group of non-overlapping ones. But if this option is used, MAnorm would not merge the common peaks and the peaks in output files will be exactly the same as those from input." />
    <param name="v" type="boolean" truevalue="-v" falsevalue="" checked="false" help="If this option is used, MAnorm will choose biased peaks only from unique peaks, and choose unbiased peaks only from common peaks. But if this option is not used, MAnorm will choose biased and unbiased peaks just based on the M-value and P-value cutoffs, without checking whether they are common or unique peaks." />
  </inputs>
  <outputs>
    <data name="out"  from_work_dir="output_dir/result.tab" hidden="false" />
  </outputs>
  <help>
    ChIP-Seq is widely used to characterize genome-wide binding patterns of transcription factors and other chromatin-associated proteins. Although comparison of ChIP-Seq data sets is critical for understanding cell type-dependent and cell state-specific binding, and thus the study of cell-specific gene regulation, few quantitative approaches have been developed. 

    Here, we present a simple and effective method, MAnorm, for quantitative comparison of ChIP-Seq data sets describing transcription factor binding sites and epigenetic modifications. The quantitative binding differences inferred by MAnorm showed strong correlation with both the changes in expression of target genes and the binding of cell type-specific regulators.
  </help>
      <citations>
        <citation type="bibtex">
@Article{Shao2012,
author="Shao, Zhen
and Zhang, Yijing
and Yuan, Guo-Cheng
and Orkin, Stuart H.
and Waxman, David J.",
title="MAnorm: a robust model for quantitative comparison of ChIP-Seq data sets",
journal="Genome Biology",
year="2012",
volume="13",
number="3",
pages="R16",
abstract="ChIP-Seq is widely used to characterize genome-wide binding patterns of transcription factors and other chromatin-associated proteins. Although comparison of ChIP-Seq data sets is critical for understanding cell type-dependent and cell state-specific binding, and thus the study of cell-specific gene regulation, few quantitative approaches have been developed. Here, we present a simple and effective method, MAnorm, for quantitative comparison of ChIP-Seq data sets describing transcription factor binding sites and epigenetic modifications. The quantitative binding differences inferred by MAnorm showed strong correlation with both the changes in expression of target genes and the binding of cell type-specific regulators.",
issn="1474-760X",
doi="10.1186/gb-2012-13-3-r16",
url="http://dx.doi.org/10.1186/gb-2012-13-3-r16"
}</citation>
    </citations>
</tool>
