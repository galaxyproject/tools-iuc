<?xml version="1.0"?>
<tool id="suppa_diffsplice" name="SUPPA diffSplice" version="@TOOL_VERSION@+@WRAPPER_VERSION@">
    <description>of events</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="requirements"/>
    <stdio></stdio>
    <command detect_errors="exit_code"><![CDATA[
        ## initialize 
 
        ## run
        suppa.py
            diffsplice


            -o 'results'
        ]]></command>
    <inputs>
        <param name="-m" type="select" label="Select method to calculate the significance" help="">
            <option value="e">empirical</option>
            <option value="c">classical</option>
        </param>
        <repeat name="files">
            <param argument="-p" type="data" format="tabular" multiple="false" label="Select PSI file" help=""/>
            <param argument="-e" type="data" format="tabular" multiple="false" label="Select transcript expression file" help=""/>
        </repeat>
        <param argument="-i" type="data" format="tabular" multiple="false" label="Select file with local or transcript evenets" help="ioe or ioi format."/>
        <param name="-a" type="integer" value="1000" label="Set integer indicating the number of points in the local area of the delta PSI - average TPM distribution" help=""/>
        <param name="-l" type="integer" value="0" label="Lower-bound for the absolute delta PSI value to test for significance. Events with less than this delta PSI will not be tested." help=""/>
        <param name="-pa" type="boolean" truevalue="-pa" falsevalue="" checked="false" label="Replicates across conditions should be handled as paired" help=""/>
        <param name="-gc" type="boolean" truevalue="-gc" falsevalue="" checked="false" label="Correct the p-values by gene" help=""/>
        <param argument="-al" type="float" value="0.05" label="Set family-wise error rate to use for the multiple test correction." help=""/>
        <param name="-s" type="boolean" truevalue="-s" falsevalue="" checked="false" label="Save the average log TPM of the events in an external file" help=""/>
        <param name="-c" type="boolean" truevalue="-c" falsevalue="" checked="false" label="Peform analysis between all possible combinations of conditions." help=""/>
        <param name="-me" type="boolean" truevalue="-me" falsevalue="" checked="false" label="Use median to calculate the Delta PSI, instead of the mean" help=""/>
        <param name="-th" type="float" value="0.0" label="Set minimum expression" help="To be included in the analysis. Calculated as average TPM value within-replicates and between-conditions."/>
        <param argument="-nan" type="float" value="0.0" label="Set percentage allowed of samples per condition with nan values for returning a DeltaPSI" help=""/>

    </inputs>

    <outputs>
    </outputs> 

    <tests> 
        <!-- #1; required parameters -->
        <test>          
        </test>
        <!-- #2; advanced parameters -->
        <test>          
        </test>
    </tests>
    <help><![CDATA[
.. class:: infomark

**What it does**

@WID@

SUPPA reads the PSI for the (transcripts or local) events and the transcript expression values from multiple samples, grouped by condition, and the ioe/ioi file, to calucate the events that are differentially spliced between a pair of conditions. SUPPA can test multiple conditions with a variabe number of samples per condition.

**Input**

The ioe/ioi file, the PSI files and the transcript expression files are required.

The PSI and transcript expression files are both tab separated files, where each line provides the (transcript or local) event PSI values and the estimated abundance of each transcript, respectively. These files must contain multiple columns with the PSI values and expression values in the different samples, always keeping the same order of samples in both files.

The PSI and transcript expression files must have a header with the sample names. For instance, the PSI file could look like this:

:::

    sample1 sample2 sample3 sample4
    event1  <psi_value> <psi_value> <psi_value> <psi_value>
    event2  <psi_value> <psi_value> <psi_value> <psi_value>
    event3  <psi_value> <psi_value> <psi_value> <psi_value>

and the transcript expression file should be then of the form:

::

    sample1 sample2 sample3 sample4
    transcript1 <expression>  <expression>  <expression>  <expression>
    transcript2 <expression>  <expression>  <expression>  <expression>
    transcript3 <expression>  <expression>  <expression>  <expression>

where the expression values are given in TPM units.

Note: these files have a header with only the sample names (1 less column)

Important: SUPPA will read one PSI file and one transcript expression file per condition. Each of these files will contain the multiple replicates (or individual samples) that are grouped into a given condition, and the should be specified in the same order within the files.

**Output**

...

.. class:: infomark

**References**

@REFERENCES@

    ]]></help>
    <citations>
        <expand macro="citation"/>
    </citations>
</tool>