<tool id="emboss_backtranseq" name="EMBOSS: backtranseq" version="@VERSION@+galaxy0">
    <description>Back translate a protein sequence</description>
    <macros>
        <import>macros.xml</import>
    </macros>
    <expand macro="bio_tools" />
    <expand macro="requirements" />
    <version_command>backtranseq -version</version_command>
    <command><![CDATA[
backtranseq
-sequence '$protein_sequences'
-outfile '$output_nucleotide_sequences'
-cfile $cfile
-osformat2
$osformat2
-auto
    ]]></command>
    <inputs>
        <param name="protein_sequences" type="data" format="fasta" label="Protein sequence" help="In FASTA format" />
        <expand macro="codon_table"/>
        <expand macro="choose_nucleotide_sequence_output_format"/>

        <param name="out_format1" type="select" label="Output sequence file format">
            <option value="fasta">FASTA (m)</option>
            <option value="acedb">ACeDB (m)</option>
            <option value="asn1">ASN.1 (m)</option>
            <option value="clustal">Clustal (m)</option>
            <option value="codata">CODATA (m)</option>
            <option value="embl">EMBL (m)</option>
            <option value="fitch">Fitch (m)</option>
            <option value="gcg">Wisconsin Package GCG 9.x and 10.x (s)</option>
            <option value="genbank">GENBANK (m)</option>
            <option value="gff">GFF (m)</option>
            <option value="hennig86">Hennig86 (m)</option>
            <option value="ig">Intelligenetics (m)</option>
            <option value="jackknifer">Jackknifer (m)</option>
            <option value="jackknifernon">Jackknifernon (m)</option>
            <option value="mega">Mega (m)</option>
            <option value="meganon">Meganon (m)</option>
            <option value="msf">Wisconsin Package GCG's MSF (m)</option>
            <option value="pir">NBRF (PIR) (m)</option>
            <option value="ncbi">NCBI style FASTA (m)</option>
            <option value="nexus">Nexus/PAUP (m)</option>
            <option value="nexusnon">Nexusnon/PAUPnon (m)</option>
            <option value="phylip">PHYLIP interleaved (m)</option>
            <option value="phylipnon">PHYLIP non-interleaved (m)</option>
            <option value="selex">SELEX (m)</option>
            <option value="staden">Staden (s)</option>
            <option value="strider">DNA strider (m)</option>
            <option value="swiss">SwisProt entry (m)</option>
            <option value="text">Plain sequence (s)</option>
            <option value="treecon">Treecon (m)</option>
        </param>
    </inputs>
    <outputs>
        <data name="output_nucleotide_sequences" format="txt" >
            <expand macro="change_nucleotide_sequence_output_format"/>"
        </data>
    </outputs>
    <tests>
        <test>
            <param name="protein_sequences" value="emboss_transeq_out.fasta"/>
            <param name="cfile" value="Ehum.cut"/>
            <param name="osformat2" value="fasta"/>
            <output name="output_nucleotide_sequences" file="emboss_backtranseq_out.fasta" ftype="fasta" />
        </test>
        <!-- Test with multiple sequence FASTA input -->
        <test>
            <param name="protein_sequences" value="emboss_getorf_out.fasta" />
            <param name="cfile" value="Ehum.cut"/>
            <param name="osformat2" value="fasta"/>
            <output name="output_nucleotide_sequences" file="emboss_backtranseq_out2.fasta" ftype="fasta" />
        </test>
        <!-- Test with different cfile and outpute format -->
        <test>
            <param name="protein_sequences" value="emboss_getorf_out.fasta" />
            <param name="cfile" value="Espo_h.cut"/>
            <param name="osformat2" value="embl"/>
            <output name="output_nucleotide_sequences" file="emboss_backtranseq_out2.embl" ftype="embl" />
        </test>
    </tests>
    <help><![CDATA[

Back-translate a protein sequence to the nucleic acid sequence it is most likely to have come from. ``backtranseq`` uses a codon usage table which gives the frequency of usage of each codon for each amino acid. For each amino acid in the input sequence, the corresponding most frequently occuring codon is used in the nucleic acid sequence that is output.

-----

    You can view the original documentation here_.

    .. _here: http://emboss.open-bio.org/rel/rel6/apps/backtranseq.html
]]>
    </help>
    <expand macro="citations" />
</tool>
