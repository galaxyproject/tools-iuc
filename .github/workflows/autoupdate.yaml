name: Weekly autoupdate of tools
on:
  schedule:
    # Run at midnight every monday
    - cron: '0 0 * * 1'
  repository_dispatch:
    types: [run-autoupdate-command]
jobs:
  setup:
    name: Setup cache and determine changed repositories
    # adapt the owner name
    if: ${{ github.repository_owner == 'galaxyproject' }}
    uses: galaxyproject/tools-iuc/.github/workflows/wf_setup.yaml@master
    with:
      max-chunks: 1
  autoupdate:
    name: Autoupdate
    needs: setup
    uses: galaxyproject/tools-iuc/.github/workflows/wf_autoupdate.yaml@master
    with:
      repository-list: ${{ needs.setup.outputs.repository-list }}
      galaxy-head-sha: ${{ needs.setup.outputs.galaxy-head-sha }}
